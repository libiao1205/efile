(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"+L9i":function(e,t,a){"use strict";var i=a("Oq1C");a.n(i).a},"+a51":function(e,t,a){"use strict";var i=a("90dw");a.n(i).a},"+g7U":function(e,t,a){},"09yh":function(e,t,a){"use strict";a.r(t);var i=a("bZsl"),s=a("jhdv"),n=a("JGdg"),o=a("gllY"),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};function r(e,t){var a={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);return a}var c={name:"EditSolr",data:function(){return{visible:!1,dialogType:"create",form:{id:"",docType:"",code:"",name:"",dataType:"",multivalued:!1,indexed:!1,notnull:!1,isKey:!1,clustering:!1,comment:""},rules:{docType:[{required:!0,message:"请选择文档类型",trigger:"change"}],code:[{required:!0,message:"请输入字段编码",trigger:"blur"}],name:[{required:!0,message:"请输入字段名称",trigger:"blur"}],dataType:[{required:!0,message:"请输入数据类型",trigger:"blur"}]},docTypes:[],dataTypes:[]}},computed:{dialogTitle:function(){return"edit"===this.dialogType?"修改solr数据":"新增solr数据"}},mounted:function(){this.dataTypes=i.dataTypes},methods:{onClose:function(){this.initForm(),this.$refs.form.resetFields()},dialogOnClose:function(){this.visible=!1,this.initForm(),this.$refs.form.resetFields()},dialogOnSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(t){if("create"===e.dialogType){var a=e.form,i=(a.id,r(a,["id"])),n=l({},i,{docType:parseInt(e.form.docType),notnull:e.form.notnull?1:0,multivalued:e.form.multivalued?1:0,indexed:e.form.indexed?1:0,isKey:e.form.isKey?1:0,clustering:e.form.clustering?1:0});e.$axios({method:"post",url:"/external/solrInsert",data:n}).then(function(t){e.$message.success("新建成功"),e.dialogOnClose(),s.a.$emit("refreshSolr")}).catch(function(t){e.$message.error("新建数据失败，失败码："+t.response.status)})}if("edit"===e.dialogType){var o=e.form,c=(o.status,r(o,["status"])),d=l({},c,{docType:parseInt(e.form.docType),notnull:e.form.notnull?1:0,multivalued:e.form.multivalued?1:0,indexed:e.form.indexed?1:0,isKey:e.form.isKey?1:0,clustering:e.form.clustering?1:0});e.$axios({method:"put",url:"/external/solrUpdate",data:d}).then(function(t){e.$message.success("修改成功"),e.dialogOnClose(),s.a.$emit("refreshSolr")}).catch(function(t){e.$message.error("修改数据失败，失败码："+t.response.status)})}}})},handleChangeDataType:function(e){},initForm:function(){this.form={id:"",docType:"",code:"",name:"",dataType:"",multivalued:!1,indexed:!1,notnull:!1,isKey:!1,clustering:!1,comment:""}}}},d=(a("FVNA"),a("KHd+")),u=Object(d.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit-mata-data"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,"close-on-click-modal":!1,width:"700px"},on:{"update:visible":function(t){e.visible=t},close:e.onClose}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","label-position":"left"}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"源数据id",prop:"id"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文档类型",prop:"docType"}},[a("el-select",{attrs:{placeholder:"请选择文档类型"},model:{value:e.form.docType,callback:function(t){e.$set(e.form,"docType",t)},expression:"form.docType"}},e._l(e.docTypes,function(e,t){return a("el-option",{key:t,attrs:{label:e.comment,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"字段编码",prop:"code"}},[a("el-input",{model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"字段名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数据类型",prop:"dataType"}},[a("el-select",{attrs:{placeholder:"请选择数据类型"},on:{change:e.handleChangeDataType},model:{value:e.form.dataType,callback:function(t){e.$set(e.form,"dataType",t)},expression:"form.dataType"}},e._l(e.dataTypes,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"多值映射",prop:"multivalued"}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.form.multivalued,callback:function(t){e.$set(e.form,"multivalued",t)},expression:"form.multivalued"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"创建索引",prop:"indexed"}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.form.indexed,callback:function(t){e.$set(e.form,"indexed",t)},expression:"form.indexed"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"非空",prop:"notnull"}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.form.notnull,callback:function(t){e.$set(e.form,"notnull",t)},expression:"form.notnull"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"主键",prop:"isKey"}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.form.isKey,callback:function(t){e.$set(e.form,"isKey",t)},expression:"form.isKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"聚类",prop:"clustering"}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.form.clustering,callback:function(t){e.$set(e.form,"clustering",t)},expression:"form.clustering"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-form-item",{attrs:{label:"说明",prop:"comment"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new"},on:{click:e.dialogOnSubmit}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.dialogOnClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,null,null).exports,f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};var m={components:{CopyUserPermission:o.a,EditUser:n.a,EditSolr:u},name:"solr",data:function(){return{searchTxt:"",searchData:"",tableData:{height:0,loading:!0,body:[],pageSize:20,total:0,curPage:0},isShowAll:!1,docTypes:[]}},mounted:function(){var e=this;this.initDocTypes(),s.a.$on("refreshSolr",function(t){e.refresh()})},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.table.$el.offsetTop;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.table.$el.offsetTop}})},getData:function(e){var t=this;this.tableData.loading=this.$refs.infinite.isFirstLoad;var a=void 0;a=this.searchData?"/external/solr/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name="+this.searchData:"/external/solr/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name=",this.$axios({url:a,method:"get"}).then(function(a){var i=[];i.push(a.ctt.list),i[0].length>0&&1===i[0][0].id&&(i[0][0].isRoot=!0),t.tableData.body=t.tableData.body.concat(a.ctt.list),t.tableData.total=a.ctt.total,t.tableData.loading=!1,0==a.ctt.list.length?e&&e.complete():e&&e.loaded(),t.$nextTick(function(){t.tableHeight()})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},search:function(){this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchData=this.searchTxt,this.refresh()):this.$message.success("请输入搜索关键词")},handleUserAdd:function(){this.$refs.editUser.handleUserAdd()},handleUserInput:function(){var e=this;this.$confirm("开始导入最新用户数据吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.tableData.loading=!0,e.$axios({url:"/relay/users",method:"post"}).then(function(t){e.$message({message:"已经完成导入",type:"success"}),e.tableData.loading=!1,e.refresh()}).catch(function(t){e.tableData.loading=!1,e.$message.error("获取数据失败，失败码："+t.response.status)})}).catch(function(){})},handleUserUnlockSubmit:function(e,t){this.$refs.editUser.handleUserUnlockSubmit(e,t)},handleCopyUserPermission:function(e,t){this.$refs.copyUserPermission.handleUserPermissionCopy(t)},handleUserBaseEdit:function(e,t){this.$refs.editUser.handleUserBaseEdit(e,t)},handleUserPasswordEdit:function(e,t){this.$refs.editUser.handleUserPasswordEdit(e,t)},handleAdminSubmit:function(e,t){this.$refs.editUser.handleAdminSubmit(e,t)},handleUserLockSubmit:function(e,t){this.$refs.editUser.handleUserLockSubmit(e,t)},handleUserLeaveSubmit:function(e,t){this.$refs.editUser.handleUserLeaveSubmit(e,t)},handleUserDeleteSubmit:function(e,t){this.$refs.editUser.handleUserDeleteSubmit(e,t)},nextPage:function(e){this.tableData.curPage+=1,this.getData(e)},refresh:function(){this.tableData.total=0,this.tableData.body=[],this.tableData.curPage=0,this.$refs.infinite.stateChanger.reset()},clearSearchTxt:function(){this.searchData="",this.refresh()},showAllChange:function(){this.refresh()},handleEditItem:function(e,t){this.$refs.editSolr.dialogType="edit",this.$refs.editSolr.docTypes=this.docTypes,this.$refs.editSolr.visible=!0;t.status;var a=function(e,t){var a={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);return a}(t,["status"]);this.$refs.editSolr.form=f({},a,{docType:String(t.docType),multivalued:1===t.multivalued,indexed:1===t.indexed,notnull:1===t.notnull,isKey:1===t.isKey,clustering:1===t.clustering})},handleDelItem:function(e,t){var a=this;this.$confirm("此操作将删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$axios({method:"delete",url:"/external/solr",data:{id:t.id}}).then(function(e){a.refresh(),a.$message.success("删除成功")}).catch(function(e){a.$message.error("删除数据失败，失败码："+e.response.status)})}).catch(function(){})},handleSetValidItem:function(e,t){var a=this;this.$confirm("此操作将该数据置为"+(1===t.status?"无效":"有效")+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$axios({method:"put",url:"/external/solrInvalid",data:{id:t.id,status:1===t.status?9:1}}).then(function(e){a.refresh(),a.$message.success("设置成功")}).catch(function(e){a.$message.error("设置数据失败，失败码："+e.response.status)})}).catch(function(){})},handleAddSolr:function(){this.$refs.editSolr.dialogType="create",this.$refs.editSolr.docTypes=this.docTypes,this.$refs.editSolr.visible=!0},initDocTypes:function(){var e=this;this.$axios({method:"get",url:"/external/metadataType"}).then(function(t){e.docTypes=t.ctt})},formatDocType:function(e){var t=this.docTypes.find(function(t){return t.value===e});return t&&t.comment?t.comment:e},dataTypeText:function(e){return Object(i.dataTypeToText)(e)}}},p=(a("Z70/"),Object(d.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"shezhi1"}}),e._v("  solr管理")],1)]),e._v(" "),a("div",{staticClass:"ib pd10"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入关键字",clearable:""},on:{clear:e.clearSearchTxt},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline",plain:""},on:{click:e.handleAddSolr}},[e._v("新增solr数据")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height}},[a("el-table-column",{attrs:{prop:"id",label:"id",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.id))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"docType",label:"文档类型",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.formatDocType(t.row.docType)))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fieldCode",label:"字段编码",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.code))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fieldName",label:"字段名称",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"dataType",label:"solr数据类型",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.dataTypeText(t.row.dataType)))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"bottom"}},[a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-file",circle:""},on:{click:function(a){e.handleEditItem(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},on:{click:function(a){e.handleDelItem(t.$index,t.row)}}})],1),e._v(" "),1===t.row.status?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"无效化",placement:"bottom"}},[a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-dongjie",circle:""},on:{click:function(a){e.handleSetValidItem(t.$index,t.row)}}})],1):e._e(),e._v(" "),9===t.row.status?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"有效化",placement:"bottom"}},[a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-jiechu",circle:""},on:{click:function(a){e.handleSetValidItem(t.$index,t.row)}}})],1):e._e()],1)]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1),e._v(" "),a("edit-user",{ref:"editUser",attrs:{"add-user":e.refresh,"edit-user":e.refresh}}),e._v(" "),a("edit-solr",{ref:"editSolr"}),e._v(" "),a("copy-user-permission",{ref:"copyUserPermission"})],1)},[],!1,null,"073f6c6f",null));t.default=p.exports},"0rd4":function(e,t,a){"use strict";a.r(t);var i=a("FHfX"),s=a("Bl3E"),n=a("MYOy"),o=a("iaoZ"),l=a("Gas7"),r=a.n(l),c={visible:!1,new:!1,modify:!1,read:!1,update:!1,link:!1,download:!1,delete:!1},d={name:"roledept",components:{editPermission:i.a,editFolder:s.a,folderAdmin:n.a,folderWhite:o.a,splitPane:r.a},data:function(){return{memberTree:{data:[],loading:!1,props:{children:"children",label:"name"},selected:null},documentTree:{data:[],loading:!1,props:{children:"children",label:"name"},selected:null,defaultNodes:["folder-1"],currentKey:""},splitClass:"",searchData:{isSearch:!1,text:"",data:""},tableData:{height:0,loading:!0,body:[],pageSize:20,total:0,curPage:0},permissionTable:{height:0,data:{loading:!1,body:[]},page:{pageSize:1e3,total:0,curPage:1}}}},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.split.$el.offsetTop;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.split.$el.offsetTop}})},printMemberTree:function(e,t){var a=this,i=void 0;if(0===e.level)i=0;else{if("dept"!==e.data.kind)return void t([]);i=e.data.id}this.memberTree.loading=!0,this.$axios({url:"/admin/dept/"+i+"/members",method:"get"}).then(function(e){t(e.ctt),a.memberTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},memberSelect:function(e){this.memberTree.selected=e,this.updatePermission(),e&&("dept"===e.kind?this.getDeptPermission(e):this.getUserPermission(e))},printDocumentTree:function(e,t){var a=this,i=void 0;if(0===e.level)i=0;else{if("folder"!==e.data.kind)return void t([]);i=e.data.id}this.documentTree.loading=!0,this.$axios({url:"/admin/folder/"+i+"/docs",method:"get"}).then(function(e){var i=!1;e.ctt.forEach(function(e){e.roles=c,e.key===a.documentTree.currentKey&&(i=!0)}),t(e.ctt),a.updatePermission(),a.$nextTick(function(){a.tableHeight(),i&&(a.$refs.documentTree.setCurrentKey(a.documentTree.currentKey),a.documentTree.currentKey="")}),a.documentTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},updatePermission:function(e){var t=this,a=void 0;if(this.memberTree.selected){var i=void 0;if(i="dept"===this.memberTree.selected.kind?"/admin/dept/"+this.memberTree.selected.id+"/docs/rps":"/admin/user/"+this.memberTree.selected.id+"/docs/rps",0!==(a=e?[e]:this.getAllTreeNodes(this.$refs.documentTree.root)).length){var s=[];a.forEach(function(e){s.push(e.data.key)}),this.$axios({url:i,method:"put",data:s}).then(function(e){var a=t;Object.keys(e.ctt).forEach(function(t){a.$refs.documentTree.getNode(t).data.roles=e.ctt[t]})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})}}else(a=this.getAllTreeNodes(this.$refs.documentTree.root)).forEach(function(e){e.data.roles=c})},getAllTreeNodes:function(e){var t=[],a=this;return e.data.id&&t.push(e),e.childNodes.forEach(function(e){t=t.concat(a.getAllTreeNodes(e))}),t},addFolder:function(e){var t=this;e.ctt.roles=c,this.$refs.documentTree.append(e.ctt,"folder-"+e.ctt.parentId),this.$nextTick(function(){t.updatePermission(t.$refs.documentTree.getNode(e.ctt.key))})},editFolder:function(e){var t=this;e.key="folder-"+e.id;var a=this.$refs.documentTree.getNode(e);this.$refs.documentTree.remove(a),a.roles=c,this.$refs.documentTree.append(a.data,"folder-"+e.parentId),this.$nextTick(function(){t.updatePermission(t.$refs.documentTree.getNode(a.key))}),a.data.name=e.name},deleteFolder:function(e){this.$refs.documentTree.remove(e)},onMouseDown:function(){this.$refs.split.active&&(this.splitClass="active")},onMouseUp:function(){this.$refs.split.active||(this.splitClass="")},search:function(){this.searchData.text&&this.searchData.text.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchData.text.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchData.data=this.searchData.text,this.searchData.isSearch=!0,this.refresh()):this.$message.success("请输入搜索关键词")},getData:function(e){var t=this;this.searchData.data?(this.tableData.loading=this.$refs.infinite.isFirstLoad,this.$axios({url:"/admin/search/users/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name="+this.searchData.data+"&islove=true",method:"get"}).then(function(a){var i=[];i.push(a.ctt.list),i[0].length>0&&1===i[0][0].id&&(i[0][0].isRoot=!0),t.tableData.body=t.tableData.body.concat(a.ctt.list),t.tableData.total=a.ctt.total,t.tableData.loading=!1,0===a.ctt.list.length?e&&e.complete():e&&e.loaded()}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})):e.complete()},refresh:function(){this.tableData.total=0,this.tableData.body=[],this.tableData.curPage=0,this.memberSelect(null),this.$refs.infinite&&this.$refs.infinite.stateChanger.reset()},clearSearchTxt:function(){var e=this;this.searchData.isSearch=!1,this.searchData.data="",this.$nextTick(function(){e.memberSelect(e.$refs.memberTree.getCurrentNode())}),this.refresh()},nextPage:function(e){this.tableData.curPage+=1,this.getData(e)},currentChange:function(e){this.memberSelect(e)},handlePermissionDeleteSubmit:function(e,t){var a=this;this.$confirm("确认删除选中权限吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e;e={rolePermissions:[{id:t.id}]};var i=Object.assign({},e);a.$axios({url:"/admin/role",method:"delete",data:i}).then(function(e){0===e.c?(a.$message.success("权限删除成功"),a.memberSelect(a.$refs.memberTree.getCurrentNode())):a.$message.error(e.msg)})})},getUserPermission:function(e){var t=this;this.permissionTable.data.loading=!0,this.$axios({url:"/admin/user/"+e.id+"/rps",method:"get"}).then(function(e){t.permissionTable.data.body=e.ctt,t.permissionTable.page.total=e.ctt.total,t.permissionTable.data.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},getDeptPermission:function(e){var t=this;this.permissionTable.data.loading=!0,this.$axios({url:"/admin/dept/"+e.id+"/rps",method:"get"}).then(function(e){t.permissionTable.data.body=e.ctt,t.permissionTable.page.total=e.ctt.total,t.permissionTable.data.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},permissionChange:function(e){var t=this;if(e){for(var a=0;a<this.$refs.documentTree.store._getAllNodes().length;a++)this.$refs.documentTree.store._getAllNodes()[a].expanded=!1;var i=e.fullPath.split("/"),s=[];i.forEach(function(e,t){""!==e&&t!==i.length-1&&s.push("folder-"+e)}),this.$nextTick(function(){var a=void 0;a="file"===e.code?"file-"+e.resourceId:"folder-"+e.resourceId,t.$refs.documentTree.getNode(a)?t.$refs.documentTree.setCurrentKey(a):t.documentTree.currentKey=a}),this.documentTree.defaultNodes=s}},refreshPermissionTable:function(){"dept"===this.memberTree.selected.kind?this.getDeptPermission(this.memberTree.selected):this.getUserPermission(this.memberTree.selected)},handleCommand:function(e){switch(e.name){case"PermissionEdit":this.$refs.editPermission.handlePermissionEdit(e.node.data,this.memberTree.selected,e.node.data.roles);break;case"FolderAdd":this.$refs.editFolder.handleFolderAdd(e.node);break;case"FolderEdit":this.$refs.editFolder.handleFolderEdit(e.node);break;case"WhiteList":this.$refs.folderWhite.handleWhiteList(e.node);break;case"FolderAdmin":this.$refs.folderAdmin.handleFolderAdmin(e.node);break;case"FolderDelete":this.$refs.editFolder.handleFolderDelete(e.node)}}}},u=(a("pwrt"),a("KHd+")),f=Object(u.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"106"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"drxx95"}}),e._v("  组织架构权限管理")],1)]),e._v(" "),a("div",{staticClass:"ib pd10"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入用户姓名",clearable:""},on:{clear:e.clearSearchTxt},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchData.text,callback:function(t){e.$set(e.searchData,"text",t)},expression:"searchData.text"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)])]),e._v(" "),a("split-pane",{ref:"split",attrs:{split:"vertical",className:e.splitClass,defaultPercent:20},nativeOn:{mousedown:function(t){return e.onMouseDown(t)},mouseup:function(t){return e.onMouseUp(t)}}},[a("template",{slot:"paneL"},[a("el-scrollbar",{directives:[{name:"show",rawName:"v-show",value:!e.searchData.isSearch,expression:"!searchData.isSearch"}]},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTree.loading,expression:"memberTree.loading"}],ref:"memberTree",staticClass:"mr20",attrs:{data:e.memberTree.data,"highlight-current":"",props:e.memberTree.props,"expand-on-click-node":!1,lazy:"",load:e.printMemberTree,"default-expanded-keys":["dept-1"],"node-key":"key"},on:{"node-click":e.memberSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",["dept"===s.kind?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-user"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):2===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):0===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-user"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("span",[e._v(e._s(i.label))])])])])}}])})],1),e._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.searchData.isSearch,expression:"searchData.isSearch"},{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height},on:{"current-change":e.currentChange}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名",align:"left",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"departments",label:"用户组织",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.departments,function(t){return a("div",[1===t.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v("\n                                    "+e._s(t.name)+"\n                                ")]):a("div",[1===t.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v("\n                                        "+e._s(t.name)+"\n                                    ")]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v("\n                                        "+e._s(t.name)+"\n                                    ")])])])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"20%"},scopedSlots:e._u([{key:"default",fn:function(t){return[8===t.row.status?a("div",[a("span",[e._v("离职")])]):4===t.row.status?a("div",[a("span",[e._v("账户封禁")])]):a("div",[a("span",[e._v("正常")])])]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1),e._v(" "),a("template",{slot:"paneR"},[a("split-pane",{ref:"split",attrs:{split:"vertical",className:e.splitClass,defaultPercent:40},nativeOn:{mousedown:function(t){return e.onMouseDown(t)},mouseup:function(t){return e.onMouseUp(t)}}},[a("template",{slot:"paneR"},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.documentTree.loading,expression:"documentTree.loading"}],ref:"documentTree",attrs:{data:e.documentTree.data,"highlight-current":"",props:e.documentTree.props,"default-expand-all":!1,"node-key":"key","expand-on-click-node":!1,lazy:"",load:e.printDocumentTree,"default-expanded-keys":e.documentTree.defaultNodes},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[1===s.id?a("div",["folder"===s.kind?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-document"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])]):a("div",["folder"===s.kind?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-wenjianjia3"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[a("app-svg",{attrs:{iconText:s.suffix}}),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.label,placement:"bottom"}},[a("span",{staticClass:"ib",staticStyle:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden","max-width":"150px"}},[e._v("\n                                                    "+e._s(i.label)+"\n                                                ")])])],1)])]),e._v(" "),a("span",{staticClass:"mr20"},[a("span",{staticClass:"mr20 ib",staticStyle:{width:"120px"}},[s.roles.visible?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"可见",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-liulan"})])],1):e._e(),e._v(" "),s.roles.read?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-wenjian"})])],1):e._e(),e._v(" "),s.roles.update?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"更新文件",placement:"bottom"}},[s.roles.visible?a("i",{staticClass:"iconfont icon-caozuo-shangchuan-upload"}):e._e()])],1):e._e(),e._v(" "),s.roles.new?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增文件",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-add"})])],1):e._e(),e._v(" "),s.roles.modify?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"重命名",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-edit-file"})])],1):e._e(),e._v(" "),s.roles.download?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-caozuo-shangchuan-download"})])],1):e._e(),e._v(" "),s.roles.link?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"外链",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-wailian"})])],1):e._e(),e._v(" "),s.roles.delete?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-trash"})])],1):e._e()]),e._v(" "),a("span",{staticClass:"ib",staticStyle:{width:"75px"}},[e.memberTree.selected?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设定权限",placement:"right"}},[a("el-button",{attrs:{type:"text",size:"mini",icon:"iconfont icon-drxx74",circle:""},nativeOn:{click:function(t){e.$refs.editPermission.handlePermissionEdit(s,e.memberTree.selected,s.roles)}}})],1):e._e(),e._v(" "),"folder"===s.kind?a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件夹操作",placement:"right"}},["folder"===s.kind?a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-guanli_danse",circle:""}}):e._e()],1),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:{name:"FolderAdd",node:i}}},[e._v("新增下级菜单")]),e._v(" "),"folder-1"!==s.key?a("el-dropdown-item",{attrs:{command:{name:"FolderEdit",node:i}}},[e._v("文件夹编辑")]):e._e(),e._v(" "),"folder-1"!==s.key?a("el-dropdown-item",{attrs:{command:{name:"FolderAdmin",node:i}}},[e._v("设置文件夹管理员")]):e._e(),e._v(" "),"folder-1"!==s.key?a("el-dropdown-item",{attrs:{command:{name:"FolderDelete",node:i}}},[e._v("删除文件夹")]):e._e()],1)],1):e._e()],1)])])}}])})],1)],1),e._v(" "),a("template",{slot:"paneL"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.permissionTable.data.loading,expression:"permissionTable.data.loading"}],ref:"table2",staticClass:"custom-table-cell",attrs:{data:e.permissionTable.data.body,"highlight-current-row":"","cell-style":{padding:"5px"},width:"500px","header-cell-style":{padding:"2px"},height:e.tableData.height},on:{"current-change":e.permissionChange}},[a("el-table-column",{attrs:{prop:"inherit",label:"类型","show-overflow-tooltip":!0,width:"65px"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.inherit?a("div",[a("el-tag",{attrs:{size:"mini",type:"warning","disable-transitions":""}},[e._v("自身")])],1):2===t.row.inherit?a("div",[a("el-tag",{attrs:{size:"mini",type:"success","disable-transitions":""}},[e._v("继承")])],1):a("div")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"resourceName",label:"文件/文件夹","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return["folder"===t.row.code?a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("b",[e._v(e._s(t.row.resourceName))])],1):a("div",[a("app-svg",{attrs:{iconText:t.row.resourceSuffix}}),e._v(" "),a("b",[e._v(e._s(t.row.resourceName))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"权限",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"可见",placement:"bottom"}},[t.row.explication.visible?a("i",{staticClass:"iconfont icon-liulan"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[t.row.explication.read?a("i",{staticClass:"iconfont icon-wenjian"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"更新文件",placement:"bottom"}},[t.row.explication.update?a("i",{staticClass:"iconfont icon-caozuo-shangchuan-upload"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增文件",placement:"bottom"}},[t.row.explication.new?a("i",{staticClass:"iconfont icon-add"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"重命名",placement:"bottom"}},[t.row.explication.modify?a("i",{staticClass:"iconfont icon-edit-file"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"bottom"}},[t.row.explication.download?a("i",{staticClass:"iconfont icon-caozuo-shangchuan-download"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"外链",placement:"bottom"}},[t.row.explication.link?a("i",{staticClass:"iconfont icon-wailian"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"bottom"}},[t.row.explication.delete?a("i",{staticClass:"iconfont icon-trash"}):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.inherit?a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除权限",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},on:{click:function(a){e.handlePermissionDeleteSubmit(t.$index,t.row)}}})],1)],1):e._e()]}}])})],1)],1)],1)],2)],1)],2),e._v(" "),a("edit-permission",{ref:"editPermission",attrs:{"edit-permission":e.refreshPermissionTable}}),e._v(" "),a("edit-folder",{ref:"editFolder",attrs:{"add-folder":e.addFolder,"edit-folder":e.editFolder,"delete-folder":e.deleteFolder}}),e._v(" "),a("folder-admin",{ref:"folderAdmin"}),e._v(" "),a("folder-white",{ref:"folderWhite"})],1)},[],!1,null,"f2ef5f02",null);t.default=f.exports},11:function(e,t){},12:function(e,t){},"20+P":function(e,t,a){"use strict";var i=a("92tK");a.n(i).a},"26K/":function(e,t,a){"use strict";var i={name:"previewDatabase",data:function(){return{title:"",visible:!1,dbId:null,tables:[],columns:[],columnProps:[],dbName:"",currentRow:null,itemColumns:[],isFullScreen:!1,tableHeight:"600px",loading:!1,pageSize:10,curPage:1,total:0,tableName:""}},mounted:function(){this.tableHeight=document.documentElement.clientHeight-240},methods:{onOpen:function(){var e=this;this.$axios({url:"external/dbById/"+this.dbId,method:"get"}).then(function(t){0===t.c?(e.dbName=""==t.ctt.aliasName?t.ctt.dbName:t.ctt.aliasName,e.getTables()):e.dbName="该数据不存在"})},getTables:function(){var e=this;this.dbId&&this.$axios({method:"get",url:"/external/dbTableById/"+this.dbId}).then(function(t){0===t.c&&(e.tables=t.ctt)}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},getColumns:function(e){var t=this;this.loading=!0,this.columns=[],this.columnProps=[],this.$axios({method:"get",url:"/external/findTableContent/"+this.dbId+"/"+e+"/"+this.curPage+"-"+this.pageSize}).then(function(a){if(t.total=0,0===a.c&&null!==a.ctt){t.$refs.dataCol;var i=JSON.parse(JSON.parse(a.ctt).ctt).rows;if(t.total=JSON.parse(JSON.parse(a.ctt).ctt).count,t.total>0){var s=t.tables.find(function(t){return t.tablename===e}).columns;t.itemColumns=s,t.columns=i,i.length>0&&(t.columnProps=Object.keys(i[0]))}}t.loading=!1}).catch(function(e){t.loading=!1,t.$message.error("获取数据失败，失败码："+e.msg)})},handleCurrentChange:function(e){this.tableName=e.tablename,this.currentRow!==this.tableName&&(this.currentRow,this.tableName,this.getColumns(this.tableName))},handleChangeMaxMinDialog:function(){this.isFullScreen=!this.isFullScreen,this.isFullScreen?this.tableHeight="calc(100vh - 110px)":this.tableHeight="800px"},handleCloseDialog:function(){this.visible=!1,this.isFullScreen=!1},formatDateTime:function(e){var t=new Date(e),a=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds());return NaN===a?e:a},formatterCol:function(e,t,a,i){return JSON.parse(JSON.stringify(this.itemColumns)).filter(function(e){return"datetime"===e.datatype||"date"===e.datatype}).map(function(e){return e.columnname}).includes(t.property)&&(a=this.formatDateTime(e[t.property])),"boolean"==typeof e[t.property]&&(a=e[t.property]?"true":"false"),a},selectPage:function(e){this.curPage=e,this.tableName&&this.getColumns(this.tableName)},handleSizeChange:function(e){this.pageSize=e,this.tableName&&this.getColumns(this.tableName)}}},s=(a("hiyP"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"preview-database-container"},[a("el-dialog",{attrs:{title:e.title,visible:e.visible,fullscreen:e.isFullScreen,"close-on-click-modal":!1,"show-close":!1,"custom-class":"custom-dialog",width:"1200px",top:"7vh"},on:{"update:visible":function(t){e.visible=t},open:e.onOpen}},[a("div",{staticClass:"custom-title-container",attrs:{slot:"title"},slot:"title"},[a("span"),e._v(" "),a("span",{staticClass:"custom-title"}),e._v(" "),a("span",{staticClass:"custom-icons"},[e.isFullScreen?a("i",{on:{click:e.handleChangeMaxMinDialog}},[a("svg",{staticClass:"icon",attrs:{t:"1614587768535",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5438",width:"200",height:"200"}},[a("path",{attrs:{d:"M449.92 543.36C449.92 520.96 431.36 512 410.24 512L97.92 512c-17.92 0-32 14.08-32 32 0 17.92 14.08 32 32 32l242.56 0-267.52 267.52c-12.16 12.16-12.16 31.36 0 43.52 12.16 12.16 31.36 12.16 43.52 0l269.44-269.44 0 246.4c0 17.92 14.08 32 32 32 17.92 0 32-14.08 32-32l0-320M865.92 384 622.72 384l267.52-267.52c12.16-12.16 12.16-31.36 0-43.52-12.16-12.16-31.36-12.16-43.52 0L577.92 342.4 577.92 96C577.92 78.08 563.2 64 545.92 64c-17.92 0-32 14.08-32 32l0 320c0 0.64 0.64 1.28 0.64 1.92 0 8.32 2.56 16.64 8.96 22.4C531.2 448.64 542.72 451.2 552.96 448l312.32 0c17.92 0 32-14.08 32-32C897.92 398.08 883.2 384 865.92 384z","p-id":"5439",fill:"#ffffff"}})])]):a("i",{on:{click:e.handleChangeMaxMinDialog}},[a("svg",{staticClass:"icon",attrs:{t:"1614587805849",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5979",width:"200",height:"200"}},[a("path",{attrs:{d:"M444.3 539.9L202 782.2 199.8 563c0-16.5-13.5-30-30-30s-30 13.5-30 30l2.2 285.1c0 8.8 3.8 16.7 9.8 22.2 5.5 6 13.4 9.8 22.2 9.8h295.6c16.5 0 30-13.5 30-30s-13.5-30-30-30H248.9l237.8-237.8c11.7-11.7 11.7-30.8 0-42.4-11.6-11.6-30.7-11.6-42.4 0zM578.1 488l242.3-242.3 2.2 219.2c0 16.5 13.5 30 30 30s30-13.5 30-30l-2.2-285.1c0-8.8-3.8-16.7-9.8-22.2-5.5-6-13.4-9.8-22.2-9.8H552.8c-16.5 0-30 13.5-30 30s13.5 30 30 30h220.7L535.7 445.6c-11.7 11.7-11.7 30.8 0 42.4 11.7 11.7 30.8 11.7 42.4 0z","p-id":"5980",fill:"#ffffff"}})])]),e._v(" "),a("i",{staticClass:"el-icon-close",on:{click:e.handleCloseDialog}})])]),e._v(" "),a("div",{staticClass:"table-content"},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-table",{attrs:{data:e.tables,height:e.tableHeight,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"tablename",label:e.dbName}})],1)],1),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataCol",attrs:{data:e.columns,width:"100%",border:"",height:e.tableHeight}},[e._l(e.columnProps,function(t,i){return[a("el-table-column",{key:i,attrs:{formatter:e.formatterCol,prop:t,label:t,width:"160"}})]})],2),e._v(" "),a("div",{staticStyle:{"padding-top":"15px","text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev,pager,next,jumper","current-page":e.curPage,total:e.total,"page-sizes":[10,20,30,40,50],"page-size":e.pageSize},on:{"current-change":e.selectPage,"size-change":e.handleSizeChange}})],1)],1)],1)],1)])],1)},[],!1,null,null,null);t.a=n.exports},"2ZLj":function(e,t,a){"use strict";var i=a("xUDH");a.n(i).a},"2h3Y":function(e,t,a){"use strict";var i=a("RK5e");a.n(i).a},"3QlK":function(e,t,a){"use strict";var i=a("zUC8");a.n(i).a},"3WS4":function(e,t,a){"use strict";var i=a("+g7U");a.n(i).a},"467A":function(e,t,a){"use strict";a.r(t);var i=a("JGdg"),s={components:{CopyUserPermission:a("gllY").a,EditUser:i.a},name:"user",data:function(){return{searchTxt:"",searchData:"",tableData:{height:0,loading:!0,body:[],pageSize:20,total:0,curPage:0},isShowAll:!1}},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.table.$el.offsetTop;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.table.$el.offsetTop}})},getData:function(e){var t=this;this.tableData.loading=this.$refs.infinite.isFirstLoad;var a=void 0;a=this.searchData?"/admin/search/users/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name="+this.searchData+"&islove="+!this.isShowAll:"/admin/users/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?islove="+this.isShowAll,this.$axios({url:a,method:"get"}).then(function(a){var i=[];i.push(a.ctt.list),i[0].length>0&&1===i[0][0].id&&(i[0][0].isRoot=!0),t.tableData.body=t.tableData.body.concat(a.ctt.list),t.tableData.total=a.ctt.total,t.tableData.loading=!1,0==a.ctt.list.length?e&&e.complete():e&&e.loaded(),t.$nextTick(function(){t.tableHeight()})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},search:function(){this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchData=this.searchTxt,this.refresh()):this.$message.success("请输入搜索关键词")},handleUserAdd:function(){this.$refs.editUser.handleUserAdd()},handleUserInput:function(){var e=this;this.$confirm("开始导入最新用户数据吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.tableData.loading=!0,e.$axios({url:"/relay/users",method:"post"}).then(function(t){e.$message({message:"已经完成导入",type:"success"}),e.tableData.loading=!1,e.refresh()}).catch(function(t){e.tableData.loading=!1,e.$message.error("获取数据失败，失败码："+t.response.status)})}).catch(function(){})},handleUserUnlockSubmit:function(e,t){this.$refs.editUser.handleUserUnlockSubmit(e,t)},handleCopyUserPermission:function(e,t){this.$refs.copyUserPermission.handleUserPermissionCopy(t)},handleUserBaseEdit:function(e,t){this.$refs.editUser.handleUserBaseEdit(e,t)},handleUserPasswordEdit:function(e,t){this.$refs.editUser.handleUserPasswordEdit(e,t)},handleAdminSubmit:function(e,t){this.$refs.editUser.handleAdminSubmit(e,t)},handleUserLockSubmit:function(e,t){this.$refs.editUser.handleUserLockSubmit(e,t)},handleUserLeaveSubmit:function(e,t){this.$refs.editUser.handleUserLeaveSubmit(e,t)},handleUserDeleteSubmit:function(e,t){this.$refs.editUser.handleUserDeleteSubmit(e,t)},nextPage:function(e){this.tableData.curPage+=1,this.getData(e)},refresh:function(){this.tableData.total=0,this.tableData.body=[],this.tableData.curPage=0,this.$refs.infinite.stateChanger.reset()},clearSearchTxt:function(){this.searchData="",this.refresh()},showAllChange:function(){this.refresh()}}},n=(a("k/fZ"),a("KHd+")),o=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"drxx10"}}),e._v("  用户管理")],1)]),e._v(" "),a("div",{staticClass:"ib pd10"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入关键字",clearable:""},on:{clear:e.clearSearchTxt},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline",plain:""},on:{click:e.handleUserAdd}},[e._v("新增用户")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名",align:"left",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"departments",label:"用户组织",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.departments,function(t){return a("div",[1===t.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v("\n                                "+e._s(t.name)+"\n                            ")]):a("div",[1===t.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v("\n                                    "+e._s(t.name)+"\n                                ")]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v("\n                                    "+e._s(t.name)+"\n                                ")])])])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"20%"},scopedSlots:e._u([{key:"default",fn:function(t){return[8===t.row.status?a("div",[a("span",[e._v("离职")])]):4===t.row.status?a("div",[a("span",[e._v("账户封禁")])]):a("div",[a("span",[e._v("正常")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[8===t.row.status?a("div",[a("span",[e._v("离职用户")]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"再入职",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-add-user",circle:""},on:{click:function(a){e.handleUserUnlockSubmit(t.$index,t.row)}}})],1)],1):4===t.row.status?a("div",[a("span",[e._v("限制登录")]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"解封账户",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-jiechu",circle:""},on:{click:function(a){e.handleUserUnlockSubmit(t.$index,t.row)}}})],1)],1):a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑基本信息",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-row",circle:""},on:{click:function(a){e.handleUserBaseEdit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"密码重置",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-denglumima",circle:""},on:{click:function(a){e.handleUserPasswordEdit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设为系统管理员",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-guanli_danse",circle:""},on:{click:function(a){e.handleAdminSubmit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"封禁",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-dongjie",circle:""},on:{click:function(a){e.handleUserLockSubmit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"账户封存",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-yonghushanchu",circle:""},on:{click:function(a){e.handleUserDeleteSubmit(t.$index,t.row)}}})],1)],1)]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1),e._v(" "),a("edit-user",{ref:"editUser",attrs:{"add-user":e.refresh,"edit-user":e.refresh}}),e._v(" "),a("copy-user-permission",{ref:"copyUserPermission"})],1)},[],!1,null,"9b1eea0c",null);t.default=o.exports},"4bC7":function(e,t,a){},"4htw":function(e,t,a){"use strict";var i=a("diN0");a.n(i).a},"4nLk":function(e,t,a){"use strict";a.r(t);var i=a("jhdv"),s={name:"sys",computed:{token:function(){return{Authorization:"Bearer "+this.$store.state.auth.token}}},data:function(){return{activeName:"1",sysPasswordChangeSetting:{rules:{},period:0,limit:6,model:0,changeDate:30,warnDate:5,state:!1,lock:0},sysTimingChangeSetting:{rules:{saveMonth:[{required:!0,message:"内容必填",trigger:"blur"}]},month:2,state:!1},loading:!0,folderRootSetting:{rules:{name:[{required:!0,message:"内容必填",trigger:"blur"}]},id:0,name:""},SystemSwitch:{rules:{},value:1,queryTemplate:null},logoImgSetting:{rules:{},viewImageUrl:this.$upload+"/setting/getLogoImg?seed="},upload:{url:this.$upload+"/setting/logoImg",size:this.$maxImgSize},randNum:0}},methods:{handleAddFileSubmit:function(){this.$refs.uploadImg.submit()},onUploadNum:function(){this.$message({message:"最多只能上传一张图片",type:"warning"})},onUploadBefore:function(e){var t="image/png"===e.type,a=e.size/1024/1024<this.upload.size;return t||this.$message.error("上传图片只能是 PNG 格式!"),a||this.$message.error("上传图片大小不能超过 "+this.upload.size+"MB!"),t&&a},onUploadSuccess:function(){this.$message({message:"图片上传成功",type:"success"}),this.logoImgSetting.viewImageUrl=this.logoImgSetting.viewImageUrl+(new Date).getTime(),i.a.$emit("refreshImg")},onUploadError:function(){this.$message.error("图片上传失败")},collapseChange:function(e){"1"===e?this.getPasswordComplexity():"2"===e?this.getBackupPeriod():"3"===e?this.getFolderRoot():"4"===e&&this.getConstructionData()},handleChange:function(e){"1"===e?this.getPasswordComplexity():"2"===e?this.getPasswordExceed():"3"===e&&this.getPasswordLock()},handleChangeTiming:function(e){"1"===e&&this.getBackupPeriod()},handleChangeFolder:function(e){"1"===e||"2"===e&&this.getFolderRoot()},handleChangeSystemSwitch:function(e){"1"===e?this.getConstructionData():"2"===e?this.getSolrSynchronizationSwitch():"3"===e&&this.getSolrQueryTemplate()},getPasswordComplexity:function(){var e=this;this.loading=!0,this.$axios({url:"/setting/getPasswordComplexity",method:"get"}).then(function(t){var a=t.ctt;e.sysPasswordChangeSetting.model=parseInt(a.psdCheck),e.sysPasswordChangeSetting.limit=a.psdLength,e.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},getPasswordExceed:function(){var e=this;this.loading=!0,this.$axios({url:"/setting/getPasswordExceed",method:"get"}).then(function(t){var a=t.ctt;e.sysPasswordChangeSetting.changeDate=a.usableDay,e.sysPasswordChangeSetting.warnDate=a.aheadDay,e.sysPasswordChangeSetting.state="1"===a.state,e.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},getPasswordLock:function(){var e=this;this.loading=!0,this.$axios({url:"/setting/getPasswordLock",method:"get"}).then(function(t){var a=t.ctt;null!=a?(e.sysPasswordChangeSetting.lock=a.value,e.sysPasswordChangeSetting.state=1===a.status):(e.sysPasswordChangeSetting.lock="",e.sysPasswordChangeSetting.state=!1),e.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},passwordComplexitySubmit:function(){var e=this;this.loading=!0;var t=Object.assign({},this.sysPasswordChangeSetting);t.psdCheck=this.sysPasswordChangeSetting.model,t.psdLength=this.sysPasswordChangeSetting.limit,this.$axios({url:"/setting/passwordComplexity",method:"post",data:t}).then(function(t){t.c>0?e.$message.error(t.msg):e.$message({message:"设置成功",type:"success"}),e.loading=!1})},passwordExceedSubmit:function(){var e=this;this.loading=!0;var t=Object.assign({},this.sysPasswordChangeSetting);t.usableDay=this.sysPasswordChangeSetting.changeDate,t.aheadDay=this.sysPasswordChangeSetting.warnDate,t.state=this.sysPasswordChangeSetting.state?1:0,this.$axios({url:"/setting/passwordUpdateRemind",method:"post",data:t}).then(function(t){t.c>0?e.$message.error(t.msg):e.$message({message:"设置成功",type:"success"}),e.loading=!1})},passwordMistakeCountSubmit:function(){var e=this;this.loading=!0;var t=Object.assign({},this.sysPasswordChangeSetting);t.psdMistakeCount=this.sysPasswordChangeSetting.lock,t.state=this.sysPasswordChangeSetting.state?1:0,this.$axios({url:"/setting/passwordLock",method:"post",data:t}).then(function(t){t.c>0?e.$message.error(t.msg):e.$message({message:"设置成功",type:"success"}),e.loading=!1})},getBackupPeriod:function(){var e=this;this.loading=!0,this.$axios({url:"/setting/getBackupPeriod",method:"get"}).then(function(t){var a=t.ctt;null!=a?(e.sysTimingChangeSetting.month=a.value,e.sysTimingChangeSetting.state=1===a.status):(e.sysTimingChangeSetting.month="",e.sysTimingChangeSetting.state=!1),e.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},TimingDeleteBackupSubmit:function(){var e=this;this.$refs.dataFormPassword.validate(function(t){if(t){e.loading=!0;var a=Object.assign({},e.sysTimingChangeSetting);a.month=e.sysTimingChangeSetting.month,a.state=e.sysTimingChangeSetting.state?1:0,e.$axios({url:"/setting/deleteBackupPeriod",method:"post",data:a}).then(function(t){t.c>0?e.$message.error(t.msg):e.$message({message:"设置成功",type:"success"}),e.loading=!1})}})},getFolderRoot:function(){var e=this;this.loading=!0,this.$axios({url:"/user/folder/0/children",method:"get"}).then(function(t){var a=t.ctt;a.length>0?(e.folderRootSetting.name=a[0].name,e.folderRootSetting.id=a[0].id):(e.folderRootSetting.name="",e.folderRootSetting.id=0),e.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},folderRootSubmit:function(){var e=this;this.$refs.dataFormFolder.validate(function(t){if(t){e.loading=!0;var a=Object.assign({},e.folderRootSetting);e.$axios({url:"/user/folder",method:"put",data:a}).then(function(t){t.c>0?e.$message.error(t.msg):e.$message({message:"设置成功",type:"success"}),e.loading=!1})}})},getConstructionData:function(){var e=this;this.loading=!0,this.$axios({url:"/setting/getConstructionData",method:"get"}).then(function(t){var a=t.ctt;e.SystemSwitch.value=null!=a&&"1"===a.value,e.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},constructionDataSubmit:function(){var e=this;this.loading=!0;var t=Object.assign({});t.value=this.SystemSwitch.value?1:0,this.$axios({url:"/setting/constructionData",method:"post",data:t}).then(function(t){t.c>0?e.$message.error(t.msg):e.$message({message:"设置成功",type:"success"}),e.loading=!1})},getSolrSynchronizationSwitch:function(){var e=this;this.loading=!0,this.$axios({url:"/setting/getSolrSynchronizationSwitch",method:"get"}).then(function(t){var a=t.ctt;e.SystemSwitch.value=null!=a?parseInt(a.value):1,e.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},SolrSynchronizationSwitchSubmit:function(){var e=this;this.loading=!0;var t=Object.assign({});t.value=this.SystemSwitch.value,this.$axios({url:"/setting/solrSynchronizationSwitch",method:"post",data:t}).then(function(t){t.c>0?e.$message.error(t.msg):e.$message({message:"设置成功",type:"success"}),e.loading=!1})},getSolrQueryTemplate:function(){var e=this;this.loading=!0,this.$axios({url:"/setting/solrQueryTemplate",method:"get"}).then(function(t){var a=t.ctt;e.SystemSwitch.queryTemplate=null!=a?a.value:"",e.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},solrQueryTemplateSubmit:function(){var e=this;this.loading=!0;var t=Object.assign({});t.queryTemplate=this.SystemSwitch.queryTemplate,this.$axios({url:"/setting/solrQueryTemplate",method:"post",data:t}).then(function(t){t.c>0?e.$message.error(t.msg):e.$message({message:"设置成功",type:"success"}),e.loading=!1})}}},n=(a("YCs0"),a("KHd+")),o=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"shezhi2"}}),e._v("  系统设置")],1)])])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("div",{staticClass:"pl10"},[a("el-collapse",{staticStyle:{width:"1000px"},attrs:{accordion:""},on:{change:e.collapseChange}},[a("el-collapse-item",{attrs:{name:"1"}},[a("template",{slot:"title"},[a("span",{staticClass:"spanClass"},[a("i",{staticClass:"iconfont icon-denglumima"}),e._v(" 密码配置")])]),e._v(" "),a("el-card",{staticClass:"mg20",attrs:{shadow:"always"}},[a("el-collapse",{attrs:{accordion:""},on:{change:e.handleChange},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-collapse-item",{attrs:{title:"密码设置",name:"1"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"formAddUser",attrs:{model:e.sysPasswordChangeSetting,"label-width":"140px",rules:e.sysPasswordChangeSetting.rules}},[a("el-form-item",{attrs:{label:"密码最小长度",prop:"deptName"}},[a("el-input",{staticClass:"inputClass",model:{value:e.sysPasswordChangeSetting.limit,callback:function(t){e.$set(e.sysPasswordChangeSetting,"limit",t)},expression:"sysPasswordChangeSetting.limit"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码复杂度"}},[a("el-radio-group",{model:{value:e.sysPasswordChangeSetting.model,callback:function(t){e.$set(e.sysPasswordChangeSetting,"model",t)},expression:"sysPasswordChangeSetting.model"}},[a("el-radio",{staticClass:"radio",attrs:{label:0,border:""}},[e._v("任意组合")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:1,border:""}},[e._v("字母大写、字母小写、数字组合")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:2,border:""}},[e._v("字母、数字、特殊字符组合")])],1)],1)],1),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.passwordComplexitySubmit}},[e._v("确定")])],1),e._v(" "),a("el-collapse-item",{attrs:{title:"密码修改提醒设置",name:"2"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"formAddUser",attrs:{model:e.sysPasswordChangeSetting,"label-width":"140px",rules:e.sysPasswordChangeSetting.rules}},[a("el-form-item",{attrs:{label:"强制密码修改天数",prop:"deptName"}},[a("el-input",{staticClass:"inputClass",model:{value:e.sysPasswordChangeSetting.changeDate,callback:function(t){e.$set(e.sysPasswordChangeSetting,"changeDate",t)},expression:"sysPasswordChangeSetting.changeDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"提醒提前天数",prop:"deptName"}},[a("el-input",{staticClass:"inputClass",model:{value:e.sysPasswordChangeSetting.warnDate,callback:function(t){e.$set(e.sysPasswordChangeSetting,"warnDate",t)},expression:"sysPasswordChangeSetting.warnDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"deptName"}},[a("el-checkbox",{attrs:{value:e.sysPasswordChangeSetting.state},on:{change:function(t){e.sysPasswordChangeSetting.state=!e.sysPasswordChangeSetting.state}}})],1)],1),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.passwordExceedSubmit}},[e._v("确定")])],1),e._v(" "),a("el-collapse-item",{attrs:{title:"密码锁定设置",name:"3"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"formAddUser",attrs:{model:e.sysPasswordChangeSetting,"label-width":"140px",rules:e.sysPasswordChangeSetting.rules}},[a("el-form-item",{attrs:{label:"启用密码锁定",prop:"deptName"}},[a("el-checkbox",{attrs:{value:e.sysPasswordChangeSetting.state},on:{change:function(t){e.sysPasswordChangeSetting.state=!e.sysPasswordChangeSetting.state}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"锁定密码错误次数",prop:"deptName"}},[a("el-input",{staticClass:"inputClass",model:{value:e.sysPasswordChangeSetting.lock,callback:function(t){e.$set(e.sysPasswordChangeSetting,"lock",t)},expression:"sysPasswordChangeSetting.lock"}})],1)],1),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.passwordMistakeCountSubmit}},[e._v("确定")])],1)],1)],1)],2),e._v(" "),a("el-collapse-item",{attrs:{name:"2"}},[a("template",{slot:"title"},[a("span",{staticClass:"spanClass"},[a("i",{staticClass:"el-icon-time"}),e._v(" 定时任务配置")])]),e._v(" "),a("el-card",{staticClass:"mg20",attrs:{shadow:"always"}},[a("el-collapse",{attrs:{accordion:""},on:{change:e.handleChangeTiming},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-collapse-item",{attrs:{title:"备份删除设置",name:"1"}},[a("el-form",{ref:"dataFormPassword",attrs:{model:e.sysPasswordChangeSetting,"label-width":"140px",rules:e.sysTimingChangeSetting.rules}},[a("el-form-item",{attrs:{label:"保存月数"}},[a("el-input",{staticClass:"inputClass",attrs:{required:!0},model:{value:e.sysTimingChangeSetting.month,callback:function(t){e.$set(e.sysTimingChangeSetting,"month",t)},expression:"sysTimingChangeSetting.month"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否开启"}},[a("el-checkbox",{attrs:{value:e.sysTimingChangeSetting.state},on:{change:function(t){e.sysTimingChangeSetting.state=!e.sysTimingChangeSetting.state}}})],1)],1),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.TimingDeleteBackupSubmit}},[e._v("确定")])],1)],1)],1)],2),e._v(" "),a("el-collapse-item",{attrs:{name:"3"}},[a("template",{slot:"title"},[a("span",{staticClass:"spanClass"},[a("i",{staticClass:"el-icon-time"}),e._v(" logo与名称配置")])]),e._v(" "),a("el-card",{staticClass:"mg20",attrs:{shadow:"always"}},[a("el-collapse",{attrs:{accordion:""},on:{change:e.handleChangeFolder},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-collapse-item",{attrs:{title:"系统logo设置",name:"1"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{model:e.logoImgSetting,"label-width":"140px",rules:e.logoImgSetting.rules}},[a("el-form-item",[a("div",{staticClass:"fl"},[a("el-upload",{ref:"uploadImg",attrs:{"list-type":"picture-card",multiple:!1,headers:e.token,"auto-upload":!1,action:e.upload.url,limit:1,"on-exceed":e.onUploadNum,"before-upload":e.onUploadBefore,"on-success":e.onUploadSuccess,"on-error":e.onUploadError}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("div",{staticClass:"fl ml10"},[a("img",{staticClass:"imgClass",attrs:{src:e.logoImgSetting.viewImageUrl}})])])],1),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleAddFileSubmit}},[e._v("确定")])],1)],1),e._v(" "),a("el-collapse",{attrs:{accordion:""},on:{change:e.handleChangeFolder},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-collapse-item",{attrs:{title:"文档根节点设置",name:"2"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataFormFolder",attrs:{model:e.folderRootSetting,"label-width":"140px",rules:e.folderRootSetting.rules}},[a("el-form-item",{attrs:{label:"输入新的名称",prop:"name"}},[a("el-input",{staticClass:"inputClass",attrs:{required:!0,placeholder:"请输入内容","auto-complete":"off"},model:{value:e.folderRootSetting.name,callback:function(t){e.$set(e.folderRootSetting,"name",t)},expression:"folderRootSetting.name"}})],1)],1),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.folderRootSubmit}},[e._v("确定")])],1)],1)],1)],2)],1)],1)])],1)},[],!1,null,null,null);t.default=o.exports},"69qQ":function(e,t,a){},"6fut":function(e,t,a){},"90dw":function(e,t,a){},"92tK":function(e,t,a){},"9GKM":function(e,t,a){},"9SOf":function(e,t,a){"use strict";a.r(t);var i={template:"<cron/>",components:{cron:a("EX1t").cron},name:"backup",filters:{ellipsis:function(e){return e?e.length>50?e.slice(0,50)+"...":e:""}},data:function(){return{backupForm:{backgroundImg:"",logo:"",loadText:"备份中...",loading:!1},backupSetting:{id:0,status:0,display:"",cron:"",cronPopover:!1,orgCron:""},backupTable:{height:40,loading:!1,body:[],pageSize:20,total:5,curPage:1}}},mounted:function(){this.tableHeight(),this.getData()},methods:{tableHeight:function(){this.$nextTick(function(){this.backupTable.height=window.innerHeight-this.$refs.table.$el.offsetTop;var e=this;window.onresize=function(){e.backupTable.height=window.innerHeight-e.$refs.table.$el.offsetTop}})},dateFormat:function(e,t,a){return a?this.$moment(a).format("YYYY年MM月DD日 HH:mm:ss"):""},refresh:function(){this.getData()},getData:function(){var e=this;this.$axios({url:"/backup/config/",method:"get"}).then(function(t){e.backupSetting.id=t.ctt.id,e.backupSetting.status=t.ctt.status,e.backupSetting.display=e.$cronstrue.toString(t.ctt.cron.trim(),{use24HourTimeFormat:!0,locale:"zh_CN"}),e.backupSetting.cron=t.ctt.cron.trim(),e.backupSetting.orgCron=t.ctt.cron.trim()}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)}),this.$axios({url:"/backup/list/"+this.backupTable.curPage+"-"+this.backupTable.pageSize,method:"get"}).then(function(t){e.backupTable.body=t.ctt.list,e.backupTable.total=t.ctt.size,e.$nextTick(function(){e.tableHeight()})}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},nextPage:function(e){this.tableData.curPage+=1,this.getData(e)},changeCron:function(e){this.backupSetting.cron=e},start:function(){var e=this;this.$confirm("确认开始自动备份策略吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.$axios({url:"/backup/start",method:"put",data:{id:e.backupSetting.id}}).then(function(t){0===t.c?(e.$message.success("已启动自动备份策略"),e.refresh()):e.$message.error(t.msg)}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})}).catch(function(){})},stop:function(){var e=this;this.$confirm("确认停止自动备份策略吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.$axios({url:"/backup/stop",method:"put",data:{id:e.backupSetting.id}}).then(function(t){0===t.c?(e.$message.success("已停止自动备份策略"),e.refresh()):e.$message.error(t.msg)}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})}).catch(function(){})},editBackupConfig:function(){var e=this;this.backupSetting.cron!==this.backupSetting.orgCron?this.$confirm("确认开始自动备份策略吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.$axios({url:"/backup/config",method:"put",data:{id:e.backupSetting.id,cron:e.backupSetting.cron}}).then(function(t){0===t.c?(e.$message.success("已修改自动备份策略"),e.refresh()):e.$message.error(t.msg)}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})}).catch(function(){}):this.$message.warning("Cron表达式没有发现有更新！")},backupSQL:function(){var e=this;this.$confirm("确认开始数据备份?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.backupForm.loading=!0,e.$axios({url:"/backup",method:"post"}).then(function(t){e.backupForm.loading=!1,0===t.c?e.$message.success("数据备份成功"):e.$message.error(t.msg),e.getData()}).catch(function(t){e.backupForm.loading=!1,e.$message.error("获取数据失败，失败码："+t.response.status)})}).catch(function(){})},deleteBackup:function(e){var t=this;this.$confirm("确认删除这个备份?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){t.$axios({url:"/backup/"+e.id,method:"delete"}).then(function(e){0===e.c?(t.$message.success("已经删除指定备份"),t.refresh()):t.$message.error(e.msg)}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})}).catch(function(){})},downLoadBackUp:function(e){var t=this;this.$axios({url:"/backup/download/"+e.id,method:"post"}).then(function(a){if(!a)return t.$message({message:"下载失败",type:"error"}),void t.getData();var i=new Blob([a]),s=e.directory.split("/");if("download"in document.createElement("a")){var n=document.createElement("a");n.download=s[s.length-1],n.style.display="none",n.href=URL.createObjectURL(i),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else navigator.msSaveBlob(i,fileName)})}}},s=(a("igIz"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.backupForm.loading,expression:"backupForm.loading",modifiers:{fullscreen:!0,lock:!0}}]},[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"yunshujuku"}}),e._v("  系统备份")],1),e._v(" "),a("div",{staticClass:"fxr pl0",staticStyle:{"padding-left":"50px"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.backupSetting.display,placement:"bottom"}},[a("span",{staticStyle:{"font-size":"small"}},[a("b",[e._v("当前备份时间：")]),e._v(e._s(e._f("ellipsis")(e.backupSetting.display)))])])],1)])]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-date",plain:""},on:{click:e.backupSQL}},[e._v("  手动备份")]),e._v(" "),1===e.backupSetting.status?a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-success",plain:""},on:{click:function(t){e.stop()}}},[e._v("  有效状态")]):e._e(),e._v(" "),9===e.backupSetting.status?a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-error",plain:""},on:{click:function(t){e.start()}}},[e._v("  暂停状态")]):e._e(),e._v(" "),a("el-popover",{staticStyle:{"padding-left":"15px"},model:{value:e.backupSetting.cronPopover,callback:function(t){e.$set(e.backupSetting,"cronPopover",t)},expression:"backupSetting.cronPopover"}},[a("cron",{attrs:{i18n:"cn"},on:{change:e.changeCron,close:function(t){e.backupSetting.cronPopover=!1}}}),e._v(" "),a("el-input",{attrs:{slot:"reference",size:"mini",disabled:!0,placeholder:"请输入定时策略"},slot:"reference",model:{value:e.backupSetting.cron,callback:function(t){e.$set(e.backupSetting,"cron",t)},expression:"backupSetting.cron"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-time",plain:""},on:{click:function(t){e.editBackupConfig()}}},[e._v("  修改定时策略")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.backupTable.loading,expression:"backupTable.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.backupTable.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.backupTable.height}},[a("el-table-column",{attrs:{formatter:e.dateFormat,prop:"time",label:"同步时间",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"result",label:"同步结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["备份成功"===t.row.result?a("span",{staticStyle:{color:"#13ce66"}},[e._v(e._s(t.row.result))]):a("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.result))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},on:{click:function(a){e.deleteBackup(t.row)}}})],1)]}}])})],1)],1)],1)},[],!1,null,"17accc9e",null);t.default=n.exports},A4JX:function(e,t,a){"use strict";var i=a("EtmE");a.n(i).a},Bcbd:function(e,t,a){},Bl3E:function(e,t,a){"use strict";var i={name:"EditFolder",props:{addFolder:{type:Function,default:null},editFolder:{type:Function,default:null},deleteFolder:{type:Function,default:null}},data:function(){return{defaultKey:[1],folderTree:{visible:!1,loading:!1,props:{label:"name",children:"children"},body:[],selected:null},formAddFolder:{title:"新建文件夹",visible:!1,loading:!1,data:{id:0,name:"",parentId:0,parentName:""},rules:{name:[{required:!0,message:"请输入文件夹名",trigger:"blur"}]}},formSizeFolder:{title:"编辑可上传文件大小",visible:!1,loading:!1,data:{id:0,name:"",size:0},rules:{name:[{required:!0,message:"请输入上传文件大小",trigger:"blur"}]}},formEditFolder:{title:"编辑文件夹",visible:!1,loading:!1,data:{id:0,orgName:"",name:"",suffix:"",orgParentId:0,orgParentName:"",parentId:0,parentName:""},rules:{name:[{required:!0,message:"请输入新的名称",trigger:"blur"}]}}}},methods:{clear:function(){this.folderTree.body=[],this.folderTree.selected=null,this.formAddFolder.visible=!1,this.formEditFolder.visible=!1,this.formSizeFolder.visible=!1},handleFolderAdd:function(e){this.formAddFolder.visible=!0,this.formAddFolder.data={id:0,name:"",parentId:e.data.id,parentName:e.data.name},this.$refs.formAddFolder&&this.$refs.formAddFolder.resetFields()},handleFolderEdit:function(e){this.formEditFolder.data={id:e.data.id,orgName:e.data.name,name:e.data.name,suffix:"",orgParentId:e.parent.data.id,orgParentName:e.parent.data.name,parentId:e.parent.data.id,parentName:e.parent.data.name},this.printFolderTree(),this.formEditFolder.visible=!0},handleFolderSize:function(e){var t=0;t=e.data.fileSize&&0!==e.data.fileSize?e.data.fileSize:this.$maxFileSize,this.formSizeFolder.data={id:e.data.id,name:e.data.name,size:t},this.formSizeFolder.visible=!0,this.$refs.formSizeFolder&&this.$refs.formSizeFolder.resetFields()},handleFolderAddSubmit:function(){var e=this;this.$refs.formAddFolder.validate(function(t){t&&e.$confirm("确认新增文件夹吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formAddFolder.loading=!0;var t=Object.assign({},e.formAddFolder.data);e.$axios({url:"/admin/folder",method:"post",data:t}).then(function(t){0===t.c?(e.$message.success("新增成功"),e.$refs.formAddFolder.resetFields(),e.formAddFolder.visible=!1,t.ctt.key="folder-"+t.ctt.id,t.ctt.kind="folder",e.addFolder(t)):e.$message.error(t.msg),e.formAddFolder.loading=!1})})})},handleFolderEditSubmit:function(){var e=this;this.$refs.formEditFolder.validate(function(t){t&&e.$confirm("确认提交编辑吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formEditFolder.loading=!0;var t=Object.assign({},e.formEditFolder.data);e.$axios({url:"/user/folder",method:"put",data:t}).then(function(a){0===a.c?(e.$message.success("编辑成功"),e.$refs.formEditFolder.resetFields(),e.formEditFolder.visible=!1,e.editFolder(t)):e.$message.error(a.msg),e.formEditFolder.loading=!1})})})},handleFolderSizeSubmit:function(){var e=this;this.$refs.formSizeFolder.validate(function(t){if(t){if(!e.formSizeFolder.data)return void e.$message.error("请设定一个正整数！");if(!/^\+?[1-9][0-9]*$/.test(e.formSizeFolder.data.size))return void e.$message.error("请设定一个正整数！");if(e.formSizeFolder.data.size>1024)return void e.$message.error("设定大小请不要超过1024MB！");e.$confirm("确认提交编辑吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formSizeFolder.loading=!0;var t=Object.assign({},e.formSizeFolder.data);e.$axios({url:"/admin/folder/"+t.id+"/filesize/"+t.size,method:"put",data:t}).then(function(t){0===t.c?(e.$message.success("编辑成功"),e.$refs.formSizeFolder.resetFields(),e.formSizeFolder.visible=!1):e.$message.error(t.msg),e.formSizeFolder.loading=!1})})}})},handleFolderDelete:function(e){var t=this;this.$confirm("确认删除该文件夹吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var a=Object.assign({},e.data);t.$axios({url:"/admin/folder",method:"delete",data:a}).then(function(e){0===e.c?(t.$message.success("删除成功"),t.deleteFolder(a)):t.$message.error(e.msg)})}).catch(function(){})},printFolderTree:function(){var e=this;this.$axios({url:"/admin/folder/tree",method:"get"}).then(function(t){var a=[];a.push(t.ctt),a[0].isRoot=!0,e.folderTree.body=a}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},folderSelect:function(e){this.folderTree.selected=e,this.formEditFolder.data.parentId=e.id,this.formEditFolder.data.parentName=e.name}}},s=(a("A4JX"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.formAddFolder.title,visible:e.formAddFolder.visible,"close-on-click-modal":!1,width:"400px"},on:{"update:visible":function(t){e.$set(e.formAddFolder,"visible",t)}}},[a("el-form",{ref:"formAddFolder",attrs:{model:e.formAddFolder.data,"label-width":"120px",rules:e.formAddFolder.rules}},[a("el-form-item",{attrs:{label:"上级文件夹名称",prop:"parentname"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formAddFolder.data.parentName,callback:function(t){e.$set(e.formAddFolder.data,"parentName",t)},expression:"formAddFolder.data.parentName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件夹名称",prop:"name"}},[a("el-input",{model:{value:e.formAddFolder.data.name,callback:function(t){e.$set(e.formAddFolder.data,"name",t)},expression:"formAddFolder.data.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new",loading:e.formAddFolder.loading},nativeOn:{click:function(t){return e.handleFolderAddSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.clear(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.formSizeFolder.title,visible:e.formSizeFolder.visible,"close-on-click-modal":!1,width:"400px"},on:{"update:visible":function(t){e.$set(e.formSizeFolder,"visible",t)}}},[a("el-form",{ref:"formSizeFolder",attrs:{model:e.formSizeFolder.data,"label-width":"120px",rules:e.formSizeFolder.rules}},[a("el-form-item",{attrs:{label:"文件夹名称",prop:"parentname"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formSizeFolder.data.name,callback:function(t){e.$set(e.formSizeFolder.data,"name",t)},expression:"formSizeFolder.data.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件大小(MB)",prop:"name"}},[a("el-input",{model:{value:e.formSizeFolder.data.size,callback:function(t){e.$set(e.formSizeFolder.data,"size",t)},expression:"formSizeFolder.data.size"}})],1)],1),e._v(" "),a("div",{staticStyle:{margin:"15px 0 0 15px",padding:"5px",display:"flex",height:"70px","border-radius":"5px",border:"1px solid #dcdfe6"}},[a("span",{staticStyle:{color:"#606266","font-weight":"bold"}},[e._v("说明："),a("br"),e._v("\n                    上传文件大小限定最大为1024MB。"),a("br")])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new",loading:e.formSizeFolder.loading},nativeOn:{click:function(t){return e.handleFolderSizeSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.clear(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.formEditFolder.title,visible:e.formEditFolder.visible,"close-on-click-modal":!0,width:"800px"},on:{"update:visible":function(t){e.$set(e.formEditFolder,"visible",t)}}},[a("el-form",{ref:"formEditFolder",attrs:{model:e.formEditFolder.data,"label-width":"140px",rules:e.formEditFolder.rules}},[a("el-row",{staticStyle:{"min-height":"500px",height:"500px"},attrs:{gutter:30}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"原名称",prop:"orgName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formEditFolder.data.orgName,callback:function(t){e.$set(e.formEditFolder.data,"orgName",t)},expression:"formEditFolder.data.orgName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"输入新的名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formEditFolder.data.name,callback:function(t){e.$set(e.formEditFolder.data,"name",t)},expression:"formEditFolder.data.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"原上级文件夹",prop:"orgParentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formEditFolder.data.orgParentName,callback:function(t){e.$set(e.formEditFolder.data,"orgParentName",t)},expression:"formEditFolder.data.orgParentName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择新的上级文件夹",prop:"parentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formEditFolder.data.parentName,callback:function(t){e.$set(e.formEditFolder.data,"parentName",t)},expression:"formEditFolder.data.parentName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc"}},[a("el-scrollbar",{staticStyle:{height:"450px"}},[e.formEditFolder.visible?a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.folderTree.loading,expression:"folderTree.loading"}],ref:"folderTree",staticClass:"mr20",attrs:{data:e.folderTree.body,props:e.folderTree.props,"highlight-current":"",accordion:!0,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":e.defaultKey},on:{"node-click":e.folderSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("app-svg",{attrs:{iconClass:"zhuye11"}}),e._v(" "),a("span",{staticClass:"span-ellipsis",attrs:{title:i.label}},[e._v(e._s(i.label))])],1):a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia"}}),e._v(" "),a("span",{staticClass:"span-ellipsis",attrs:{title:i.label}},[e._v(e._s(i.label))])],1)])}}])}):e._e()],1)],1)])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.formEditFolder.loading},nativeOn:{click:function(t){return e.handleFolderEditSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.clear(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,"4f269edf",null);t.a=n.exports},CAaF:function(e,t,a){},CVmM:function(e,t,a){"use strict";var i=a("XaRa");a.n(i).a},CbGM:function(e,t,a){"use strict";var i=a("kmx4");a.n(i).a},"Cq+a":function(e,t,a){"use strict";var i=a("vUqt");a.n(i).a},Eij5:function(e,t,a){"use strict";a.r(t);var i=a("FHfX"),s=a("Bl3E"),n=a("MYOy"),o=a("iaoZ"),l=a("Gas7"),r=a.n(l),c={visible:!1,new:!1,modify:!1,read:!1,update:!1,link:!1,download:!1,delete:!1},d={components:{editPermission:i.a,splitPane:r.a,editFolder:s.a,folderAdmin:n.a,folderWhite:o.a},name:"roledept",data:function(){return{memberTree:{data:[],loading:!1,props:{children:"children",label:"name"},selected:null,defaultNodes:["dept-1"],currentKey:""},documentTree:{data:[],loading:!1,props:{children:"children",label:"name"},selected:null},splitClass:"",searchData:{isSearch:!1,text:"",data:""},tableData:{height:0,loading:!0,body:[],pageSize:20,total:0,curPage:0},permissionTable:{height:0,data:{loading:!1,body:[]},page:{pageSize:10,total:0,curPage:1}}}},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.split.$el.offsetTop;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.split.$el.offsetTop}})},printDocumentTree:function(e,t){var a=this,i=void 0;if(0===e.level)i=0;else{if("folder"!==e.data.kind)return void t([]);i=e.data.id}this.documentTree.loading=!0,this.$axios({url:"/admin/folder/"+i+"/docs",method:"get"}).then(function(e){t(e.ctt),a.documentTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},documentSelect:function(e){this.documentTree.selected=e,this.updatePermission(),"folder"===e.kind?this.getFolderPermission(e):"file"===e.kind&&this.getFilePermission(e)},printMemberTree:function(e,t){var a=this,i=void 0;if(0===e.level)i=0;else{if("dept"!==e.data.kind)return void t([]);i=e.data.id}this.memberTree.loading=!0,this.$axios({url:"/admin/dept/"+i+"/members",method:"get"}).then(function(e){var i=!1;e.ctt.forEach(function(e,t){e.roles=c,e.key===a.memberTree.currentKey&&(i=!0)}),t(e.ctt),a.updatePermission(),a.memberTree.loading=!1,a.$nextTick(function(){a.tableHeight(),i&&(a.$refs.memberTree.setCurrentKey(a.memberTree.currentKey),a.memberTree.currentKey="")})}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},updatePermission:function(e){var t=this,a=void 0;if(this.documentTree.selected){var i=void 0;if("folder"===this.documentTree.selected.kind)i="/admin/folder/"+this.documentTree.selected.id+"/members/rps";else{if("file"!==this.documentTree.selected.kind)return;i="/admin/file/"+this.documentTree.selected.id+"/members/rps"}if(0!==(a=e?[e]:this.getAllTreeNodes(this.$refs.memberTree.root)).length){var s=[];a.forEach(function(e){s.push(e.data.key)}),this.$axios({url:i,method:"put",data:s}).then(function(e){var a=t;Object.keys(e.ctt).forEach(function(t){a.$refs.memberTree.getNode(t).data.roles=e.ctt[t]})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})}}else(a=this.getAllTreeNodes(this.$refs.memberTree.root)).forEach(function(e){e.data.roles=c})},getAllTreeNodes:function(e){var t=[],a=this;return e.data.id&&t.push(e),e.childNodes.forEach(function(e){t=t.concat(a.getAllTreeNodes(e))}),t},onMouseDown:function(){this.$refs.split.active&&(this.splitClass="active")},onMouseUp:function(){this.$refs.split.active||(this.splitClass="")},search:function(){this.searchData.text&&this.searchData.text.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchData.text.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchData.data=this.searchData.text,this.searchData.isSearch=!0,this.refresh()):this.$message.success("请输入搜索关键词")},getData:function(e){var t=this;this.searchData.data?(this.tableData.loading=this.$refs.infinite.isFirstLoad,this.$axios({url:"/admin/search/file/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?key="+this.searchData.data,method:"get"}).then(function(a){var i=[];i.push(a.ctt.list),i[0].length>0&&1===i[0][0].id&&(i[0][0].isRoot=!0),t.tableData.body=t.tableData.body.concat(a.ctt.list),t.tableData.total=a.ctt.total,t.tableData.loading=!1,0==a.ctt.list.length?e&&e.complete():e&&e.loaded()}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})):e.complete()},refresh:function(){this.tableData.total=0,this.tableData.body=[],this.tableData.curPage=0,this.documentSelect(null),this.$refs.infinite&&this.$refs.infinite.stateChanger.reset()},clearSearchTxt:function(){var e=this;this.searchData.isSearch=!1,this.searchData.data="",this.$nextTick(function(){e.documentSelect(e.$refs.documentTree.getCurrentNode())}),this.refresh()},nextPage:function(e){this.tableData.curPage+=1,this.getData(e)},currentChange:function(e){this.documentSelect(e)},addFolder:function(e){this.$refs.documentTree.append(e.ctt,"folder-"+e.ctt.parentId)},editFolder:function(e){e.key="folder-"+e.id;var t=this.$refs.documentTree.getNode(e);this.$refs.documentTree.remove(t),this.$refs.documentTree.append(t.data,"folder-"+e.parentId),t.data.name=e.name},deleteFolder:function(e){this.$refs.documentTree.remove(e)},getFolderPermission:function(e){var t=this;this.permissionTable.data.loading=!0,this.$axios({url:"/admin/folder/"+e.id+"/rps",method:"get"}).then(function(e){t.permissionTable.data.body=e.ctt,t.permissionTable.page.total=e.ctt.total,t.permissionTable.data.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},getFilePermission:function(e){var t=this;this.permissionTable.data.loading=!0,this.$axios({url:"/admin/file/"+e.id+"/rps",method:"get"}).then(function(e){t.permissionTable.data.body=e.ctt,t.permissionTable.page.total=e.ctt.total,t.permissionTable.data.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},permissionChange:function(e){var t=this;if(e){var a=void 0;a=2===e.type?"/admin/user/"+e.memberId+"/organization":"/admin/dept/"+e.memberId+"/organization";for(var i=0;i<this.$refs.memberTree.store._getAllNodes().length;i++)this.$refs.memberTree.store._getAllNodes()[i].expanded=!1;this.$axios({url:a,method:"get"}).then(function(a){var i=a.ctt[0].split("/"),s=[];i.forEach(function(t,a){""!==t&&(a===i.length-1&&1===e.type||s.push("dept-"+t))}),t.$nextTick(function(){var a=void 0;a=2===e.type?"user-"+e.memberId:"dept-"+e.memberId,t.$refs.memberTree.getNode(a)?t.$refs.memberTree.setCurrentKey(a):t.memberTree.currentKey=a}),t.memberTree.defaultNodes=s}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})}},refreshPermissionTable:function(){"folder"===this.documentTree.selected.kind?this.getFolderPermission(this.documentTree.selected):this.getFilePermission(this.documentTree.selected)},handlePermissionDeleteSubmit:function(e,t){var a=this;this.$confirm("确认删除选中权限吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e;e={rolePermissions:[{id:t.id}]};var i=Object.assign({},e);a.$axios({url:"/admin/role",method:"delete",data:i}).then(function(e){0===e.c?(a.$message.success("权限删除成功"),a.documentSelect(a.$refs.documentTree.getCurrentNode())):a.$message.error(e.msg)})})},handleCommand:function(e){switch(e.name){case"PermissionEdit":this.$refs.editPermission.handlePermissionEdit(e.node.data,this.memberTree.selected,e.node.data.roles);break;case"FolderAdd":this.$refs.editFolder.handleFolderAdd(e.node);break;case"FolderEdit":this.$refs.editFolder.handleFolderEdit(e.node);break;case"WhiteList":this.$refs.folderWhite.handleWhiteList(e.node);break;case"FolderAdmin":this.$refs.folderAdmin.handleFolderAdmin(e.node);break;case"FolderDelete":this.$refs.editFolder.handleFolderDelete(e.node)}}}},u=(a("JJ5H"),a("KHd+")),f=Object(u.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"106"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"wenjianjia1"}}),e._v("  文件夹权限管理")],1)])])]),e._v(" "),a("split-pane",{ref:"split",attrs:{split:"vertical",className:e.splitClass,defaultPercent:33},nativeOn:{mousedown:function(t){return e.onMouseDown(t)},mouseup:function(t){return e.onMouseUp(t)}}},[a("template",{slot:"paneL"},[a("el-scrollbar",{directives:[{name:"show",rawName:"v-show",value:!e.searchData.isSearch,expression:"!searchData.isSearch"}]},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.documentTree.loading,expression:"documentTree.loading"}],ref:"documentTree",staticClass:"mr20",attrs:{data:e.documentTree.data,"highlight-current":"",props:e.documentTree.props,"default-expand-all":!1,"expand-on-click-node":!1,lazy:"",load:e.printDocumentTree,"node-key":"key","default-expanded-keys":["folder-1"]},on:{"node-click":e.documentSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",["folder"===s.kind?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-document"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])]):a("div",["folder"===s.kind?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-wenjianjia3"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[a("app-svg",{attrs:{iconText:s.suffix}}),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.label,placement:"bottom"}},[a("span",{staticClass:"ib",staticStyle:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden","max-width":"150px"}},[e._v(e._s(i.label))])])],1)]),e._v(" "),a("span",{staticClass:"ib",staticStyle:{width:"50px"}},["folder"===s.kind?a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},["folder"===s.kind?a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-guanli_danse ",circle:""}}):e._e(),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:{name:"FolderAdd",node:i}}},[e._v("新增下级菜单")]),e._v(" "),"folder-1"!==s.key?a("el-dropdown-item",{attrs:{command:{name:"FolderEdit",node:i}}},[e._v("文件夹编辑")]):e._e(),e._v(" "),"folder-1"!==s.key?a("el-dropdown-item",{attrs:{command:{name:"FolderAdmin",node:i}}},[e._v("设置文件夹管理员")]):e._e(),e._v(" "),"folder-1"!==s.key?a("el-dropdown-item",{attrs:{command:{name:"FolderDelete",node:i}}},[e._v("删除文件夹")]):e._e()],1)],1):e._e()],1)])}}])})],1),e._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.searchData.isSearch,expression:"searchData.isSearch"},{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height},on:{"current-change":e.currentChange}},[a("el-table-column",{attrs:{prop:"name",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return["folder"===t.row.kind?a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.name))])],1):a("div",[a("app-svg",{attrs:{iconText:t.row.suffix}}),e._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.name)+"."+e._s(t.row.suffix))])],1)]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1),e._v(" "),a("template",{slot:"paneR"},[a("split-pane",{ref:"split",attrs:{split:"vertical",className:e.splitClass,defaultPercent:40},nativeOn:{mousedown:function(t){return e.onMouseDown(t)},mouseup:function(t){return e.onMouseUp(t)}}},[a("template",{slot:"paneL"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.permissionTable.data.loading,expression:"permissionTable.data.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.permissionTable.data.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height},on:{"current-change":e.permissionChange}},[a("el-table-column",{attrs:{prop:"memberName",label:"组织/用户","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.type?a("div",[a("app-svg",{attrs:{iconClass:"drxx95"}}),e._v(" "),a("b",[e._v(e._s(t.row.memberName))])],1):a("div",[a("app-svg",{attrs:{iconClass:"drxx10"}}),e._v(" "),a("b",[e._v(e._s(t.row.memberName))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"权限",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"可见",placement:"bottom"}},[t.row.explication.visible?a("i",{staticClass:"iconfont icon-liulan"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[t.row.explication.read?a("i",{staticClass:"iconfont icon-wenjian"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"更新文件",placement:"bottom"}},[t.row.explication.update?a("i",{staticClass:"iconfont icon-caozuo-shangchuan-upload"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增文件",placement:"bottom"}},[t.row.explication.new?a("i",{staticClass:"iconfont icon-add"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"重命名",placement:"bottom"}},[t.row.explication.modify?a("i",{staticClass:"iconfont icon-edit-file"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"bottom"}},[t.row.explication.download?a("i",{staticClass:"iconfont icon-caozuo-shangchuan-download"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"外链",placement:"bottom"}},[t.row.explication.link?a("i",{staticClass:"iconfont icon-wailian"}):e._e()]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"bottom"}},[t.row.explication.delete?a("i",{staticClass:"iconfont icon-trash"}):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除权限",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},on:{click:function(a){e.handlePermissionDeleteSubmit(t.$index,t.row)}}})],1)]}}])})],1)],1)],1),e._v(" "),a("template",{slot:"paneR"},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTree.loading,expression:"memberTree.loading"}],ref:"memberTree",attrs:{data:e.memberTree.data,"highlight-current":"",props:e.memberTree.props,"expand-on-click-node":!1,lazy:"","node-key":"key",load:e.printMemberTree,"default-expanded-keys":e.memberTree.defaultNodes},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",["dept"===s.kind?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-user"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):2===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):0===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-user"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("span",[e._v(e._s(i.label))])])]),e._v(" "),a("span",{staticClass:"mr20"},[a("span",{staticClass:"mr20 ib",staticStyle:{width:"140px"}},[s.roles.visible?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"可见",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-liulan"})])],1):e._e(),e._v(" "),s.roles.read?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-wenjian"})])],1):e._e(),e._v(" "),s.roles.update?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"更新文件",placement:"bottom"}},[s.roles.visible?a("i",{staticClass:"iconfont icon-caozuo-shangchuan-upload"}):e._e()])],1):e._e(),e._v(" "),s.roles.new?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增文件",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-add"})])],1):e._e(),e._v(" "),s.roles.modify?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"重命名",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-edit-file"})])],1):e._e(),e._v(" "),s.roles.download?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-caozuo-shangchuan-download"})])],1):e._e(),e._v(" "),s.roles.link?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"外链",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-wailian"})])],1):e._e(),e._v(" "),s.roles.delete?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"bottom"}},[a("i",{staticClass:"iconfont icon-trash"})])],1):e._e()]),e._v(" "),a("span",{staticClass:"ib",staticStyle:{width:"50px"}},[e.documentTree.selected?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设定权限",placement:"right"}},[a("el-button",{attrs:{type:"text",size:"mini",icon:"iconfont icon-drxx74",circle:""},nativeOn:{click:function(t){e.$refs.editPermission.handlePermissionEdit(e.documentTree.selected,s,s.roles)}}})],1):e._e()],1)])])}}])})],1)],1)],2)],1)],2),e._v(" "),a("edit-permission",{ref:"editPermission",attrs:{"edit-permission":e.refreshPermissionTable}}),e._v(" "),a("edit-folder",{ref:"editFolder",attrs:{"add-folder":e.addFolder,"edit-folder":e.editFolder,"delete-folder":e.deleteFolder}}),e._v(" "),a("folder-admin",{ref:"folderAdmin"}),e._v(" "),a("folder-white",{ref:"folderWhite"})],1)},[],!1,null,"1ebac579",null);t.default=f.exports},EtmE:function(e,t,a){},Ex8b:function(e,t,a){"use strict";a.r(t);var i={name:"EditJob",props:{addJob:{type:Function,default:null},editJob:{type:Function,default:null}},data:function(){return{formJob:{isNew:!1,title:"",visible:!1,loading:!1,data:{id:0,workflowname:"",classname:"",cron:""},rules:{cron:[{required:!0,message:"执行时间",trigger:"blur"}]}}}},methods:{handleAdd:function(){this.$refs.formJob&&this.$refs.formJob.resetFields(),this.formJob.isNew=!0,this.formJob.title="新增接口设定",this.formJob.data={id:0,workflowname:"",classname:"",cron:""},this.formJob.visible=!0},addSubmit:function(){var e=this;this.$refs.formJob.validate(function(t){t&&e.$confirm("确认新增吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formJob.loading=!0;var t=Object.assign({},e.formJob.data);e.$axios({url:"/task/job?name="+t.name+"&group="+t.group+"&cron="+t.cron,method:"post"}).then(function(t){0===t.c?(e.$message.success("添加接口成功"),e.formJob.visible=!1,e.addJob()):e.$message.error(t.msg),e.formJob.loading=!1})})})},handleEditSetting:function(e,t){this.$refs.formJob&&this.$refs.formJob.resetFields(),this.formJob.isNew=!1,this.formJob.title="编辑接口执行时间(Cron表达式编辑)",this.formJob.data={id:t.id,workflowname:t.workflowname,classname:t.classname,cron:t.cron},this.formJob.visible=!0},handleEditSettingSubmit:function(){var e=this;this.$refs.formJob.validate(function(t){t&&e.$confirm("确认提交新的执行时间吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formJob.loading=!0;var t=Object.assign({},e.formJob.data);e.$axios({url:"/relay/process/cron",method:"put",data:t}).then(function(t){0===t.c?(e.$message.success("编辑执行时间成功"),e.formJob.visible=!1,e.editJob()):e.$message.error(t.msg),e.formJob.loading=!1})})})},handlePauseSubmit:function(e,t){var a=this;this.$confirm("确认暂停批处理吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){a.formJob.loading=!0;var e={id:t.id};a.$axios({url:"/relay/process/pause",method:"put",data:e}).then(function(e){0===e.c?(a.$message.success("暂停执行批处理"),a.formJob.visible=!1,a.editJob()):a.$message.error(e.msg),a.formJob.loading=!1})})},handleResumeSubmit:function(e,t){var a=this;this.$confirm("确认开始批处理吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){a.formJob.loading=!0;var e={id:t.id};a.$axios({url:"/relay/process/resume",method:"put",data:e}).then(function(e){0===e.c?(a.$message.success("开始执行批处理"),a.formJob.visible=!1,a.editJob()):a.$message.error(e.msg),a.formJob.loading=!1})})}}},s=(a("Pbmn"),a("KHd+")),n={components:{EditJob:Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.formJob.title,visible:e.formJob.visible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.$set(e.formJob,"visible",t)}}},[a("el-form",{ref:"formJob",attrs:{model:e.formJob.data,"label-width":"120px",rules:e.formJob.rules}},[a("el-form-item",{attrs:{label:"执行流程名称",prop:"workflowname"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formJob.data.workflowname,callback:function(t){e.$set(e.formJob.data,"workflowname",t)},expression:"formJob.data.workflowname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行程序",prop:"classname"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formJob.data.classname,callback:function(t){e.$set(e.formJob.data,"classname",t)},expression:"formJob.data.classname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行时间表达式",prop:"cron"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formJob.data.cron,callback:function(t){e.$set(e.formJob.data,"cron",t)},expression:"formJob.data.cron"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.formJob.isNew?a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.formJob.loading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]):e._e(),e._v(" "),e.formJob.isNew?e._e():a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.formJob.loading},nativeOn:{click:function(t){return e.handleEditSettingSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){e.formJob.visible=!1}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)},[],!1,null,"735294dd",null).exports},name:"oaapi",data:function(){return{tableApi:{height:0,loading:!1,data:[]}}},mounted:function(){this.getData(),this.tableHeight()},methods:{tableHeight:function(){this.$nextTick(function(){this.tableApi.height=window.innerHeight-this.$refs.table.$el.offsetTop-200;var e=this;window.onresize=function(){e.tableApi.height=window.innerHeight-e.$refs.table.$el.offsetTop-200}})},getData:function(){var e=this;this.tableApi.loading=!0,this.$axios({url:"/relay/process/settings",method:"get"}).then(function(t){e.tableApi.data=t.ctt,e.tableApi.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})}}},o=(a("3WS4"),Object(s.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"OA"}}),e._v("  OA导入批处理设定")],1)])])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableApi.loading,expression:"tableApi.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableApi.data,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableApi.height}},[a("el-table-column",{attrs:{prop:"workflowid",label:"流程ID",width:"128px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"workflowname",label:"流程名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cron",label:"执行时间cron配置"}}),e._v(" "),a("el-table-column",{attrs:{label:"编辑执行时间",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑执行时间",placement:"bottom"}},[a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-file",circle:""},nativeOn:{click:function(a){e.$refs.job.handleEditSetting(t.$index,t.row)}}})],1)],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"启动/暂停",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"批处理已经启动，点击暂停",placement:"bottom"}},[1===t.row.status?a("el-button",{attrs:{type:"danger",size:"mini"},nativeOn:{click:function(a){e.$refs.job.handlePauseSubmit(t.$index,t.row)}}},[a("span",{staticStyle:{"font-size":"12px"}},[e._v("暂停")])]):e._e()],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"批处理已经暂停，点击启动",placement:"bottom"}},[9===t.row.status?a("el-button",{attrs:{type:"primary",size:"mini"},nativeOn:{click:function(a){e.$refs.job.handleResumeSubmit(t.$index,t.row)}}},[a("span",{staticStyle:{"font-size":"12px"}},[e._v("启动")])]):e._e()],1)],1)]}}])})],1)],1)],1),e._v(" "),a("edit-job",{ref:"job",attrs:{"add-job":e.getData,"edit-job":e.getData}})],1)},[],!1,null,"22c3b7cf",null));t.default=o.exports},FHfX:function(e,t,a){"use strict";var i=[{key:"visible",value:"可见"},{key:"new",value:"上传新文件"},{key:"modify",value:"重命名"},{key:"read",value:"预览"},{key:"update",value:"文件更新"},{key:"link",value:"文件外链"},{key:"download",value:"文件下载"},{key:"delete",value:"删除"}],s={name:"EditPermission",props:{editPermission:{type:Function,default:null}},data:function(){return{fromPermissionData:{data:{id:0,userId:0,deptId:0,type:0,name:"",rolePermissions:[{id:0,roleId:0,code:"",resourceId:0,resourceName:"",resourceSuffix:"",fullPath:"",fullName:"",explication:{delete:!1,download:!1,link:!1,modify:!1,new:!1,read:!1,update:!1,visible:!1}}]},permissionOptions:{all:!1,checked:[],options:i,isIndeterminate:!0},rules:{},visible:{new:!1,modify:!1},loading:!1}}},methods:{handlePermissionEdit:function(e,t,a){this.fromPermissionData.visible.modify=!0,this.fromPermissionData.data={id:0,userId:"user"===t.kind?t.id.id:0,deptId:"dept"===t.kind?t.id:0,type:"dept"===t.kind?1:2,name:t.name,rolePermissions:[{id:t.id,roleId:0,code:e.kind,resourceId:e.id,resourceName:e.name,resourceSuffix:e.suffix,fullPath:e.fullPath,fullName:e.fullName,explication:a}]},this.fromPermissionData.data.userId="user"===t.kind?t.id:0,this.fromPermissionData.data.deptId="dept"===t.kind?t.id:0,this.fromPermissionData.data.type="dept"===t.kind?1:2,this.fromPermissionData.data.name=t.name;for(var s=[],n=0;n<i.length;n++)switch(i[n].key){case"delete":this.fromPermissionData.data.rolePermissions[0].explication.delete&&s.push(i[n]);break;case"download":this.fromPermissionData.data.rolePermissions[0].explication.download&&s.push(i[n]);break;case"link":this.fromPermissionData.data.rolePermissions[0].explication.link&&s.push(i[n]);break;case"modify":this.fromPermissionData.data.rolePermissions[0].explication.modify&&s.push(i[n]);break;case"new":this.fromPermissionData.data.rolePermissions[0].explication.new&&s.push(i[n]);break;case"read":this.fromPermissionData.data.rolePermissions[0].explication.read&&s.push(i[n]);break;case"update":this.fromPermissionData.data.rolePermissions[0].explication.update&&s.push(i[n]);break;case"visible":this.fromPermissionData.data.rolePermissions[0].explication.visible&&s.push(i[n])}this.fromPermissionData.permissionOptions.checked=s,this.handleCheckedCitiesChange(s),this.$refs.fromPermissionData&&this.$refs.fromPermissionData.resetFields()},handlePermissionAddSubmit:function(){var e=this;this.$refs.fromPermissionData.validate(function(t){t&&e.$confirm("确认新增权限吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.fromPermissionData.loading=!0;var t=Object.assign({},e.fromPermissionData.data);t.rolePermissions[0].explication.delete=!1,t.rolePermissions[0].explication.download=!1,t.rolePermissions[0].explication.link=!1,t.rolePermissions[0].explication.modify=!1,t.rolePermissions[0].explication.new=!1,t.rolePermissions[0].explication.read=!1,t.rolePermissions[0].explication.update=!1,t.rolePermissions[0].explication.visible=!1;for(var a=0;a<e.fromPermissionData.permissionOptions.checked.length;a++)switch(e.fromPermissionData.permissionOptions.checked[a].key){case"delete":t.rolePermissions[0].explication.delete=!0;break;case"download":t.rolePermissions[0].explication.download=!0;break;case"link":t.rolePermissions[0].explication.link=!0;break;case"modify":t.rolePermissions[0].explication.modify=!0;break;case"new":t.rolePermissions[0].explication.new=!0;break;case"read":t.rolePermissions[0].explication.read=!0;break;case"update":t.rolePermissions[0].explication.update=!0;break;case"visible":t.rolePermissions[0].explication.visible=!0}e.$axios({url:"/admin/role",method:"post",data:t}).then(function(t){0===t.c?(e.$message.success("新增权限成功"),e.fromPermissionData.visible.modify=!1,e.handleResetPermission(),e.editPermission&&e.editPermission()):e.$message.error(t.msg),e.fromPermissionData.loading=!1})})})},handlePermissionCancel:function(){this.handleResetPermission(),this.fromPermissionData.visible.new=!1,this.fromPermissionData.visible.modify=!1},handleResetPermission:function(){this.fromPermissionData.data={id:0,userId:0,deptId:0,type:0,name:"",rolePermissions:[{id:0,roleId:0,code:"",resourceId:0,resourceName:"",resourceSuffix:"",fullPath:"",fullName:"",explication:{delete:!1,download:!1,link:!1,modify:!1,new:!1,read:!1,update:!1,visible:!1}}]},this.fromPermissionData.permissionOptions.all=!1,this.fromPermissionData.permissionOptions.checked=[],this.fromPermissionData.permissionOptions.isIndeterminate=!1,this.$refs.fromPermissionData&&this.$refs.fromPermissionData.resetFields()},handleCheckAllChange:function(e){this.fromPermissionData.permissionOptions.checked=e?i:[],this.fromPermissionData.permissionOptions.isIndeterminate=!1},handleCheckedCitiesChange:function(e){var t=e.length;this.fromPermissionData.permissionOptions.all=t===this.fromPermissionData.permissionOptions.options.length,this.fromPermissionData.permissionOptions.isIndeterminate=t>0&&t<this.fromPermissionData.permissionOptions.options.length}}},n=(a("pmdA"),a("KHd+")),o=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"设定权限",visible:e.fromPermissionData.visible.modify,"close-on-click-modal":!1,width:"450px"},on:{"update:visible":function(t){e.$set(e.fromPermissionData.visible,"modify",t)}}},[a("el-form",{ref:"fromPermissionData",attrs:{model:e.fromPermissionData.data,"label-width":"120px",rules:e.fromPermissionData.rules}},[a("el-form-item",{staticStyle:{"font-style":"oblique","font-weight":"bold"},attrs:{label:"编辑权限对象：",prop:"name"}},[1===e.fromPermissionData.data.type?a("div",[a("app-svg",{attrs:{iconClass:"drxx95"}}),e._v(" "),a("span",{staticStyle:{"font-style":"normal","font-weight":"normal"}},[e._v(e._s(this.fromPermissionData.data.name))])],1):a("div",[a("app-svg",{attrs:{iconClass:"drxx10"}}),e._v(" "),a("span",{staticStyle:{"font-style":"normal","font-weight":"normal"}},[e._v(e._s(this.fromPermissionData.data.name))])],1)]),e._v(" "),a("el-form-item",{staticStyle:{"font-style":"oblique","font-weight":"bold"},attrs:{label:"当前编辑资源：",prop:"name"}},["folder"===e.fromPermissionData.data.rolePermissions[0].code?a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("span",{staticStyle:{"font-style":"normal","font-weight":"normal"}},[e._v(e._s(this.fromPermissionData.data.rolePermissions[0].resourceName))])],1):a("div",[a("app-svg",{attrs:{iconText:e.fromPermissionData.data.rolePermissions[0].resourceSuffix}}),e._v(" "),a("span",{staticStyle:{"font-style":"normal","font-weight":"normal"}},[e._v(e._s(this.fromPermissionData.data.rolePermissions[0].resourceName)+"."+e._s(this.fromPermissionData.data.rolePermissions[0].resourceSuffix))])],1)]),e._v(" "),a("el-checkbox",{attrs:{indeterminate:e.fromPermissionData.permissionOptions.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.fromPermissionData.permissionOptions.all,callback:function(t){e.$set(e.fromPermissionData.permissionOptions,"all",t)},expression:"fromPermissionData.permissionOptions.all"}},[e._v("全选")]),e._v(" "),a("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.fromPermissionData.permissionOptions.checked,callback:function(t){e.$set(e.fromPermissionData.permissionOptions,"checked",t)},expression:"fromPermissionData.permissionOptions.checked"}},[a("el-row",e._l(e.fromPermissionData.permissionOptions.options,function(t,i){return a("el-col",{key:i,staticStyle:{"margin-bottom":"20px"},attrs:{span:6,offset:2}},[a("el-checkbox",{key:t.key,attrs:{label:t}},[e._v("\n                            "+e._s(t.value)+"\n                        ")])],1)}))],1),e._v(" "),a("div",{staticStyle:{margin:"15px 0 0 15px",padding:"5px",display:"flex",height:"100px","border-radius":"5px",border:"1px solid #dcdfe6"}},[a("span",{staticStyle:{color:"#606266","font-weight":"bold"}},[e._v("说明："),a("br"),e._v("\n                    1 、为文件夹设置权限后，它的子文件/子文件夹都将继承这个权限，除非其有自己的权限设置。"),a("br"),e._v("\n                    2、对部门设置了某个文件/文件夹的权限，则它的子部门及用户都将继承这个权限，除非其有自己的权限设置。"),a("br")])])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new",loading:e.fromPermissionData.loading},nativeOn:{click:function(t){return e.handlePermissionAddSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.handlePermissionCancel(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,"7d79fb19",null);t.a=o.exports},FKUh:function(e,t,a){"use strict";var i=a("yrUs");a.n(i).a},FVNA:function(e,t,a){"use strict";var i=a("qr45");a.n(i).a},FsOF:function(e,t,a){},"Fvx+":function(e,t,a){"use strict";var i={name:"Password",data:function(){return{formPassword:{data:{oldPassword:"",newPassword:"",repeatPassword:""},visible:!1,loading:!1,rules:{oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"},{min:6,message:"请输入不少于6个字符",trigger:"blur"}],repeatPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"},{validator:this.checkRepeatPassword,trigger:"blur"}]}}}},methods:{checkRepeatPassword:function(e,t,a){t!=this.formPassword.data.newPassword?a(new Error("重新输入密码和新密码不一致")):a()},handlePassword:function(){this.$refs.formPassword&&this.$refs.formPassword.resetFields(),this.formPassword.visible=!0},handlePasswordSubmit:function(){var e=this;this.$refs.formPassword.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formPassword.loading=!0;var t=Object.assign({},e.formPassword.data);t.checkPass1=e.formPassword.data.newPassword,t.password=e.formPassword.data.oldPassword,e.$axios({url:"/settings/password",method:"post",data:t}).then(function(t){0===t.c?(e.$message.success("提交成功"),e.formPassword.visible=!1):e.$message.error(t.msg),e.formPassword.loading=!1})})})}}},s=(a("LC0H"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"修改密码",visible:e.formPassword.visible,"close-on-click-modal":!0,width:"500px"},on:{"update:visible":function(t){e.$set(e.formPassword,"visible",t)}}},[a("el-form",{ref:"formPassword",attrs:{model:e.formPassword.data,"label-width":"120px",rules:e.formPassword.rules}},[a("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.formPassword.data.oldPassword,callback:function(t){e.$set(e.formPassword.data,"oldPassword",t)},expression:"formPassword.data.oldPassword"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.formPassword.data.newPassword,callback:function(t){e.$set(e.formPassword.data,"newPassword",t)},expression:"formPassword.data.newPassword"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"重新输入密码",prop:"repeatPassword"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.formPassword.data.repeatPassword,callback:function(t){e.$set(e.formPassword.data,"repeatPassword",t)},expression:"formPassword.data.repeatPassword"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.formPassword.loading},nativeOn:{click:function(t){return e.handlePasswordSubmit(t)}}},[e._v("确定")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formPassword.visible=!1}}},[e._v("取消")])],1)],1)},[],!1,null,"2a88eb2c",null);t.a=n.exports},"Fzc/":function(e,t,a){"use strict";var i=a("k0WT");a.n(i).a},HhBK:function(e,t,a){"use strict";a.r(t);var i={name:"DeptAndTimeCondition",props:{setCondition:{type:Function,default:null}},data:function(){return{formCondition:{title:"",isDelete:!1,data:{selected:null,dateRange:"",isDelete:!1},rules:{},visible:!1,loading:!1},deptTree:{data:[],props:{children:"children",label:"name"},loading:!1,selected:null},pickerDateRange:{Options:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}}},methods:{handleCondition:function(){this.formCondition.title="选择检索条件",this.formCondition.visible=!0},getDept:function(){var e=this;this.deptTree.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),e.deptTree.data=a,e.deptTree.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},selectDept:function(e){this.deptTree.selected=e,this.formCondition.data.selected=e},handleConditionSubmit:function(){this.setCondition(this.formCondition.data),this.formCondition.visible=!1}}},s=(a("2ZLj"),a("KHd+")),n={components:{DeptAndTimeCondition:Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.formCondition.title,visible:e.formCondition.visible,"close-on-click-modal":!0,width:"700px"},on:{"update:visible":function(t){e.$set(e.formCondition,"visible",t)},open:e.getDept}},[a("el-form",{ref:"formCondition",attrs:{model:e.formCondition.data,"label-width":"0px",rules:e.formCondition.rules}},[a("el-row",{staticStyle:{"min-height":"400px",height:"400px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"400px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTree.loading,expression:"deptTree.loading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptTree.data,"highlight-current":"",props:e.deptTree.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.selectDept},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-form-item",{attrs:{label:"",prop:"name"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","value-format":"yyyy-MM-dd HH:mm:ss","end-placeholder":"结束日期","picker-options":e.pickerDateRange.Options},model:{value:e.formCondition.data.dateRange,callback:function(t){e.$set(e.formCondition.data,"dateRange",t)},expression:"formCondition.data.dateRange"}})],1),e._v(" "),e.formCondition.isDelete?a("el-form-item",[a("el-checkbox",{model:{value:e.formCondition.data.isDelete,callback:function(t){e.$set(e.formCondition.data,"isDelete",t)},expression:"formCondition.data.isDelete"}},[e._v("同时删除检索结果数据")])],1):e._e()],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.formCondition.loading},on:{click:e.handleConditionSubmit}},[e._v("确定")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formCondition.visible=!1}}},[e._v("取消")])],1)],1)],1)},[],!1,null,"78d03efa",null).exports},name:"trash",data:function(){return{viewImageUrl:this.$upload+"/setting/getLogoImg?seed=",tableData:{height:0,loading:!0,body:[]},paginationData:{pageSize:1e3,total:0,curPage:1},multipleSelection:[],searchTxt:"",condition:{visible:!1,name:"",dept:{id:0},dateRange:["",""]}}},mounted:function(){this.getData(),this.tableHeight()},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.table.$el.offsetTop-200;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.table.$el.offsetTop-200}})},refresh:function(){this.getData()},getData:function(){var e=this;this.tableData.loading=!0,this.$axios({url:"/admin/file/deleted/"+this.paginationData.curPage+"-"+this.paginationData.pageSize,method:"get"}).then(function(t){e.tableData.body=t.ctt.list,e.paginationData.total=t.ctt.total,e.tableData.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},search:function(){var e=this;this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.tableData.loading=!0,this.$axios({url:"/admin/file/deleted/search/"+this.paginationData.curPage+"-"+this.paginationData.pageSize+"?name="+this.searchTxt.trim(),method:"get"}).then(function(t){e.tableData.body=t.ctt.list,e.paginationData.total=t.ctt.total,e.tableData.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})):this.$message.success("请输入搜索关键词")},setCondition:function(e){console.log(e),null!==e.selected?(this.condition.dept=e.selected.id,this.condition.name=e.selected.name+"  "):this.condition.id=0,null!==e.dateRange&&e.dateRange.length>0?this.condition.dateRange=e.dateRange:this.condition.dateRange=["",""],e.dateRange&&2===e.dateRange.length&&(this.condition.name+=this.$moment(e.dateRange[0]).format("YYYY年MM月DD日")+"〜"+this.$moment(e.dateRange[1]).format("MM月DD日")),""!==this.condition.name&&(this.condition.visible=!0),this.refresh()},sizeChange:function(e){this.paginationData.pageSize=e,this.getData()},pageChange:function(e){this.paginationData.curPage=e,this.getData()},handleSelectionChange:function(e){this.multipleSelection=e},dateFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("YYYY年MM月DD日 HH:mm")},dateShortFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("MM月DD日 HH:mm")},handleRollback:function(e,t){var a=this;this.$confirm("是否恢复该记录?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){a.tableData.loading=!0;var e=Object.assign({},t);a.$axios({url:"/admin/file/deleted",method:"put",data:e}).then(function(e){a.$message({message:"恢复完成",type:"success"}),a.getData(),a.tableData.loading=!1})}).catch(function(){})},handleMultiRollback:function(){var e=this;0!==this.multipleSelection.length?this.$confirm("确认恢复这些文件吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.tableData.loading=!0;var t=e.multipleSelection;e.$axios({url:"/admin/file/deleteds",method:"put",data:t}).then(function(t){e.$message({message:"恢复成功",type:"success"}),e.getData(),e.tableData.loading=!1})}).catch(function(){}):this.$message.error("没有选择需要恢复的文件，请重新选择！")},handleDelete:function(e,t){var a=this;this.$confirm("彻底删除该记录?(被删除记录无法恢复)","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){a.tableData.loading=!0;var e=Object.assign({},t);a.$axios({url:"/admin/file/deleted",method:"delete",data:e}).then(function(e){a.$message({message:"删除完成",type:"success"}),a.getData(),a.tableData.loading=!1})}).catch(function(){})},handleMultiDelete:function(){var e=this;0!==this.multipleSelection.length?this.$confirm("确认删除这些文件吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.tableData.loading=!0;var t=e.multipleSelection;e.$axios({url:"/admin/file/deleteds",method:"delete",data:t}).then(function(t){e.$message({message:"删除成功",type:"success"}),e.getData(),e.tableData.loading=!1})}).catch(function(){}):this.$message.error("没有选择需要删除的文件，请重新选择！")}}},o=(a("ltQa"),Object(s.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"weibiaoti-"}}),e._v("  回收站")],1)]),e._v(" "),a("div",{staticClass:"ib"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.refresh},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-fanhui1",plain:""},on:{click:e.handleMultiRollback}},[e._v("  文档恢复")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-shanchu",plain:""},on:{click:e.handleMultiDelete}},[e._v("  彻底删除")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"文件名",width:"350px","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[20===t.row.docType?a("div",[a("img",{staticStyle:{width:"20px",height:"auto"},attrs:{src:e.viewImageUrl,alt:""}}),e._v(" "),a("b",[e._v(e._s(t.row.name))])]):a("div",["folder"===t.row.kind?a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:"#",target:"_self"},on:{click:function(a){e.nodeClick(t.row)}}},[a("b",[e._v(e._s(t.row.name))])])],1):a("div",[a("div",[a("app-svg",{attrs:{iconText:t.row.suffix}}),e._v(" "),a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:"#"},on:{click:function(a){e.handlePreview(t.$index,t.row)}}},[a("b",[e._v(e._s(t.row.name)+"."+e._s(t.row.suffix))])])],1)])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文件原始路径",align:"left","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.fullName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"删除日期",align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.dateFormat(t.row.deleteDate)))]),e._v(" "),a("p",[e._v(e._s(e.dateShortFormat(t.row.deleteDate)))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"删除者",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.deleteUserName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文件大小",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["folder"===t.row.kind?a("div"):a("div",[a("p",[e._v(e._s(t.row.size))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除文档恢复",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-fanhui1",circle:""},on:{click:function(a){e.handleRollback(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"彻底删除",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-shanchu",circle:""},on:{click:function(a){e.handleDelete(t.$index,t.row)}}})],1)]}}])})],1)],1)],1),e._v(" "),a("dept-and-time-condition",{ref:"editDeptAndTimeCondition",attrs:{"set-condition":e.setCondition,editLog:e.getData}})],1)},[],!1,null,"52e3118c",null));t.default=o.exports},I4mM:function(e,t,a){"use strict";var i=a("hSeo");a.n(i).a},IUcV:function(e,t,a){},Ik9H:function(e,t,a){"use strict";var i=a("TENZ");a.n(i).a},JGdg:function(e,t,a){"use strict";var i={name:"EditUser",props:{addUser:{type:Function,default:null},editUser:{type:Function,default:null}},data:function(){return{formUser:{addVisible:!1,editVisible:!1,passwordVisible:!1,loading:!1,rules:{username:[{required:!0,message:"请输入登录名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},data:{departments:[{id:0}],admin:{level:0},id:0,name:"",username:"",password:"",status:1,oldDeptId:0,oldDeptName:"",deptId:0,deptName:"",level:0}},treeDept:{data:[],loading:!1,props:{children:"children",label:"name"},defaultNodes:[1],currentKey:""}}},methods:{handleUserAdd:function(){this.formUser.addVisible=!0,this.formUser.data={departments:[{id:0}],admin:{level:0},id:0,name:"",username:"",password:"p@ssw0rd",status:1,oldDeptId:0,oldDeptName:"",deptId:0,deptName:"",level:0},this.$refs.formAddUser&&this.$refs.formAddUser.resetFields()},handleUserAddByDept:function(e){this.formUser.addVisible=!0,this.formUser.data={departments:[{id:0}],admin:{level:0},id:0,name:"",username:"",password:"p@ssw0rd",status:1,oldDeptId:0,deptId:0,deptName:"",level:0},this.$refs.formAddUser&&this.$refs.formAddUser.resetFields(),this.parentDeptSelect(e)},handleUserAddSubmit:function(){var e=this;0!==this.formUser.data.deptId?this.$refs.formAddUser.validate(function(t){t&&e.$confirm("确认新增吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formUser.loading=!0;var t=Object.assign({},e.formUser.data);t.departments=[{id:e.formUser.data.deptId}],t.admin={level:e.formUser.data.level},e.$axios({url:"/admin/user",method:"post",data:t}).then(function(t){0===t.c?(e.$message.success("添加用户成功"),e.$refs.formAddUser.resetFields(),e.formUser.addVisible=!1,e.addUser()):e.$message.error(t.msg),e.formUser.loading=!1})})}):this.$message.error("请选择用户所属组织架构")},handleUserBaseEdit:function(e,t){this.fillModifyData(t),this.formUser.editVisible=!0},handleUserBaseEditSubmit:function(){var e=this;this.$refs.formEditUser.validate(function(t){t&&e.$confirm("确认提交修正吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formUser.loading=!0;var t=Object.assign({},e.formUser.data);e.formUser.data.oldDeptId!==e.formUser.data.deptId&&(t.departments=[{id:e.formUser.data.deptId}]),e.$axios({url:"/admin/user/"+e.formUser.data.id+"/base",method:"put",data:t}).then(function(t){e.$message({message:"提交成功",type:"success"}),e.$refs.formEditUser.resetFields(),e.formUser.editVisible=!1,e.formUser.loading=!1,e.editUser()})})})},handleAdminSubmit:function(e,t){var a=this;this.$confirm("确认设置为管理员?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e=Object.assign({},t);a.$axios({url:"/admin/user/"+t.id+"/sysadmin",method:"put",data:e}).then(function(e){a.$message({message:"已设为系统管理员",type:"success"}),a.editUser()})}).catch(function(){})},handleUserLockSubmit:function(e,t){var a=this;this.$confirm("确认封禁该用户?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e=Object.assign({},t);a.$axios({url:"/admin/user/"+t.id+"/lock",method:"put",data:e}).then(function(e){a.$message({message:"用户状态已更新",type:"success"}),a.editUser()})}).catch(function(){})},handleUserLeaveSubmit:function(e,t){var a=this;this.$confirm("确认该用户离职?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e=Object.assign({},t);a.$axios({url:"/admin/user/"+t.id+"/leave",method:"put",data:e}).then(function(e){a.$message({message:"用户状态已更新",type:"success"}),a.editUser()})}).catch(function(){})},handleUserUnlockSubmit:function(e,t){var a=this;this.$confirm("确认恢复用户正常状态?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e=Object.assign({},t);a.$axios({url:"/admin/user/"+t.id+"/normal",method:"put",data:e}).then(function(e){a.$message({message:"用户状态已恢复",type:"success"}),a.editUser()})}).catch(function(){})},handleUserDeleteSubmit:function(e,t){var a=this;this.$confirm("确认删除该用户?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e=Object.assign({},t);a.$axios({url:"/admin/user",method:"delete",data:e}).then(function(e){a.$message({message:"用户状态已更新",type:"success"}),a.editUser()})}).catch(function(){})},fillModifyData:function(e){this.formUser.data={id:e.id,departments:e.departments,admin:e.admin,name:e.name,username:e.username,password:e.password,status:e.status,oldDeptId:e.departments[0].id,oldDeptName:e.departments[0].name,deptId:e.departments[0].id,deptName:e.departments[0].name,level:e.admin?e.admin.level:0}},handleUserPasswordEdit:function(e,t){this.fillModifyData(t),this.formUser.passwordVisible=!0},handleResetPassword:function(){this.formUser.data.password=this.randomString(6)},handleUserPasswordEditSubmit:function(){var e=this;this.$refs.formPassword.validate(function(t){t&&e.$confirm("确认提交修正吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formUser.loading=!0;var t=Object.assign({},e.formUser.data);e.$axios({url:"/admin/user/"+e.formUser.data.id+"/password",method:"put",data:t}).then(function(t){0===t.c?e.$message({message:"提交成功",type:"success"}):e.$message({message:t.msg,type:"error"}),e.formUser.loading=!1,e.$refs.formPassword.resetFields(),e.formUser.passwordVisible=!1,e.editUser()})})})},randomString:function(e){e=e||6;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=t.length,i="",s=0;s<e;s++)i+=t.charAt(Math.floor(Math.random()*a));return i},getDept:function(){var e=this;this.treeDept.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),a[0].isRoot=!0,e.treeDept.data=a,e.treeDept.loading=!1,e.$nextTick(function(){this.formUser.data.deptId>0&&this.findDefaultNodes(this.formUser.data.deptId,a)})}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},parentDeptSelect:function(e){this.formUser.data.deptId=e.id,this.formUser.data.deptName=e.name},findDefaultNodes:function(e,t){for(var a=0;a<t.length;a++){if(t[a].id===e)return this.treeDept.defaultNodes=t[a].parents,this.$refs.moveDeptTree.setCurrentKey(t[a].id),!0;if(t[a].children.length>0&&this.findDefaultNodes(e,t[a].children))return!0}}}},s=(a("WNey"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"新增用户",visible:e.formUser.addVisible,"close-on-click-modal":!1,width:"700px"},on:{"update:visible":function(t){e.$set(e.formUser,"addVisible",t)},open:e.getDept}},[a("el-form",{ref:"formAddUser",attrs:{model:e.formUser.data,"label-width":"80px",rules:e.formUser.rules}},[a("el-row",{staticStyle:{"min-height":"400px",height:"400px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"400px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeDept.loading,expression:"treeDept.loading"}],ref:"moveDeptTree",attrs:{data:e.treeDept.data,"highlight-current":"",props:e.treeDept.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.parentDeptSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-form-item",{attrs:{label:"所属组织",prop:"deptName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formUser.data.deptName,callback:function(t){e.$set(e.formUser.data,"deptName",t)},expression:"formUser.data.deptName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"登录账号",prop:"username"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formUser.data.username,callback:function(t){e.$set(e.formUser.data,"username",t)},expression:"formUser.data.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户姓名",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formUser.data.name,callback:function(t){e.$set(e.formUser.data,"name",t)},expression:"formUser.data.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-col",{attrs:{span:24}},[a("el-input",{model:{value:e.formUser.data.password,callback:function(t){e.$set(e.formUser.data,"password",t)},expression:"formUser.data.password"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-refresh"},on:{click:function(t){e.handleResetPassword()}},slot:"append"},[e._v("随机密码")])],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"管理权限"}},[a("el-radio-group",{model:{value:e.formUser.data.level,callback:function(t){e.$set(e.formUser.data,"level",t)},expression:"formUser.data.level"}},[a("el-radio",{staticClass:"radio",attrs:{label:0,border:""}},[e._v("普通用户")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:1,border:""}},[e._v("系统管理员")])],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new",loading:e.formUser.loading},nativeOn:{click:function(t){return e.handleUserAddSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){e.formUser.addVisible=!1}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"用户编辑",visible:e.formUser.editVisible,"close-on-click-modal":!1,width:"700px"},on:{"update:visible":function(t){e.$set(e.formUser,"editVisible",t)},open:e.getDept}},[a("el-form",{ref:"formEditUser",attrs:{model:e.formUser.data,"label-width":"100px",rules:e.formUser.rules}},[a("el-row",{staticStyle:{"min-height":"400px",height:"400px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"400px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeDept.loading,expression:"treeDept.loading"}],ref:"moveDeptTree",attrs:{data:e.treeDept.data,"highlight-current":"",props:e.treeDept.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":e.treeDept.defaultNodes},on:{"node-click":e.parentDeptSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-form-item",{attrs:{label:"所属组织",prop:"oldDeptName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formUser.data.oldDeptName,callback:function(t){e.$set(e.formUser.data,"oldDeptName",t)},expression:"formUser.data.oldDeptName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编辑新组织",prop:"deptName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formUser.data.deptName,callback:function(t){e.$set(e.formUser.data,"deptName",t)},expression:"formUser.data.deptName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"登录名",prop:"username"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formUser.data.username,callback:function(t){e.$set(e.formUser.data,"username",t)},expression:"formUser.data.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formUser.data.name,callback:function(t){e.$set(e.formUser.data,"name",t)},expression:"formUser.data.name"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.formUser.loading},nativeOn:{click:function(t){return e.handleUserBaseEditSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){e.formUser.editVisible=!1}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"密码重置",visible:e.formUser.passwordVisible,"close-on-click-modal":!1,width:"400px"},on:{"update:visible":function(t){e.$set(e.formUser,"passwordVisible",t)}}},[a("el-form",{ref:"formPassword",attrs:{model:e.formUser.data,"label-width":"80px",rules:e.formUser.rules}},[a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-col",{attrs:{span:24}},[a("el-input",{model:{value:e.formUser.data.password,callback:function(t){e.$set(e.formUser.data,"password",t)},expression:"formUser.data.password"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-refresh"},on:{click:e.handleResetPassword},slot:"append"},[e._v("随机密码")])],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.formUser.loading},nativeOn:{click:function(t){return e.handleUserPasswordEditSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){e.formUser.passwordVisible=!1}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,"6d7ff708",null);t.a=n.exports},JJ5H:function(e,t,a){"use strict";var i=a("JWIu");a.n(i).a},JVPl:function(e,t,a){},JWIu:function(e,t,a){},JuzV:function(e,t,a){"use strict";var i=a("Bcbd");a.n(i).a},K0e7:function(e,t,a){"use strict";var i=a("TK+S");a.n(i).a},LC0H:function(e,t,a){"use strict";var i=a("MrUf");a.n(i).a},LzCx:function(e,t,a){"use strict";a.r(t);var i=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"logo"},[t("img",{attrs:{src:a("nWR2"),alt:""}})])}],s=a("p46w"),n=a.n(s),o={data:function(){return{formData:{password:""},linkRules:{password:[{required:!0,message:"提取码必须输入",trigger:"blur"}]},sysMsg:"",linkRandom:""}},mounted:function(){this.linkRandom=this.$route.query.id,this.linkRandom||this.$router.push("home")},methods:{submitForm:function(){var e=this;this.$refs.linkForm.validate(function(t){if(!t)return!1;e.$router.push({path:"linkpreview",query:{shared:e.linkRandom}}),n.a.set(e.linkRandom,e.formData.password,{expires:1})})},setErrMsg:function(){}}},l=a("KHd+"),r=Object(l.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sys-login"},[a("div",{staticClass:"login-area"},[e._m(0),e._v(" "),a("div",{staticClass:"form-group"},[a("el-form",{ref:"linkForm",attrs:{model:e.formData,rules:e.linkRules,"label-position":"left","label-width":"0px"}},[a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入提取码"},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}})],1),e._v(" "),a("a",{staticClass:"btn-login",attrs:{type:"primary"},on:{click:function(t){e.submitForm()}}},[e._v("提取文件")])],1),e._v(" "),e.sysMsg?a("div",{staticClass:"err-msg"},[e._v(e._s(e.sysMsg))]):e._e()],1),e._v(" "),a("div",{staticClass:"tip"})])])},i,!1,null,null,null);t.default=r.exports},MKPK:function(e,t,a){"use strict";var i=a("9GKM");a.n(i).a},MYOy:function(e,t,a){"use strict";var i={name:"FolderAdmin",data:function(){return{formFolderAdmin:{data:{folderId:0,folderName:"",userId:0,userName:"",deptId:0},visible:!1,loading:!1},deptTree:{data:[],props:{children:"children",label:"name"},loading:!1,selected:null},memberTable:{height:0,body:[],pageSize:1e3,total:0,curPage:1,loading:!1,selected:null},paginationData:{pageSize:1e3,total:0,curPage:1},adminName:""}},methods:{handleFolderAdmin:function(e){this.formFolderAdmin.data={folderId:e.data.id,folderName:e.data.name,deptId:0,userId:0,userName:""},this.$refs.formFolderAdminData&&this.$refs.formFolderAdminData.resetFields(),this.formFolderAdmin.visible=!0},openDialog:function(){this.getDept(),this.getFolderAdmin(this.formFolderAdmin.data.folderId)},getDept:function(){var e=this;this.deptTree.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),e.deptTree.data=a,e.deptTree.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},getFolderAdmin:function(e){var t=this;this.$axios({url:"/admin/folder/"+e+"/admin",method:"get"}).then(function(e){var a=[];e.ctt.forEach(function(e){a.push(e.name)}),t.adminName=a.join("，")}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},deptSelect:function(e){this.deptTree.selected=e,this.getUser(e)},getUser:function(e){var t=this;this.memberTable.loading=!0,this.$axios({url:"/admin/dept/"+e.id+"/users/"+this.paginationData.curPage+"-"+this.paginationData.pageSize,method:"get"}).then(function(e){t.memberTable.body=e.ctt.list,t.paginationData.total=e.ctt.total,t.memberTable.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},memberSelect:function(e){this.memberTable.selected=e,this.formFolderAdmin.data.userId=e.id,this.formFolderAdmin.data.userName=e.name,this.formFolderAdmin.data.deptId=this.deptTree.selected.id},handleFolderAdminSubmit:function(){var e=this;this.memberTable.selected?this.$confirm("确认添加文件夹管理员吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formFolderAdmin.loading=!0;var t=Object.assign({},e.formFolderAdmin.data);e.$axios({url:"/admin/folder/"+e.formFolderAdmin.data.folderId+"/admin",method:"put",data:t}).then(function(t){0===t.c?e.$message.success("添加成功"):e.$message.error(t.msg),e.formFolderAdmin.loading=!1,e.formFolderAdmin.visible=!1})}).catch(function(){}):this.$message.error("请选择文件夹管理员！")},handleFolderAdminClose:function(){this.formFolderAdmin.loading=!1,this.formFolderAdmin.visible=!1,this.memberTable.body=[],this.memberTable.selected=null}}},s=(a("oIJY"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"选择文件夹管理员",visible:e.formFolderAdmin.visible,"close-on-click-modal":!1,width:"700px"},on:{"update:visible":function(t){e.$set(e.formFolderAdmin,"visible",t)},open:e.openDialog}},[a("el-form",{ref:"formFolderAdminData",attrs:{model:e.formFolderAdmin.data,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"目录名：",prop:"name"}},[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("span",{staticStyle:{"font-style":"normal","font-weight":"normal"}},[e._v(e._s(e.formFolderAdmin.data.folderName))])],1)],1),e._v(" "),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"管理员列表：",prop:"name","label-width":"100px"}},[a("span",{staticStyle:{"font-style":"normal","font-weight":"normal"}},[e._v(e._s(e.adminName))])])],1)],1),e._v(" "),a("el-row",{staticStyle:{"min-height":"400px",height:"400px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc"}},[a("el-scrollbar",{staticStyle:{height:"450px"}},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTree.loading,expression:"deptTree.loading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptTree.data,"highlight-current":"",props:e.deptTree.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.deptSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTable.loading,expression:"memberTable.loading"}],ref:"memberTable",staticClass:"custom-table-cell",attrs:{data:e.memberTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",height:"400px"},on:{"current-change":e.memberSelect}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.formFolderAdmin.loading},nativeOn:{click:function(t){return e.handleFolderAdminSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.handleFolderAdminClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,"1fa7d2e8",null);t.a=n.exports},Mk72:function(e,t,a){},MrUf:function(e,t,a){},NHLI:function(e,t,a){"use strict";a.r(t);var i=a("L2JU"),s={name:"link",data:function(){return{viewImageUrl:this.$upload+"/setting/getLogoImg?seed=",copyBtn:null,onlyShowValid:!0,searchTxt:"",linkTable:{loading:!0,body:[],height:0,pageSize:1e3,total:0,curPage:1,multipleSelection:[]},tagBar:{loading:!0,body:[],inputVisible:!1,inputValue:""}}},mounted:function(){this.getData(),this.getTag(),this.tableHeight()},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e})({},Object(i.b)({curFolderAction:"folderHistory/curFolder",nextFolderAction:"folderHistory/nextFolder"}),{tableHeight:function(){this.$nextTick(function(){this.linkTable.height=window.innerHeight-this.$refs.table.$el.offsetTop-254;var e=this;window.onresize=function(){e.linkTable.height=window.innerHeight-e.$refs.table.$el.offsetTop-254}})},getData:function(){var e=this;this.linkTable.loading=!0,this.$axios({url:"/user/links/"+this.linkTable.curPage+"-"+this.linkTable.pageSize,method:"get"}).then(function(t){if(e.onlyShowValid){var a=[];if(t.ctt.list.length>0)for(var i=0;i<t.ctt.list.length;i++)"NORMAL"===t.ctt.list[i].status&&a.push(t.ctt.list[i]);else a=t.ctt.list;e.linkTable.body=a,e.linkTable.total=t.ctt.total,e.linkTable.loading=!1}else e.linkTable.body=t.ctt.list,e.linkTable.total=t.ctt.total,e.linkTable.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)}),this.linkTable.loading=!1},sizeChange:function(e){this.linkTable.pageSize=e,this.getData()},pageChange:function(e){this.linkTable.curPage=e,this.getData()},handleSelectionChange:function(e){this.linkTable.multipleSelection=e},onlyValid:function(e){this.onlyShowValid=e,this.getData()},getTag:function(){var e=this;this.tagBar.loading=!0,this.$axios({url:"/user/tags",method:"get"}).then(function(t){e.tagBar.body=t.ctt,e.tagBar.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},dateShortFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("MM月DD日 HH:mm")},dateFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("YYYY年MM月DD日")},refresh:function(){this.getData()},handleCopyClipboard:function(e,t){var a="外链地址:"+t.fullUrl+" 密码:"+t.password;this.copyBtn=new this.$clipboard(".btnCopy",{text:function(){return a}});var i=this,s=i.copyBtn;s.on("success",function(){i.$message({message:"已复制外链信息到剪贴板",type:"success"})}),s.on("error",function(){i.$message({message:"复制失败，请手动选择复制",type:"error"})})},handleMultiDeleteSubmit:function(){var e=this;0!==this.linkTable.multipleSelection.length?this.$confirm("确认删除这些外链吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.linkTable.loading=!0;var t=e.linkTable.multipleSelection;e.$axios({url:"user/links",method:"delete",data:t}).then(function(t){e.$message({message:"删除成功",type:"success"}),e.getData(),e.linkTable.loading=!1})}).catch(function(){}):this.$message.error("没有选择需要断开的外链，请重新选择！")},handleDeleteSubmit:function(e,t){var a=this;this.$confirm("确认删除此外链吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){a.linkTable.loading=!0;var e=Object.assign({},t);a.$axios({url:"user/link",method:"delete",data:e}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getData(),a.linkTable.loading=!1})}).catch(function(){})},tagSearch:function(e){var t=this;this.linkTable.loading=!0,this.$axios({url:"/user/linksbysearchkey/"+this.linkTable.curPage+"-"+this.linkTable.pageSize+"?key="+e,method:"get"}).then(function(e){t.linkTable.body=e.ctt.list,t.linkTable.total=e.ctt.total,t.linkTable.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)}),this.linkTable.loading=!1},search:function(){var e=this;this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.linkTable.loading=!0,this.$axios({url:"/user/linksbysearchkey/"+this.linkTable.curPage+"-"+this.linkTable.pageSize+"?key="+this.searchTxt,method:"get"}).then(function(t){e.linkTable.body=t.ctt.list,e.linkTable.total=t.ctt.total,e.linkTable.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)}),this.linkTable.loading=!1):this.$message.success("请输入搜索关键词")},showInput:function(){var e=this;this.tagBar.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var e=this,t={id:0,name:this.tagBar.inputValue,type:2};t.name&&(this.tagBar.loading=!0,this.$axios({url:"/user/tag",method:"post",data:t}).then(function(a){0===a.c?(e.$message.success("已添加新标签"),t.id=a.ctt.id,e.tagBar.body.push(t),e.tagBar.loading=!1):e.$message.error(a.msg)}).catch(function(e){})),this.tagBar.inputVisible=!1,this.tagBar.inputValue=""},handleClose:function(e){var t=this;this.$confirm("删除这个标签?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){t.tagBar.loading=!0;var a=e;t.$axios({url:"user/tag",method:"delete",data:a}).then(function(a){t.tagBar.body.splice(t.tagBar.body.indexOf(e),1),t.tagBar.loading=!1})}).catch(function(){})}})},n=(a("XdT2"),a("KHd+")),o=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr"},[a("el-button-group",[a("el-button",{attrs:{size:"small",icon:"el-icon-arrow-left"},on:{click:e.curFolderAction}}),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.nextFolderAction}},[a("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),e._v(" "),a("el-breadcrumb",{staticClass:"pl10",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("我分享的文件")])],1)],1),e._v(" "),a("div",{staticClass:"ib"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{size:"mini",icon:"iconfont icon-shuaxin"},on:{click:e.refresh}},[e._v(" 刷新")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon--duankailianjie",plain:""},on:{click:e.handleMultiDeleteSubmit}},[e._v(" 断开连接")])],1),e._v(" "),a("div",{staticClass:"fxr pd5"},[a("el-checkbox",{on:{change:e.onlyValid},model:{value:e.onlyShowValid,callback:function(t){e.onlyShowValid=t},expression:"onlyShowValid"}},[e._v("只表示有效外链")])],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("span",{staticStyle:{"font-weight":"bold","letter-spacing":"3px","padding-left":"10px"}},[e._v("最新标签：")]),e._v(" "),e._l(e.tagBar.body,function(t,i){return a("el-tag",{key:t.id,attrs:{closable:"",type:"warning","disable-transitions":!1},on:{close:function(a){e.handleClose(t)}},nativeOn:{click:function(a){e.tagSearch(t.name)}}},[a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:" javascript:void(0)"}},[e._v(e._s(t.name))])])}),e._v(" "),e.tagBar.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{span:1,size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleInputConfirm(t):null}},model:{value:e.tagBar.inputValue,callback:function(t){e.$set(e.tagBar,"inputValue",t)},expression:"tagBar.inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{span:3,size:"small"},on:{click:e.showInput}},[e._v("+ 点击添加新标签\n                ")])],2)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.linkTable.loading,expression:"linkTable.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.linkTable.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.linkTable.height},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.resources,function(t){return[a("el-row",{staticStyle:{"padding-left":"25px"}},[a("el-col",{attrs:{span:1,align:"right"}},["folder"===t.kind?a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}})],1):a("div",{staticStyle:{"margin-top":"4px"}},[t.suffix?e._e():a("img",{staticStyle:{width:"18px",height:"auto"},attrs:{src:e.viewImageUrl,alt:""}}),e._v(" "),t.suffix?a("app-svg",{attrs:{iconText:t.suffix}}):e._e()],1)]),e._v(" "),a("el-col",{attrs:{span:7}},[a("P",{staticStyle:{"line-height":"30px","font-size":"15px","padding-left":"3px"}},[t.suffix?a("b",[e._v(e._s(t.name)+"."+e._s(t.suffix))]):e._e(),e._v(" "),t.suffix?e._e():a("b",[e._v(e._s(t.name))])])],1)],1)]})]}}])}),e._v(" "),a("el-table-column",{attrs:{type:"selection","min-width":"10%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"外链"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("app-svg",{attrs:{iconClass:"gongxiangwenjianjia"}}),e._v(" "),a("router-link",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{to:{path:"linkpreview",query:{link:t.row.randomFolderName}},target:"_blank"}},[e._v(e._s(t.row.name)+"\n                        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"有效期",align:"center","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.days?a("div",[a("p",[e._v("无期限")])]):a("div",[a("p",[e._v(e._s(t.row.days)+"天")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"结束时间",align:"center","min-width":"20%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.days?a("div"):a("div",[a("p",[e._v(e._s(e.dateFormat(t.row.endDate))+"截至")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"外链状态",align:"center","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return["EXPIRE"===t.row.status?a("div",[a("p",[e._v("已失效")])]):"DELETE"===t.row.status?a("div",[a("p",[e._v("已删除")])]):a("div",[a("p",[e._v("有效")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return["EXPIRE"===t.row.status?a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制链接信息到剪贴板",placement:"bottom"}},[a("el-button",{staticClass:"btnCopy",attrs:{type:"text",size:"mini",icon:"iconfont icon-wenjian",circle:""},on:{click:function(a){e.handleCopyClipboard(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-shanchu",circle:""},on:{click:function(a){e.handleDeleteSubmit(t.$index,t.row)}}})],1)],1):a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制链接信息到剪贴板",placement:"bottom"}},[a("el-button",{staticClass:"btnCopy",attrs:{type:"text",size:"mini",icon:"iconfont icon-wenjian",circle:""},on:{click:function(a){e.handleCopyClipboard(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"断开外链",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon--duankailianjie",circle:""},on:{click:function(a){e.handleDeleteSubmit(t.$index,t.row)}}})],1)],1)]}}])})],1)],1)],1)],1)},[],!1,null,null,null);t.default=o.exports},OFvO:function(e,t,a){"use strict";a.r(t);var i={components:{EditFolder:a("Bl3E").a},name:"AddFolderWhite",props:{addJob:{type:Function,default:null}},data:function(){return{defaultKey:[1],folderTree:{visible:!1,loading:!1,props:{label:"name",children:"children"},body:[],selected:null},fromIpInput:{folderId:0,folderName:"",ipInfo:"",visible:!1,loading:!1,rules:{ipInfo:[{required:!0,message:"请输入ip白名单",trigger:"blur"}]}}}},methods:{handleAddWhiteList:function(){this.fromIpInput.visible=!0},printFolderTree:function(e,t){var a=this,i=void 0;i=0===e.level?0:e.data.id,this.folderTree.loading=!0,this.$axios({url:"/admin/folder/"+i+"/children",method:"get"}).then(function(e){t(e.ctt),a.folderTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},folderSelect:function(e){this.folderTree.selected=e,this.getWhiteList(e)},addFolder:function(e){this.$refs.folderTree.append(e.ctt,e.ctt.parentId)},editFolder:function(e){var t=this.$refs.folderTree.getNode(e);this.$refs.folderTree.remove(e),this.$refs.folderTree.append(e,e.parentId),t.data.name=e.name},deleteFolder:function(e){this.$refs.folderTree.remove(e)},getWhiteList:function(e){var t=this;this.$refs.fromIpInput&&this.$refs.fromIpInput.resetFields(),this.$axios({url:"/admin/folder/"+e.id+"/ip",method:"get"}).then(function(a){a.ctt?t.fromIpInput.ipInfo=a.ctt.ipInfo:t.fromIpInput.ipInfo="",t.fromIpInput.folderId=e.id,t.fromIpInput.folderName=e.name}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},handleWhiteListSubmit:function(){var e=this;this.folderTree.selected?this.$refs.ipInputForm.validate(function(t){t&&e.$confirm("确认添加这些IP白名单吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){var t=Object.assign({},e.fromIpInput);e.$axios({url:"/admin/folder/"+e.fromIpInput.folderId+"/ip",method:"put",data:t}).then(function(t){0===t.c?(e.$message.success("编辑配置成功"),e.clear(),e.fromIpInput.visible=!1,e.addJob()):e.$message.error(t.msg)})}).catch(function(){})}):this.$message.warning("没有选择文件夹！")},clear:function(){this.folderTree.body=[],this.folderTree.selected=null,this.fromIpInput.folderId=0,this.fromIpInput.folderName="",this.fromIpInput.ipInfo=""},close:function(){this.clear(),this.fromIpInput.visible=!1}}},s=(a("qunu"),a("KHd+")),n={name:"log",components:{AddFolderWhite:Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"设置文件夹访问IP白名单",visible:e.fromIpInput.visible,"close-on-click-modal":!1,width:"1000px"},on:{"update:visible":function(t){e.$set(e.fromIpInput,"visible",t)}}},[a("el-form",{ref:"ipInputForm",attrs:{model:e.fromIpInput,"label-width":"80px",rules:e.fromIpInput.rules}},[a("el-row",{staticStyle:{"min-height":"500px",height:"500px"},attrs:{gutter:30}},[a("el-col",{attrs:{span:13}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc"}},[a("el-scrollbar",{staticStyle:{height:"450px"}},[e.fromIpInput.visible?a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.folderTree.loading,expression:"folderTree.loading"}],ref:"folderTree",staticClass:"mr20",attrs:{accordion:!0,"highlight-current":!0,data:e.folderTree.body,props:e.folderTree.props,"default-expand-all":!1,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":e.defaultKey,lazy:"",load:e.printFolderTree},on:{"node-click":e.folderSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("b",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-wenjianjia"}})]),e._v(" "),a("b",[e._v(e._s(i.label))])]),e._v(" "),1===s.id?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增下级文件夹",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-add",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderAdd(i)}}})],1)],1):a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增下级文件夹",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-add",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderAdd(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑文件夹",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-node",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderEdit(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除文件夹",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderDelete(i)}}})],1)],1)])}}])}):e._e()],1)],1)]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{staticStyle:{"font-style":"oblique","font-weight":"bold"},attrs:{label:"目录名："}},[a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("span",{staticStyle:{"font-style":"normal","font-weight":"normal"}},[e._v(e._s(e.fromIpInput.folderName))])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"IP白名单",prop:"ipInfo"}},[a("el-input",{attrs:{type:"textarea",rows:10,placeholder:"请输入白名单规则，规则之间用';'号隔开"},model:{value:e.fromIpInput.ipInfo,callback:function(t){e.$set(e.fromIpInput,"ipInfo",t)},expression:"fromIpInput.ipInfo"}})],1),e._v(" "),a("div",{staticStyle:{margin:"15px 0 0 15px",padding:"5px",display:"flex",height:"100px","border-radius":"5px",border:"1px solid #dcdfe6"}},[a("span",{staticStyle:{color:"#606266","font-weight":"bold"}},[e._v("说明："),a("br"),e._v("\n                                1、输入需要开通的IP白名单列表，IP与IP直接用';'号间隔。"),a("br"),e._v("\n                                      \n                                如：10.0.4.5;10.0.4.6"),a("br"),e._v("\n                                2、支持IP段的设置，设置方式为起始IP与结束IP间用'-'号连接。"),a("br"),e._v("\n                                      \n                                如：10.0.4.5-10.0.4.15"),a("br")])])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.fromIpInput.loading},nativeOn:{click:function(t){return e.handleWhiteListSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.close(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1),e._v(" "),a("edit-folder",{ref:"editFolder",attrs:{"add-folder":e.addFolder,"edit-folder":e.editFolder,"delete-folder":e.deleteFolder}})],1)},[],!1,null,"09d82ecb",null).exports,EditFolderWhite:a("iaoZ").a},data:function(){return{folderIpData:{height:0,loading:!0,body:[],pageSize:1e3,total:0,curPage:0}}},mounted:function(){this.getData(),this.tableHeight()},methods:{tableHeight:function(){this.$nextTick(function(){this.folderIpData.height=window.innerHeight-this.$refs.table.$el.offsetTop-200;var e=this;window.onresize=function(){e.folderIpData.height=window.innerHeight-e.$refs.table.$el.offsetTop-200}})},refresh:function(){this.getData()},getData:function(){var e=this;this.folderIpData.loading=!0,this.$axios({url:"admin/folder/ips",method:"get"}).then(function(t){e.folderIpData.body=t.ctt,e.folderIpData.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},deleteFolderIpData:function(e){var t=this;this.$confirm("确认删除该白名单信息吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var a=Object.assign({},e);t.$axios({url:"/admin/folder/"+a.id+"/ip",method:"delete"}).then(function(e){0===e.c?t.$message({message:"白名单信息已删除",type:"success"}):t.$message.error(e.msg),t.refresh()})}).catch(function(){})}}},o=(a("QrzF"),Object(s.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"jueceliubaimingdan"}}),e._v("  文件夹访问IP白名单")],1)])]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-add",plain:""},nativeOn:{click:function(t){return e.$refs.add.handleAddWhiteList(t)}}},[e._v("  新增配置")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.folderIpData.loading,expression:"folderIpData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.folderIpData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.folderIpData.height}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"64px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"文件夹名称",prop:"name",width:"350px"}}),e._v(" "),a("el-table-column",{attrs:{label:"文件夹路径",prop:"parentPathName"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑白名单",placement:"bottom"}},[a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-file",circle:""},nativeOn:{click:function(a){e.$refs.edit.handleEditWhiteList(t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除白名单配置",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},nativeOn:{click:function(a){e.deleteFolderIpData(t.row)}}})],1)],1)]}}])})],1)],1)],1),e._v(" "),a("add-folder-white",{ref:"add",attrs:{"add-job":e.getData}}),e._v(" "),a("edit-folder-white",{ref:"edit",attrs:{"edit-job":e.getData}})],1)},[],!1,null,"50010d88",null));t.default=o.exports},OnF7:function(e,t,a){"use strict";var i=a("zqcb");a.n(i).a},Oq1C:function(e,t,a){},PGVT:function(e,t,a){"use strict";var i=a("XBtZ");a.n(i).a},PNS6:function(e,t,a){"use strict";a.r(t);var i=a("jhdv"),s=a("L2JU"),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};function o(e,t){var a={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);return a}var l={name:"EditDatabase",data:function(){return{visible:!1,dialogType:"create",form:{dbName:"",aliasName:"",driverName:"",ip:"",port:"",username:"",password:"",status:!0},rules:{dbName:[{required:!0,message:"请输入数据库名称",trigger:"blur"}],driverName:[{required:!0,message:"请选择数据驱动",trigger:"change"}],ip:[{required:!0,message:"请输入IP",trigger:"blur"},{required:!0,pattern:/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|localhost$/,message:"请输入有效的IP",trigger:"blur"}],port:[{required:!0,message:"请输入端口号",trigger:"blur"},{type:"number",message:"端口号必须为数字值",trigger:"blur"},{validator:function(e,t,a){t>0&&t<=65535?a():a(new Error("请输入正确的端口号范围(1-65535)"))},trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},dbDrivers:[]}},computed:n({dialogTitle:function(){return"edit"===this.dialogType?"修改数据库":"新增数据库"}},Object(s.d)({username:function(e){return e.user.name}})),mounted:function(){this.initDbDrivers()},methods:{onClose:function(){this.initForm(),this.$refs.form.resetFields()},initDbDrivers:function(){var e=this;this.$axios({method:"get",url:"/external/dbDriver"}).then(function(t){0===t.c&&(e.dbDrivers=t.ctt)})},initForm:function(){this.form={id:"",aliasName:"",dbName:"",driverName:"",ip:"",port:"",username:"",password:"",status:!0}},dialogOnTest:function(){var e=this,t=this.form,a=(t.id,o(t,["id"])),i=n({},a,{status:this.form.status?1:0,port:String(this.form.port)});this.$axios({method:"post",url:"/external/db/test",data:i}).then(function(t){0===t.c?e.$message.success("测试连接成功"):e.$message.warning(t.msg)}).catch(function(t){e.$message.error("测试连接数据失败，失败码："+t.response.status)})},dialogOnClose:function(){this.visible=!1,this.initForm(),this.$refs.form.resetFields()},dialogOnSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(t){if("create"===e.dialogType){var a=e.form,s=(a.id,a.status),l=a.port,r=o(a,["id","status","port"]),c=n({},r,{status:s?1:0,port:String(l)});e.$axios({method:"post",url:"/external/db",data:c}).then(function(t){e.$message.success("新建成功"),e.dialogOnClose(),i.a.$emit("refreshDb")}).catch(function(t){e.$message.error("新建数据失败，失败码："+t.response.status)})}if("edit"===e.dialogType){var d=n({},e.form,{status:e.form.status?1:0,port:String(e.form.port)});e.$axios({method:"put",url:"/external/dbUpdate",data:d}).then(function(t){e.$message.success("修改成功"),e.dialogOnClose(),i.a.$emit("refreshDb")}).catch(function(t){e.$message.error("修改数据失败，失败码："+t.response.status)})}}})}}},r=(a("CbGM"),a("KHd+")),c=Object(r.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit-database"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,"close-on-click-modal":!1,width:"460px"},on:{"update:visible":function(t){e.visible=t},close:e.onClose}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"110px","label-position":"left"}},[a("el-form-item",{attrs:{label:"数据源链接别名",prop:"aliasName"}},[a("el-input",{model:{value:e.form.aliasName,callback:function(t){e.$set(e.form,"aliasName",t)},expression:"form.aliasName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数据库名称",prop:"dbName"}},[a("el-input",{model:{value:e.form.dbName,callback:function(t){e.$set(e.form,"dbName",t)},expression:"form.dbName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数据驱动",prop:"driverName"}},[a("el-select",{attrs:{placeholder:"请选择数据驱动"},model:{value:e.form.driverName,callback:function(t){e.$set(e.form,"driverName",t)},expression:"form.driverName"}},e._l(e.dbDrivers,function(e,t){return a("el-option",{key:t,attrs:{label:e.comment,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"IP",prop:"ip"}},[a("el-input",{model:{value:e.form.ip,callback:function(t){e.$set(e.form,"ip",t)},expression:"form.ip"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"端口号",prop:"port"}},[a("el-input",{model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",e._n(t))},expression:"form.port"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},["Root"!=e.username?a("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}):e._e(),e._v(" "),"Root"==e.username?a("el-input",{model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"启用",prop:"status"}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new"},on:{click:e.dialogOnTest}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("测试连接")])])]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new"},on:{click:e.dialogOnSubmit}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.dialogOnClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,null,null).exports,d={name:"SyncDatabase",data:function(){return{visible:!1,form:{id:"",name:"",dateTime:"",status:""},dbDrives:[]}},computed:{dialogTitle:function(){return""}},methods:{dialogOnClose:function(){this.visible=!1,this.$refs.form.resetFields()},dialogOnSubmit:function(){var e=this;this.$axios({method:"get",url:"/external/db/"+this.form.id+"/input"}).then(function(t){0===t.c?(e.$message.success("同步成功"),i.a.$emit("refreshDb")):e.$message.warning(t.msg),e.dialogOnClose()}).catch(function(t){e.$message.error("同步数据失败，失败码："+t.response.status)})}}},u=(a("SGBM"),Object(r.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sync-database"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,"close-on-click-modal":!1,width:"460px"},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"源据数名称",prop:"name"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上次同步时间",prop:"dateTime"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.dateTime,callback:function(t){e.$set(e.form,"dateTime",t)},expression:"form.dateTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上次同步状态",prop:"status"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new"},on:{click:e.dialogOnSubmit}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("开始同步")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.dialogOnClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("取消")])])])],1)],1)],1)},[],!1,null,null,null).exports),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};var m={name:"database",components:{EditDatabase:c,SyncDatabase:u},data:function(){return{searchTxt:"",searchData:"",tableData:{height:0,loading:!0,body:[],pageSize:20,total:0,curPage:0},isShowAll:!0}},mounted:function(){var e=this;i.a.$on("refreshDb",function(t){e.refresh()})},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.table.$el.offsetTop;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.table.$el.offsetTop}})},clearSearchTxt:function(){this.searchData="",this.refresh()},search:function(){this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchData=this.searchTxt,this.refresh()):this.$message.success("请输入搜索关键词")},refresh:function(){this.tableData.total=0,this.tableData.body=[],this.tableData.curPage=0,this.$refs.infinite.stateChanger.reset()},nextPage:function(e){this.tableData.curPage+=1,this.getData(e)},getData:function(e){var t=this;this.tableData.loading=this.$refs.infinite.isFirstLoad;var a=void 0;a=this.searchData?"/external/dbs/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name="+this.searchData:"/external/dbs/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name=",this.$axios({url:a,method:"get"}).then(function(a){var i=[];i.push(a.ctt),i[0].length>0&&1===i[0][0].id&&(i[0][0].isRoot=!0),t.tableData.body=t.tableData.body.concat(a.ctt),t.tableData.total=a.ctt.total,t.tableData.loading=!1,0==a.ctt.length?e&&e.complete():e&&e.loaded(),t.$nextTick(function(){t.tableHeight()})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},handleEditItem:function(e,t){this.$refs.editDatabase.dialogType="edit",this.$refs.editDatabase.visible=!0;t.comment,t.mapperPackage,t.mapperPath,t.syncTime,t.tables;var a=function(e,t){var a={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);return a}(t,["comment","mapperPackage","mapperPath","syncTime","tables"]);this.$refs.editDatabase.form=f({},a,{port:parseInt(a.port),status:1===a.status})},handleSetValidItem:function(e,t){var a=this;this.$confirm("此操作将该数据置为"+(1===t.status?"无效":"有效")+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$axios({method:"put",url:"/external/dbInvalid",data:{id:t.id,status:1===t.status?9:1}}).then(function(e){a.refresh(),a.$message.success("设置成功")}).catch(function(e){a.$message.error("设置数据失败，失败码："+e.response.status)})}).catch(function(){})},handleDelItem:function(e,t){var a=this;this.$confirm("此操作将删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$axios({method:"delete",url:"/external/db",data:{id:t.id}}).then(function(e){a.refresh(),a.$message.success("删除成功")}).catch(function(e){a.$message.error("删除数据失败，失败码："+e.response.status)})}).catch(function(){})},handleAddDataBase:function(){this.$refs.editDatabase.dialogType="create",this.$refs.editDatabase.visible=!0},handleSyncItem:function(e,t){this.$refs.syncDatabase.visible=!0;var a=new Date(t.syncTime);this.$refs.syncDatabase.form={id:t.id,name:t.dbName,dateTime:a.getFullYear()+"年"+(a.getMonth()+1)+"月"+a.getDate()+"日",status:t.syncTime?"成功":"失败"}}}},p=(a("OnF7"),Object(r.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"database-container"},[a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"shezhi1"}}),e._v("  数据源管理")],1)]),e._v(" "),a("div",{staticClass:"ib pd10"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入关键字",clearable:""},on:{clear:e.clearSearchTxt},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline",plain:""},on:{click:e.handleAddDataBase}},[e._v("新增数据源")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height}},[a("el-table-column",{attrs:{prop:"id",label:"数据源别名",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.aliasName))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"数据源名称",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.dbName))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"dataDrive",label:"数据驱动",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.driverName))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"metaDataUrl",label:"数据源URL",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.ip))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"isSync",label:"是否已经同步",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.syncTime?"是":"否"))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"isEnable",label:"是否启用",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(1===t.row.status?"是":"否"))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"50%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"结构同步",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-caozuo-shangchuan-upload",circle:""},on:{click:function(a){e.handleSyncItem(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"bottom"}},[a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-file",circle:""},on:{click:function(a){e.handleEditItem(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},on:{click:function(a){e.handleDelItem(t.$index,t.row)}}})],1),e._v(" "),1===t.row.status?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"无效化",placement:"bottom"}},[a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-dongjie",circle:""},on:{click:function(a){e.handleSetValidItem(t.$index,t.row)}}})],1):e._e(),e._v(" "),9===t.row.status?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"有效化",placement:"bottom"}},[a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-jiechu",circle:""},on:{click:function(a){e.handleSetValidItem(t.$index,t.row)}}})],1):e._e()],1)]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1),e._v(" "),a("edit-database",{ref:"editDatabase"}),e._v(" "),a("sync-database",{ref:"syncDatabase"})],1)],1)},[],!1,null,null,null));t.default=p.exports},PZqn:function(e,t,a){"use strict";var i=a("feW8");a.n(i).a},Pbmn:function(e,t,a){"use strict";var i=a("oFcs");a.n(i).a},PlAU:function(e,t,a){"use strict";var i=a("gtv3");a.n(i).a},QNTy:function(e,t,a){"use strict";var i=a("h8Z9");a.n(i).a},QrzF:function(e,t,a){"use strict";var i=a("pqbm");a.n(i).a},RK5e:function(e,t,a){},RYJf:function(e,t,a){},SGBM:function(e,t,a){"use strict";var i=a("4bC7");a.n(i).a},TDVK:function(e,t,a){},TENZ:function(e,t,a){},"TK+S":function(e,t,a){},"Tk/2":function(e,t,a){"use strict";var i=a("rvRY");a.n(i).a},WMEx:function(e,t,a){"use strict";a.r(t);var i=a("L2JU"),s={name:"trash",data:function(){return{viewImageUrl:this.$upload+"/setting/getLogoImg?seed=",trashTable:{loading:!0,body:[],height:0,pageSize:20,total:0,curPage:0,multipleSelection:[]},searchData:"",searchTxt:""}},mounted:function(){this.tableHeight()},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e})({},Object(i.b)({curFolderAction:"folderHistory/curFolder",nextFolderAction:"folderHistory/nextFolder"}),{tableHeight:function(){this.$nextTick(function(){this.trashTable.height=window.innerHeight-this.$refs.table.$el.offsetTop-60;var e=this;window.onresize=function(){e.trashTable.height=window.innerHeight-e.$refs.table.$el.offsetTop-60}})},getData:function(e){var t=this;this.trashTable.loading=this.$refs.infinite.isFirstLoad;var a=void 0;a=this.searchData?"/user/search/trash/"+this.trashTable.curPage+"-"+this.trashTable.pageSize+"?value="+this.searchData:"/user/trash/"+this.trashTable.curPage+"-"+this.trashTable.pageSize,this.$axios({url:a,method:"get"}).then(function(a){t.trashTable.body=t.trashTable.body.concat(a.ctt.list),t.trashTable.total=a.ctt.total,t.trashTable.loading=!1,0==a.ctt.list.length?e&&e.complete():e&&e.loaded(),t.$nextTick(function(){t.tableHeight()})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)}),this.trashTable.loading=!1},refresh:function(){this.trashTable.total=0,this.trashTable.body=[],this.trashTable.curPage=0,this.$refs.infinite.stateChanger.reset()},clearSearchTxt:function(){this.searchData="",this.refresh()},search:function(){this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchData=this.searchTxt,this.refresh()):this.$message.success("请输入搜索关键词")},handleSelectionChange:function(e){this.trashTable.multipleSelection=e},dateFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("YYYY年MM月DD日 HH:mm")},dateShortFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("MM月DD日 HH:mm")},handleMultiNormalSubmit:function(){var e=this;0!==this.trashTable.multipleSelection.length?this.$confirm("确认恢复这些文件吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.trashTable.loading=!0;var t=e.trashTable.multipleSelection;e.$axios({url:"user/trashs",method:"put",data:t}).then(function(t){e.$message({message:"恢复成功",type:"success"}),e.refresh(),e.trashTable.loading=!1})}).catch(function(){}):this.$message.error("没有选择需要恢复的文件，请重新选择！")},handleToNormal:function(e,t){var a=this;this.$confirm("是否恢复该记录?","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){a.trashTable.loading=!0;var e=Object.assign({},t);a.$axios({url:"user/trash",method:"put",data:e}).then(function(e){0===e.c?(a.$message.success("数据已恢复"),a.refresh(),a.$emit("lay_addFolder",e)):a.$message.error(e.msg),a.trashTable.loading=!1})}).catch(function(){})},handleMultiDeleteSubmit:function(){var e=this;0!==this.trashTable.multipleSelection.length?this.$confirm("确认删除这些文件吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.trashTable.loading=!0;var t=e.trashTable.multipleSelection;e.$axios({url:"user/trashs",method:"delete",data:t}).then(function(t){e.$message({message:"删除成功",type:"success"}),e.refresh(),e.trashTable.loading=!1})}).catch(function(){}):this.$message.error("没有选择需要删除的文件，请重新选择！")},handleToDelete:function(e,t){var a=this;this.$confirm("彻底该记录?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){a.trashTable.loading=!0;var e=Object.assign({},t);a.$axios({url:"user/trash",method:"delete",data:e}).then(function(e){0===e.c?(a.$message.success("已经彻底删除"),a.refresh()):a.$message.error(e.msg),a.trashTable.loading=!1})}).catch(function(){})},nextPage:function(e){this.trashTable.curPage+=1,this.getData(e)}})},n=(a("kgFX"),a("KHd+")),o=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr"},[a("el-button-group",[a("el-button",{attrs:{size:"small",icon:"el-icon-arrow-left"},on:{click:e.curFolderAction}}),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.nextFolderAction}},[a("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),e._v(" "),a("el-breadcrumb",{staticClass:"pl10",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("回收站")])],1)],1),e._v(" "),a("div",{staticClass:"ib"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.clearSearchTxt},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{size:"mini",icon:"iconfont icon-shuaxin"},on:{click:e.refresh}},[e._v(" 刷新")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-fanhui1",plain:""},on:{click:e.handleMultiNormalSubmit}},[e._v("  文档恢复")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-shanchu",plain:""},on:{click:e.handleMultiDeleteSubmit}},[e._v("  彻底删除")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.trashTable.loading,expression:"trashTable.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.trashTable.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.trashTable.height},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"文件名",width:"350px","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[20===t.row.docType?a("div",[a("img",{staticStyle:{width:"20px",height:"auto"},attrs:{src:e.viewImageUrl,alt:""}}),e._v(" "),a("b",[e._v(e._s(t.row.name))])]):a("div",["folder"===t.row.kind?a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:"#",target:"_self"},on:{click:function(a){e.nodeClick(t.row)}}},[a("b",[e._v(e._s(t.row.name))])])],1):a("div",[a("div",[a("app-svg",{attrs:{iconText:t.row.suffix}}),e._v(" "),a("b",[e._v(e._s(t.row.name)+"."+e._s(t.row.suffix))])],1)])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文件原始路径",align:"left","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.fullName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"删除日期",align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.dateFormat(t.row.deleteDate)))]),e._v(" "),a("p",[e._v(e._s(e.dateShortFormat(t.row.deleteDate)))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"删除者",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.deleteUserName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文件大小",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["folder"===t.row.kind?a("div"):a("div",[a("p",[e._v(e._s(t.row.size))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文档恢复",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-fanhui1",circle:""},on:{click:function(a){e.handleToNormal(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"彻底删除",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},on:{click:function(a){e.handleToDelete(t.$index,t.row)}}})],1)],1)]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1)],1)},[],!1,null,"49b1839c",null);t.default=o.exports},WNey:function(e,t,a){"use strict";var i=a("Z4iQ");a.n(i).a},WO0x:function(e,t,a){"use strict";var i=a("h75/");a.n(i).a},XBtZ:function(e,t,a){},XDod:function(e,t,a){"use strict";a.r(t);var i={components:{EditFolder:a("Bl3E").a},name:"EditSetting",props:{addJob:{type:Function,default:null},editJob:{type:Function,default:null}},mounted:function(){this.getRestOption()},data:function(){return{defaultKey:[1],formFolderSetting:{isNew:!1,title:"",visible:!1,loading:!1,id:0,workflowData:{id:0,key:"",options:[]},deptData:{id:0,key:"",options:[]},kindData:{id:0,key:"",options:[]},dateData:{value:""},folderTree:{visible:!1,loading:!1,props:{label:"name",children:"children"},body:[],selected:null},submitData:{id:0,workflowid:"",firstdictcode:"",seconddictcode:"",thirddictcode:"",folderid:"",foldername:"",fullpath:"",fullname:""}}}},methods:{printFolderTree:function(e,t){var a=this,i=void 0;i=0===e.level?0:e.data.id,this.formFolderSetting.folderTree.loading=!0,this.$axios({url:"/admin/folder/"+i+"/children",method:"get"}).then(function(e){t(e.ctt),a.formFolderSetting.folderTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},folderSelect:function(e){this.formFolderSetting.folderTree.selected=e},addFolder:function(e){this.$refs.folderTree.append(e.ctt,e.ctt.parentId)},editFolder:function(e){var t=this.$refs.folderTree.getNode(e);this.$refs.folderTree.remove(e),this.$refs.folderTree.append(e,e.parentId),t.data.name=e.name},deleteFolder:function(e){this.$refs.folderTree.remove(e)},handleAddSetting:function(){var e=this;this.$refs.formFolderSetting&&this.$refs.formFolderSetting.resetFields(),this.formFolderSetting.isNew=!0,this.formFolderSetting.title="新增导入流程配置",this.formFolderSetting.dateData={value:""},this.$axios({url:"/relay/setting/relay_setting/workflow",method:"get"}).then(function(t){e.formFolderSetting.workflowData={id:0,key:"",options:t.ctt}}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)}),this.$axios({url:"/relay/setting/relay_setting/dept",method:"get"}).then(function(t){e.formFolderSetting.deptData={id:0,key:"",options:t.ctt}}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)}),this.$axios({url:"/relay/setting/relay_setting/kind",method:"get"}).then(function(t){e.formFolderSetting.kindData={id:0,key:"",options:t.ctt}}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)}),this.formFolderSetting.visible=!0},addSubmit:function(){var e=this;this.formFolderSetting.workflowData.key?this.formFolderSetting.deptData.key?this.formFolderSetting.kindData.key?this.formFolderSetting.dateData.value?this.formFolderSetting.folderTree.selected?this.$confirm("确认新增吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formFolderSetting.loading=!0;var t=e.formFolderSetting.workflowData.key,a=e.formFolderSetting.deptData.key,i=e.formFolderSetting.kindData.key,s=e.$moment(e.formFolderSetting.dateData.value).format("YYYY"),n=e.formFolderSetting.folderTree.selected;e.formFolderSetting.submitData={workflowid:t,firstdictcode:a,seconddictcode:i,thirddictcode:s,folderid:n.id,foldername:n.name,fullpath:n.fullPath,fullname:n.fullName},e.$axios({url:"/relay/setting",method:"post",data:e.formFolderSetting.submitData}).then(function(t){0===t.c?(e.$message.success("添加配置成功"),e.formFolderSetting.visible=!1,e.clear(),e.addJob()):e.$message.error(t.msg),e.formFolderSetting.loading=!1})}):this.$message.warning("导入目录没有指定！"):this.$message.warning("合同年份没有指定！"):this.$message.warning("合同类型没有指定！"):this.$message.warning("基地没有指定！"):this.$message.warning("流程没有指定！")},handleEdit:function(e,t){var a=this;this.$refs.formFolderSetting&&this.$refs.formFolderSetting.resetFields(),this.formFolderSetting.isNew=!1,this.formFolderSetting.title="编辑导入流程配置",this.formFolderSetting.visible=!0,this.formFolderSetting.dateData={value:""},this.formFolderSetting.workflowData.key=t.workflowid.toString(),this.formFolderSetting.deptData.key=t.firstdictcode.toString(),this.formFolderSetting.kindData.key=t.seconddictcode.toString(),this.formFolderSetting.dateData.value=t.thirddictcode.toString(),this.formFolderSetting.id=t.id,this.$nextTick(function(){var e=[];e.push(t.folderid),a.defaultKey=e,a.$refs.folderTree.setCurrentKey(t.folderid)})},editSubmit:function(){var e=this;this.formFolderSetting.folderTree.selected=this.$refs.folderTree.getCurrentNode(),this.formFolderSetting.workflowData.key?this.formFolderSetting.deptData.key?this.formFolderSetting.kindData.key?this.formFolderSetting.dateData.value?this.formFolderSetting.folderTree.selected?this.$confirm("确认修改吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formFolderSetting.loading=!0;var t=e.formFolderSetting.workflowData.key,a=e.formFolderSetting.deptData.key,i=e.formFolderSetting.kindData.key,s=e.$moment(e.formFolderSetting.dateData.value).format("YYYY"),n=e.formFolderSetting.folderTree.selected;e.formFolderSetting.submitData={id:e.formFolderSetting.id,workflowid:t,firstdictcode:a,seconddictcode:i,thirddictcode:s,folderid:n.id,foldername:n.name,fullpath:n.fullPath,fullname:n.fullName},e.$axios({url:"/relay/editSetting",method:"post",data:e.formFolderSetting.submitData}).then(function(t){0===t.c?(e.$message.success("修改配置成功"),e.formFolderSetting.visible=!1,e.clear(),e.addJob()):e.$message.error(t.msg),e.formFolderSetting.loading=!1})}):this.$message.warning("导入目录没有指定！"):this.$message.warning("合同年份没有指定！"):this.$message.warning("合同类型没有指定！"):this.$message.warning("基地没有指定！"):this.$message.warning("流程没有指定！")},handleDeleteSettingSubmit:function(e,t){var a=this;this.$confirm("确认删除配置?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e=Object.assign({},t);a.$axios({url:"/relay/setting",method:"delete",data:e}).then(function(e){a.$message({message:"配置已删除",type:"success"}),a.addJob()})}).catch(function(){})},getRestOption:function(){var e=this;this.$axios({url:"/relay/setting/relay_setting/workflow",method:"get"}).then(function(t){e.formFolderSetting.workflowData={id:0,key:"",options:t.ctt}}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)}),this.$axios({url:"/relay/setting/relay_setting/dept",method:"get"}).then(function(t){e.formFolderSetting.deptData={id:0,key:"",options:t.ctt}}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)}),this.$axios({url:"/relay/setting/relay_setting/kind",method:"get"}).then(function(t){e.formFolderSetting.kindData={id:0,key:"",options:t.ctt}}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},clear:function(){this.formFolderSetting.folderTree.body=[],this.formFolderSetting.folderTree.selected=null},close:function(){this.clear(),this.formFolderSetting.visible=!1}}},s=(a("I4mM"),a("KHd+")),n={name:"log",components:{EditSetting:Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.formFolderSetting.title,visible:e.formFolderSetting.visible,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(t){e.$set(e.formFolderSetting,"visible",t)}}},[a("el-form",{ref:"formFolderSetting",attrs:{model:e.formFolderSetting.data,"label-width":"120px"}},[a("el-row",{staticStyle:{"min-height":"500px",height:"500px"},attrs:{gutter:30}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticStyle:{"font-weight":"bold"},attrs:{label:"流程名称：",prop:"name"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFolderSetting.workflowData.key,callback:function(t){e.$set(e.formFolderSetting.workflowData,"key",t)},expression:"formFolderSetting.workflowData.key"}},e._l(e.formFolderSetting.workflowData.options,function(e){return a("el-option",{key:e.key,staticStyle:{"margin-bottom":"10px"},attrs:{label:e.value,value:e.key}})}))],1),e._v(" "),a("el-form-item",{staticStyle:{"font-weight":"bold"},attrs:{label:"基地：",prop:"name"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFolderSetting.deptData.key,callback:function(t){e.$set(e.formFolderSetting.deptData,"key",t)},expression:"formFolderSetting.deptData.key"}},e._l(e.formFolderSetting.deptData.options,function(e){return a("el-option",{key:e.key,staticStyle:{"margin-bottom":"10px"},attrs:{label:e.value,value:e.key}})}))],1),e._v(" "),a("el-form-item",{staticStyle:{"font-weight":"bold"},attrs:{label:"合同类型",prop:"group"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFolderSetting.kindData.key,callback:function(t){e.$set(e.formFolderSetting.kindData,"key",t)},expression:"formFolderSetting.kindData.key"}},e._l(e.formFolderSetting.kindData.options,function(e){return a("el-option",{key:e.key,staticStyle:{"margin-bottom":"10px"},attrs:{label:e.value,value:e.key}})}))],1),e._v(" "),a("el-form-item",{staticStyle:{"font-weight":"bold"},attrs:{label:"合同年份",prop:"cron"}},[a("el-date-picker",{attrs:{type:"year",placeholder:"选择年"},model:{value:e.formFolderSetting.dateData.value,callback:function(t){e.$set(e.formFolderSetting.dateData,"value",t)},expression:"formFolderSetting.dateData.value"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc"}},[a("el-scrollbar",{staticStyle:{height:"450px"}},[e.formFolderSetting.visible?a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.formFolderSetting.folderTree.loading,expression:"formFolderSetting.folderTree.loading"}],ref:"folderTree",staticClass:"mr20",attrs:{accordion:!0,"highlight-current":!0,data:e.formFolderSetting.folderTree.body,props:e.formFolderSetting.folderTree.props,"default-expand-all":!1,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":e.defaultKey,lazy:"",load:e.printFolderTree},on:{"node-click":e.folderSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("b",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-wenjianjia"}})]),e._v(" "),a("b",[e._v(e._s(i.label))])]),e._v(" "),1===s.id?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增下级文件夹",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-add",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderAdd(i)}}})],1)],1):a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增下级文件夹",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-add",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderAdd(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑文件夹",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-node",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderEdit(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除文件夹",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderDelete(i)}}})],1)],1)])}}])}):e._e()],1)],1)])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.formFolderSetting.isNew?a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.formFolderSetting.loading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]):e._e(),e._v(" "),e.formFolderSetting.isNew?e._e():a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.formFolderSetting.loading},nativeOn:{click:function(t){return e.editSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.close(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1),e._v(" "),a("edit-folder",{ref:"editFolder",attrs:{"add-folder":e.addFolder,"edit-folder":e.editFolder,"delete-folder":e.deleteFolder}})],1)},[],!1,null,"62b9335d",null).exports},data:function(){return{searchForm:{time:"",type:"",text:""},tableFolderSetting:{height:0,loading:!1,body:[]}}},mounted:function(){this.getData(),this.tableHeight()},methods:{tableHeight:function(){this.$nextTick(function(){this.tableFolderSetting.height=window.innerHeight-this.$refs.table.$el.offsetTop-200;var e=this;window.onresize=function(){e.tableFolderSetting.height=window.innerHeight-e.$refs.table.$el.offsetTop-200}})},getData:function(){var e=this;this.tableFolderSetting.loading=!0,this.$axios({url:"/relay/settings",method:"get"}).then(function(t){e.tableFolderSetting.body=t.ctt,e.tableFolderSetting.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})}}},o=(a("+L9i"),Object(s.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"OA"}}),e._v("  OA导入附件目录设定")],1)])]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-add",plain:""},nativeOn:{click:function(t){return e.$refs.setting.handleAddSetting(t)}}},[e._v("  新增配置")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableFolderSetting.loading,expression:"tableFolderSetting.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableFolderSetting.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableFolderSetting.height}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"64px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"workflowname",label:"流程名称",width:"350px"}}),e._v(" "),a("el-table-column",{attrs:{label:"已定义流程属性详细",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("\n                                "+e._s(t.row.firstdictname)+" - "+e._s(t.row.seconddictname)+" - "+e._s(t.row.thirddictcode)+"\n                            ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"已指定目录","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("\n                                "+e._s(t.row.fullname)+"\n                            ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑配置目录",placement:"bottom"}},[a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-file",circle:""},nativeOn:{click:function(a){e.$refs.setting.handleEdit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除配置",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},nativeOn:{click:function(a){e.$refs.setting.handleDeleteSettingSubmit(t.$index,t.row)}}})],1)],1)]}}])})],1)],1)],1),e._v(" "),a("edit-setting",{ref:"setting",attrs:{"add-job":e.getData,"edit-job":e.getData}})],1)},[],!1,null,"419d1d1c",null));t.default=o.exports},XZfp:function(e,t,a){"use strict";a.r(t);var i={name:"OutPutCSV",data:function(){return{formOutPut:{data:{},rules:{},visible:!1,loading:!1},deptTree:{data:[],props:{children:"children",label:"name"},loading:!1,selected:null},pickerDateRange:{data:"",Options:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}}},methods:{getDept:function(){var e=this;this.deptTree.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),e.deptTree.data=a,e.deptTree.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},deptSelect:function(e){this.deptTree.selected=e},handleOutputCSV:function(){this.formOutPut.visible=!0,this.$refs.formOutPut&&this.$refs.formOutPut.resetFields()},handleOutputCSVSubmit:function(){var e=this;this.$refs.formOutPut.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formOutPut.loading=!0;var t=0;e.deptTree.selected&&(t=e.deptTree.selected.id);var a="0000-00-00",i="9999-99-99";e.pickerDateRange.data&&(a=e.pickerDateRange.data[0],i=e.pickerDateRange.data[1]),e.$axios({url:"admin/dept/"+t+"/links/download/"+a+"/"+i,method:"post",responseType:"blob"}).then(function(t){if(!t)return e.$message({message:"下载失败",type:"error"}),e.formOutPut.loading=!1,void(e.formOutPut.visible=!1);var a=new Blob([t]);if("download"in document.createElement("a")){var i=document.createElement("a");i.download="link_log.csv",i.style.display="none",i.href=URL.createObjectURL(a),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)}else window.navigator.msSaveBlob(a,"link_log.csv");e.formOutPut.loading=!1,e.formOutPut.visible=!1})})})}}},s=(a("4htw"),a("KHd+")),n={components:{OutPutCSV:Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"外链导出",visible:e.formOutPut.visible,"close-on-click-modal":!0,width:"700px"},on:{"update:visible":function(t){e.$set(e.formOutPut,"visible",t)},open:e.getDept}},[a("el-form",{ref:"formOutPut",attrs:{model:e.formOutPut.data,"label-width":"120px",rules:e.formOutPut.rules}},[a("el-row",{staticStyle:{"min-height":"400px",height:"400px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"400px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTree.loading,expression:"deptTree.loading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptTree.data,"highlight-current":"",props:e.deptTree.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.deptSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-date-picker",{attrs:{type:"daterange",size:"large",align:"right","unlink-panels":"","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerDateRange.Options},model:{value:e.pickerDateRange.data,callback:function(t){e.$set(e.pickerDateRange,"data",t)},expression:"pickerDateRange.data"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.formOutPut.loading},on:{click:e.handleOutputCSVSubmit}},[e._v("确定")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formOutPut.visible=!1}}},[e._v("取消")])],1)],1)},[],!1,null,"3ab53461",null).exports},name:"link",data:function(){return{onlyShowValid:!0,tableData:{height:0,loading:!0,body:[]},formRules:{},formData:{},addFormVisible:!1,editFormVisible:!1,paginationData:{pageSize:1e3,total:0,curPage:1},multipleSelection:[],searchTxt:""}},mounted:function(){this.getData(),this.tableHeight()},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.table.$el.offsetTop-200;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.table.$el.offsetTop-200}})},refresh:function(){this.getData()},getData:function(){var e=this;this.tableData.loading=!0,this.$axios({url:"/admin/dept/0/links/"+this.paginationData.curPage+"-"+this.paginationData.pageSize,method:"get"}).then(function(t){if(e.onlyShowValid){var a=[];if(t.ctt.list.length>0)for(var i=0;i<t.ctt.list.length;i++)"NORMAL"===t.ctt.list[i].status&&null!=t.ctt.list[i].user&&a.push(t.ctt.list[i]);else a=t.ctt.list;e.tableData.body=a,e.paginationData.total=t.ctt.total,e.tableData.loading=!1}else e.tableData.body=t.ctt.list,e.paginationData.total=t.ctt.total,e.tableData.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},search:function(){this.searchTxt&&this.searchTxt.trim()||this.$message.success("请输入搜索关键词")},sizeChange:function(e){this.paginationData.pageSize=e,this.getData()},pageChange:function(e){this.paginationData.curPage=e,this.getData()},handleSelectionChange:function(e){this.multipleSelection=e},onlyValid:function(e){this.onlyShowValid=e,this.getData()},dateShortFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("MM月DD日 HH:mm")},dateFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("YYYY年MM月DD日")},handleDeleteSubmit:function(e,t){var a=this;this.$confirm("确认删除此外链吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){a.tableData.loading=!0;var e=Object.assign({},t);a.$axios({url:"admin/link",method:"delete",data:e}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getData()})}).catch(function(){})}}},o=(a("WO0x"),Object(s.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"gongxiangwenjianjia"}}),e._v("  外部链接")],1)]),e._v(" "),a("div",{staticClass:"ib"})]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-caozuo-shangchuan-download",plain:""},on:{click:function(t){e.$refs.outPutCSV.handleOutputCSV()}}},[e._v("  导出记录")])],1),e._v(" "),a("div",{staticClass:"fxr pd5"},[a("el-checkbox",{on:{change:e.onlyValid},model:{value:e.onlyShowValid,callback:function(t){e.onlyShowValid=t},expression:"onlyShowValid"}},[e._v("只表示有效外链")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.resources,function(t){return[a("el-row",{staticStyle:{"padding-left":"25px"}},[a("el-col",{attrs:{span:1,align:"right"}},["folder"===t.kind?a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}})],1):a("div",[a("app-svg",{attrs:{iconText:t.suffix}})],1)]),e._v(" "),a("el-col",{attrs:{span:7}},[a("P",{staticStyle:{"line-height":"30px","font-size":"15px","padding-left":"3px"}},[a("b",[e._v(e._s(t.name)+"."+e._s(t.suffix))])])],1)],1)]})]}}])}),e._v(" "),a("el-table-column",{attrs:{type:"selection","min-width":"10%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"外链"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-gongxiangwenjianjia"}})]),e._v("\n                        "+e._s(t.row.name)+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发布者",align:"center","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.user.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"有效期",align:"center","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.days?a("div",[a("p",[e._v("无期限")])]):a("div",[a("p",[e._v(e._s(t.row.days)+"天")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"结束时间",align:"center","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.days?a("div"):a("div",[a("p",[e._v(e._s(e.dateFormat(t.row.endDate))+"截至")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return["EXPIRE"===t.row.status?a("div",[a("p",[e._v("已失效")])]):"DELETE"===t.row.status?a("div",[a("p",[e._v("已删除")])]):a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"外链删除",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon--duankailianjie",circle:""},on:{click:function(a){e.handleDeleteSubmit(t.$index,t.row)}}})],1)],1)]}}])})],1)],1)],1),e._v(" "),a("outPutCSV",{ref:"outPutCSV"})],1)},[],!1,null,"fb7edebe",null));t.default=o.exports},XaRa:function(e,t,a){},XdT2:function(e,t,a){"use strict";var i=a("ZTAR");a.n(i).a},YCs0:function(e,t,a){"use strict";var i=a("FsOF");a.n(i).a},YGwE:function(e,t,a){"use strict";a.r(t);var i=a("bZsl"),s=a("jhdv"),n=a("26K/"),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l={name:"uploadResource",data:function(){return{types:"create",visible:!1,dataSourceVisible:!1,form:{docType:"",quoteData:{dbName:"",aliasName:""}},rules:{docType:[{required:!0,message:"此项为必填项",trigger:"blur"}]},formFields:[],docTypes:[],dataSourceList:[],selectedQuoteData:null,folderId:-1,bodyFormData:null,searchData:null,upload:{url:this.$upload,size:this.$maxFileSize},formFile:{isNew:!1,title:"",action:"",visible:!1,loading:!1,data:{id:0,fileName:"",folderId:0,folderName:"",comment:""},fileList:[],uploadFileList:[]},paginationData:{pageSize:1e3,total:0,curPage:1},editData:{},deleteStr:[]}},computed:{token:function(){return{Authorization:"Bearer "+this.$store.state.auth.token}},dialogTitle:function(){return"edit"===this.types?"修改文献":"文献上传"}},mounted:function(){},methods:{initFormFields:function(e){var t=this;this.$axios({method:"get",url:"/external/metadata/type/"+e}).then(function(e){0===e.c&&(t.formFields=e.ctt.map(function(e){var a=i.dataTypes.find(function(t){return t.value===e.dataType}).label;t.form[e.code]=Object(i.formatDataType)(a);var s=o({},e,{types:a,value:Object(i.formatDataType)(a),rules:[]});return 0===s.notnull&&(s.rules=[]),s}))}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},initForm:function(){this.form={docType:"",quoteData:{dbName:""}}},checkItemsRule:function(e){return 1===e.notnull&&""===e.value},handleSetVal:function(e,t){this.$set(this.form,e,t)},handleChangeDocType:function(e){e?this.initFormFields(e):this.initForm()},handleOnOpen:function(){var e=this;if(this.initDocTypes(),!("create"===this.types)){var t=this.editData.fileMetadataDto[0].docType;this.form.docType=String(t);var a=JSON.parse(JSON.stringify(this.editData)),s=a.fileAccessoryDto.find(function(e){return 2===e.type});s&&this.$axios({url:"external/dbById/"+s.saveId,method:"get"}).then(function(t){0===t.c&&(e.form.quoteData={aliasName:t.ctt.aliasName,dbName:s.name,dbId:s.saveId})});var n=a.fileAccessoryDto.filter(function(e){return 1===e.type});this.formFile.fileList=n.map(function(e){return{name:e.name+"."+e.suffix,id:e.id,url:""}}),this.formFields=a.fileMetadataDto.map(function(t){var s=i.dataTypes.find(function(e){return e.value===t.dataType}).label;e.form[t.code]=Object(i.formatDataType)(s);var n=o({},t,{types:s,value:Object(i.formatDataType)(s),rules:[],id:t.metadataId});if(6===t.dataType){var l="true"===a.fileMetadataDto.find(function(e){return e.code===t.code}).value;n.value=l}else{var r=a.fileMetadataDto.find(function(e){return e.code===t.code}).value;n.value=r}return 0===n.notnull&&(n.rules=[]),n})}},handleOnClose:function(){this.initForm(),this.$refs.form.resetFields(),this.formFile.fileList=[],this.formFile.uploadFileList=[],this.formFields=[],this.editData={},this.deleteStr=[]},initDocTypes:function(){var e=this;this.$axios({method:"get",url:"/external/metadataType"}).then(function(t){e.docTypes=t.ctt})},onFileChange:function(e,t){var a=this,s=this.$refs.uploadFile.uploadFiles;if(!this.checkFileSize(e))return this.$message.error("上传文件大小不能超过 "+this.upload.size+"MB!"),void this.$refs.uploadFile.uploadFiles.pop();s.filter(function(t){return t.name===e.name}).length>1&&this.$confirm("存在同名文件，覆盖还是作为新文件上传？","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning",confirmButtonText:"覆盖",cancelButtonText:"新文件",distinguishCancelAndClose:!0}).then(function(){s=s.filter(function(t){return t.name!==e.name}),e.isCover=!0,s.push(e),a.formFile.fileList=s}).catch(function(){e.name=Object(i.generateNewName)(e.name,s.length-1),(s=(s=s.filter(function(t){return t.name!==e.name})).filter(function(t){return t.uid!==e.uid})).push(e),a.formFile.fileList=s})},onFileRemove:function(e,t){e.id&&this.deleteStr.push(e.id),this.formFile.uploadFileList=this.formFile.uploadFileList.filter(function(t){return t.uid===e.uid})},onUploadSuccess:function(e,t,a){this.$message.success("文件上传完成"),this.uploaded(),this.formFile.loading=!1,this.formFile.visible=!1,console.log("上传文件",e)},onUploadError:function(e,t,a){this.$message.error("上传失败，请重试！"),this.uploaded(),this.formFile.loading=!1,this.formFile.visible=!1,console.log("上传失败")},checkFileSize:function(e){return e.size/1024/1024<=this.upload.size},handleClickQuoteData:function(){this.dataSourceVisible=!0,this.initDatabases()},initDatabases:function(){var e=this,t="/external/dbs/1-10000?name=";this.searchData&&(t="/external/dbs/1-10000?name="+this.searchData),this.$axios({method:"get",url:t}).then(function(t){0===t.c&&(e.dataSourceList=t.ctt.map(function(e){return o({},e,{dbId:e.id})}))}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},handleCurrentChange:function(e){this.selectedQuoteData=e},quoteDataDialogOnSubmit:function(){this.selectedQuoteData?(this.form.quoteData=this.selectedQuoteData,this.dataSourceVisible=!1):this.$message.warning("请选择数据库")},quoteDataDialogOnClose:function(){this.dataSourceVisible=!1},dialogOnSubmit:function(){var e=this;-1!==this.folderId&&this.$refs.form.validate(function(t){t&&e.checkValid()?e.handleSubmitData():e.$message.warning("请检查输入的数据")})},checkValid:function(){return!this.formFields.filter(function(e){return 1===e.notnull}).find(function(e){return""===e.value})&&!this.formFields.find(function(e){return e.value.length>e.size})},handleSubmitData:function(){var e=this;if("edit"!==this.types){var t=this.formFields.map(function(e){return{metadataId:e.id,dataType:e.dataType,code:e.code,name:e.name,seq:e.seq,value:e.value}}),a={files:this.$refs.uploadFile.uploadFiles,database:this.form.quoteData.dbId?this.form.quoteData.dbId:"",metadata:JSON.stringify(t)},i=new FormData;if(i.append("metaStr",a.metadata),a.database?i.append("database",a.database):i.append("database",""),a.files.length>0)for(var n=0;n<a.files.length;n+=1){var o=a.files[n];if(o){var l=new File([o.raw],o.name,{type:o.raw.type});i.append("files",l)}}this.$axios({method:"post",url:"/user/folder/"+this.folderId+"/literature",data:i,headers:{"Content-Type":"multipart/form-data"}}).then(function(t){0===t.c&&(e.$message.success("上传成功"),e.handleOnClose(),e.visible=!1,s.a.$emit("refreshHome"))}).catch(function(t){e.$message.error("提交数据失败，失败码："+t.response.status)})}else{var r=this.$refs.uploadFile.uploadFiles,c=this.formFields.map(function(e){return{metadataId:e.id,dataType:e.dataType,code:e.code,name:e.name,seq:e.seq,value:e.value}}),d=r.filter(function(e){return"success"!==e.status}),u=d.filter(function(e){return e.isCover}),f={files:d.filter(function(e){return!e.isCover}),coverFiles:u,deleteStr:JSON.stringify(this.deleteStr),database:this.form.quoteData.dbId?this.form.quoteData.dbId:"",metadata:JSON.stringify(c)},m=new FormData;if(m.append("metaStr",f.metadata),m.append("deleteStr",f.deleteStr),f.database?m.append("database",f.database):m.append("database",""),f.files.length>0)for(var p=0;p<f.files.length;p+=1){var h=f.files[p];if(h){var g=new File([h.raw],h.name,{type:h.raw.type});m.append("files",g)}}if(f.coverFiles.length>0)for(var b=0;b<f.coverFiles.length;b+=1){var v=f.coverFiles[b];if(v){var y=new File([v.raw],v.name,{type:v.raw.type});m.append("coverFiles",y)}}this.$axios({method:"post",url:"/user/file/"+this.editData.id+"/upload/literature",data:m,headers:{"Content-Type":"multipart/form-data"}}).then(function(t){0===t.c&&(e.$message.success("修改成功"),e.handleOnClose(),e.visible=!1,s.a.$emit("refreshHome"))}).catch(function(t){e.$message.error("提交数据失败，失败码："+t.response.status)})}},readFile:function(e,t){var a=void 0,i=new FileReader;i.onloadend=function(e){a=e.target.result,t(a)},e&&i.readAsBinaryString(e.raw)},dialogOnClose:function(){this.visible=!1,this.handleOnClose()},nameFormat:function(e,t){return""===e.aliasName?e.dbName:e.aliasName}}},r=(a("yRg/"),a("KHd+")),c=Object(r.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-resource-container"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},open:e.handleOnOpen,close:e.handleOnClose}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"90px","label-position":"left"}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:12}},[a("el-form-item",{attrs:{label:"文档类型",prop:"docType",rules:e.rules.docType}},[a("el-select",{attrs:{placeholder:"请选择文档类型"},on:{change:e.handleChangeDocType},model:{value:e.form.docType,callback:function(t){e.$set(e.form,"docType",t)},expression:"form.docType"}},e._l(e.docTypes,function(e,t){return a("el-option",{key:t,attrs:{label:e.comment,value:e.value}})}))],1),e._v(" "),a("div",{staticStyle:{"padding-bottom":"10px"}},[e._v("选择上传文件")]),e._v(" "),a("el-upload",{ref:"uploadFile",staticClass:"upload-demo",attrs:{drag:"",multiple:"","auto-upload":!1,headers:e.token,"file-list":e.formFile.fileList,action:e.formFile.action,"on-change":e.onFileChange,"on-remove":e.onFileRemove,onSuccess:e.onUploadSuccess,onError:e.onUploadError}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("文件大小不能超过"+e._s(this.upload.size)+"MB")])]),e._v(" "),a("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"引用数据源",prop:"quoteData"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.quoteData.aliasName,callback:function(t){e.$set(e.form.quoteData,"aliasName",t)},expression:"form.quoteData.aliasName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-more"},on:{click:e.handleClickQuoteData},slot:"append"})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[e._l(e.formFields,function(t,i){return[a("el-form-item",{key:i,attrs:{label:t.name,prop:t.code,rules:t.rules}},["字符串"===t.types?a("el-input",{on:{input:function(a){e.handleSetVal(t.code,t.value)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"items.value"}}):"大文本"===t.types?a("el-input",{attrs:{type:"textarea",placeholder:"不要超过200字。"},on:{input:function(a){e.handleSetVal(t.code,t.value)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"items.value"}}):"日期"===t.types?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},on:{change:function(a){e.handleSetVal(t.code,t.value)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"items.value"}}):"布尔值"===t.types?a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"items.value"}}):e._e(),e._v(" "),e.checkItemsRule(t)?a("div",{staticClass:"el-form-item__error"},[e._v("此项为必填项")]):e._e(),e._v(" "),t.value.length>t.size?a("div",{staticClass:"el-form-item__error"},[e._v("此项长度不能超过"+e._s(t.size)+"个字符")]):e._e()],1)]})],2)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new"},on:{click:e.dialogOnSubmit}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.dialogOnClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"选择数据源",visible:e.dataSourceVisible,width:"400px"},on:{"update:visible":function(t){e.dataSourceVisible=t}}},[a("el-table",{attrs:{data:e.dataSourceList,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"aliasName",formatter:e.nameFormat,label:"名称"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new"},on:{click:e.quoteDataDialogOnSubmit}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.quoteDataDialogOnClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,null,null).exports,d=a("uZRj"),u=a("r/zx");var f={name:"UploadFolder",props:{uploaded:{type:Function,default:null}},computed:{token:function(){return{Authorization:"Bearer "+this.$store.state.auth.token}}},data:function(){return{folderClear:!0,parentFolder:{files:[]},upload:{url:this.$upload,size:this.$maxFileSize},settingTable:{height:0,body:[],total:0,loading:!1,selected:null,multipleSelection:[],settingDetailTable:{isNew:!0,title:"编辑送信用户组",data:{id:0,name:""},rules:{name:[{required:!0,message:"请输入用户组名称",trigger:"blur"}]},visible:!1},submit:{id:0,name:"",kind:"",status:0,details:[]}},deptTree:{data:[],props:{children:"children",label:"name"},loading:!1,selected:null},memberTable:{height:0,body:[],total:0,loading:!1,selected:null},selectedTable:{height:0,body:[],loading:!1,selected:null,changeSelectedDept:!1},paginationData:{pageSize:1e3,total:0,curPage:1},formFolder:{title:"",action:"",visible:!1,loading:!1,data:{id:0,fileName:"",folderId:0,folderName:"",comment:""},fileList:[{name:"",data:null,progress:0}]}}},methods:{handleUploadFolder:function(e,t){this.upload.size=t,this.formFolder.title="文件夹上传",this.formFolder.isNew=!0,this.formFolder.data={id:0,fileName:"",folderName:e.name,folderId:e.id,comment:""},this.printUserSetting(),this.$refs.formFolder&&this.$refs.formFolder.resetFields(),this.$refs.uploadFolder&&this.$refs.uploadFolder.clearFiles(),this.formFolder.fileList=[],this.formFolder.visible=!0},handleOpenFolder:function(){var e=this;this.folderClear=!1,this.$nextTick(function(){e.folderClear=!0}),setTimeout(function(){document.getElementById("openFolder").click()},500)},onChangeStopProcess:function(){this.formFolder.fileList=[];for(var e=0;e<this.$refs.folderSelect.files.length;e++){var t={name:this.$refs.folderSelect.files[e].name,data:this.$refs.folderSelect.files[e],percentage:0};this.formFolder.fileList.push(t)}},handleUpdateProgress:function(e,t){this.$forceUpdate(),this.$set(this.formFolder.fileList.filter(function(t){return t.name===e.name})[0],"progress",t)},handleUploadFolderSubmit:function(){var e,t=this;return(e=regeneratorRuntime.mark(function e(){var a,i,s,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.folderValidate(t.formFolder.fileList)){e.next=2;break}return e.abrupt("return");case 2:a=t.createSendUserSetting(),i=0,t.formFolder.loading=!0,s=regeneratorRuntime.mark(function e(s){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("file",t.formFolder.fileList[s].data),n.append("id",t.formFolder.data.folderId),n.append("send",a),n.append("comment",t.formFolder.data.comment),e.t0=i,e.next=8,t.onUploadFolderProcess(t.formFolder.fileList[s].data,n,function(e){t.handleUpdateProgress(t.formFolder.fileList[s].data,e)});case 8:e.t1=e.sent,i=e.t0+e.t1;case 10:case"end":return e.stop()}},e,t)}),n=0;case 7:if(!(n<t.formFolder.fileList.length)){e.next=12;break}return e.delegateYield(s(n),"t0",9);case 9:n++,e.next=7;break;case 12:0===i?(t.$message.success("文件夹上传完成！"),t.uploaded(),t.formFolder.loading=!1,t.formFolder.visible=!1):(t.$message.warning("文件夹上传完成！但可能有部分文件上传失败，请确认。"),t.uploaded(),t.formFolder.loading=!1,t.formFolder.visible=!1);case 13:case"end":return e.stop()}},e,t)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function i(s,n){try{var o=t[s](n),l=o.value}catch(e){return void a(e)}if(!o.done)return Promise.resolve(l).then(function(e){i("next",e)},function(e){i("throw",e)});e(l)}("next")})})()},onUploadFolderProcess:function(e,t,i){var s=this,n=a("lJCZ");return new Promise(function(e,a){setTimeout(function(){s.$axios({url:s.upload.url+"/user/folder/new",method:"post",data:t,headers:{"Content-Type":"multipart/form-data;boundary = "+(new Date).getTime()},httpAgent:new n.Agent({keepAlive:!0}),onUploadProgress:function(e){var t=e.loaded/e.total*100|0,a=parseInt(t);i(a)}}).then(function(){e(0)}).catch(function(){i(-100),e(1)})},500)})},createSendUserSetting:function(){for(var e="",t=0;t<this.settingTable.multipleSelection.length;t++)e+=this.settingTable.multipleSelection[t].id+"_";return e},printUserSetting:function(){var e=this;this.$axios({url:"/user/setting/senduser",method:"get"}).then(function(t){e.settingTable.body=t.ctt}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},handleEditSendUser:function(e){var t=this;this.settingTable.settingDetailTable.visible=!0,this.settingTable.settingDetailTable.isNew=!0,e&&(this.settingTable.settingDetailTable.data.id=e.id,this.settingTable.settingDetailTable.data.name=e.name,this.settingTable.settingDetailTable.isNew=!1,this.$axios({url:"/user/setting/"+e.id+"/detail",method:"get"}).then(function(e){t.selectedTable.body=e.ctt}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)}))},handleCloseSendUser:function(){this.settingTable.settingDetailTable.data.id=0,this.settingTable.settingDetailTable.data.name="",this.memberTable.body=[],this.memberTable.selected=null,this.selectedTable.body=[],this.selectedTable.selected=null,this.settingTable.settingDetailTable.visible=!1},handleSaveSendUser:function(){var e=this;if(this.settingTable.settingDetailTable.data.name.trim())if(new RegExp("[/:*?'\"<>|\\\\]").test(this.settingTable.settingDetailTable.data.name.trim()))this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|");else if(this.selectedTable.body&&0!==this.selectedTable.body.length){for(var t=[],a=0;a<this.selectedTable.body.length;a++)t.push({code:this.selectedTable.body[a].id,value:this.selectedTable.body[a].name});this.settingTable.submit={id:this.settingTable.settingDetailTable.data.id,name:this.settingTable.settingDetailTable.data.name,kind:"senduser",status:1,details:t};var i="",s="";this.settingTable.settingDetailTable.isNew?(i="确认新增["+this.settingTable.submit.name+"]用户组吗?",s="post"):(i="确认编辑["+this.settingTable.submit.name+"]用户组吗?",s="put"),this.$confirm(i,"提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.$axios({url:"/user/setting",method:s,data:e.settingTable.submit}).then(function(t){0===t.c?e.$message.success("新增用户组成功！"):e.$message.error(t.msg),e.printUserSetting(),e.handleCloseSendUser()})}).catch(function(){})}else this.$message.error("请选择用户组成员！");else this.$message.error("请输入用户组名称！")},handleDeleteSendUser:function(e){var t=this;this.$confirm("确认删除该用户组?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var a=Object.assign({},e);t.$axios({url:"/user/setting",method:"delete",data:a}).then(function(e){0===e.c?t.$message({message:"用户组已删除",type:"success"}):t.$message.error(e.msg),t.printUserSetting()})}).catch(function(){})},printDept:function(){var e=this;this.deptTree.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),e.deptTree.data=a,e.deptTree.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},selectDept:function(e){this.deptTree.selected=e,this.printUser(e),this.selectedTable.changeSelectedDept=!0},printUser:function(e){var t=this;this.memberTable.loading=!0,this.$axios({url:"/admin/dept/"+e.id+"/users/"+this.paginationData.curPage+"-"+this.paginationData.pageSize,method:"get"}).then(function(e){t.memberTable.body=e.ctt.list,t.paginationData.total=e.ctt.total,t.memberTable.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},addUserToGroup:function(e){for(var t=0;t<this.selectedTable.body.length;t++)if(this.selectedTable.body[t].id===e.id)return void this.$message.warning("成员已在组内，不能再次添加！");this.selectedTable.body.push(e)},removeUserFromGroup:function(e){for(var t=0;t<this.selectedTable.body.length;t++)if(this.selectedTable.body[t].id===e.id)return void this.selectedTable.body.splice(t,1)},handleSelectionChange:function(e){this.settingTable.multipleSelection=e},checkFileSize:function(e){return e.size/1024/1024<=this.upload.size},folderValidate:function(e){if(0===e.length)return this.$message.error("选择的目录中没有发现有任何文件！"),!1;for(var t=0,a=0;a<e.length;a++)if(t+=e[a].data.size,!this.checkFileSize(e[a].data))return this.$message.error("上传文件大小不能超过 "+this.upload.size+"MB!  文件名："+e[a].name),!1;return!(t/1024/1024>1024)||(this.$message.error("上传文件的总大小不能超过1024MB! "),!1)}}},m=(a("k1At"),Object(r.a)(f,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.formFolder.title,visible:e.formFolder.visible,"close-on-click-modal":!1,width:"900px"},on:{"update:visible":function(t){e.$set(e.formFolder,"visible",t)}}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:14}},[a("div",{staticStyle:{"padding-bottom":"10px","font-style":"italic","font-size":"12px",color:"#999999"}},[e._v("为保证上传的稳定，整个目录大小请不要超过"+e._s(this.upload.size)+"MB")]),e._v(" "),e.folderClear?a("input",{ref:"folderSelect",staticStyle:{display:"none"},attrs:{id:"openFolder",type:"file",webkitdirectory:"",size:"0"},on:{change:function(t){t.stopPropagation(),e.onChangeStopProcess()}}}):e._e(),e._v(" "),a("el-button",{attrs:{type:"success",size:"small"},on:{click:e.handleOpenFolder}},[e._v("选择文件夹")]),e._v(" "),a("div",{staticStyle:{height:"10px"}}),e._v(" "),a("el-table",{staticClass:"custom-table-row",staticStyle:{width:"100%"},attrs:{data:e.formFolder.fileList,"show-header":!1,height:200}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("p",[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-progress",{attrs:{percentage:e.row.progress,status:-100===e.row.progress?"exception":100===e.row.progress?"success":""}})]}}])})],1)],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.settingTable.loading,expression:"settingTable.loading"}],ref:"settingTable",staticClass:"custom-table-cell",attrs:{data:e.settingTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",border:"",height:"300px"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"选择通知成员组"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",width:"90px"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增用户组",placement:"right"}},[a("el-button",{staticClass:"btnAdd",staticStyle:{float:"right",padding:"5px"},attrs:{type:"text",size:"mini",icon:"el-icon-circle-plus-outline",circle:""},on:{click:function(t){e.handleEditSendUser()}}})],1)]}},{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑用户组",placement:"right"}},[a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(a){e.handleEditSendUser(t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除用户组",placement:"right"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(a){e.handleDeleteSendUser(t.row)}}})],1)],1)]}}])})],1)],1)],1),e._v(" "),a("el-form",{ref:"formFolderData",attrs:{model:e.formFolder.data}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple-dark"},[a("P",{staticStyle:{"line-height":"50px",color:"#2F5A74","font-size":"16px"}},[e._v("上传目录：")])],1)]),e._v(" "),a("el-col",{attrs:{span:18}},[a("div",{staticClass:"grid-content bg-purple-dark"},[a("P",{staticStyle:{"line-height":"50px",color:"#E51C23","font-size":"20px"}},[e._v(e._s(e.formFolder.data.folderName))])],1)])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple-dark"},[a("el-form-item",{attrs:{label:"版本描述",prop:"comment"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.formFolder.data.comment,callback:function(t){e.$set(e.formFolder.data,"comment",t)},expression:"formFolder.data.comment"}})],1)],1)])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"通知用户组编辑",visible:e.settingTable.settingDetailTable.visible,modal:!1,width:"1000px"},on:{"update:visible":function(t){e.$set(e.settingTable.settingDetailTable,"visible",t)},open:e.printDept}},[a("el-form",{ref:"settingDetail",attrs:{model:e.settingTable.settingDetailTable.data,"label-width":"80px",rules:e.settingTable.settingDetailTable.rules}},[a("el-row",{staticStyle:{"min-height":"460px",height:"460px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"460px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTree.loading,expression:"deptTree.loading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptTree.data,"highlight-current":"",props:e.deptTree.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.selectDept},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:16}},[a("el-row",[a("el-form-item",{attrs:{"label-width":"120px",label:"编辑用户组名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.settingTable.settingDetailTable.data.name,callback:function(t){e.$set(e.settingTable.settingDetailTable.data,"name",t)},expression:"settingTable.settingDetailTable.data.name"}})],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTable.loading,expression:"memberTable.loading"}],ref:"memberTable",staticClass:"custom-table-cell",attrs:{data:e.memberTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",border:"",height:"400px"}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"增加成员",placement:"right"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"el-icon-d-arrow-right",circle:""},on:{click:function(a){e.addUserToGroup(t.row)}}})],1)],1)]}}])})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.selectedTable.loading,expression:"selectedTable.loading"}],ref:"selectedTable",staticClass:"custom-table-cell",attrs:{data:e.selectedTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",border:"",height:"400px"}},[a("el-table-column",{attrs:{prop:"name",label:"已选择用户"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除成员",placement:"right"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-yonghushanchu",circle:""},on:{click:function(a){e.removeUserFromGroup(t.row)}}})],1)],1)]}}])})],1)],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSaveSendUser()}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.handleCloseSendUser()}}},[e._v("关闭")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.formFolder.loading},nativeOn:{click:function(t){return e.handleUploadFolderSubmit(t)}}},[e._v("上传")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formFolder.visible=!1}}},[e._v("关闭")])],1)],1)],1)},[],!1,null,null,null).exports),p=a("gCzg"),h=a("r/9I"),g={name:"SortFolder",props:{sorted:{type:Function,default:null}},data:function(){return{formSort:{data:{},visible:!1,isSorted:!1},folderTable:{loading:!1,body:[],height:0,pageSize:20,total:0,curPage:0,multipleSelection:[]},selectFolder:""}},methods:{handleSort:function(e){this.selectFolder=e,this.formSort.visible=!0,this.formSort.isSorted=!1,this.refresh()},tableHeight:function(){this.folderTable.height=this.$refs.formSort.height},getData:function(){var e=this;this.selectFolder&&this.$axios({url:"/user/folder/"+this.selectFolder.id+"/children",method:"get"}).then(function(t){var a=[];if(e.selectFolder.permissionMap&&!e.selectFolder.permissionMap.visible)for(var i=0;i<t.ctt.length;i++)t.ctt[i].permissionMap.visible&&a.push(t.ctt[i]);else a=t.ctt;a.forEach(function(e){null===e.disabled&&(e.disabled=!1)}),e.folderTable.body=a,e.folderTable.total=t.ctt.total,e.folderTable.loading=!1,e.$nextTick(function(){e.tableHeight()})}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},refresh:function(){this.folderTable.total=0,this.folderTable.body=[],this.folderTable.curPage=0,this.getData()},handleUpMove:function(e,t){if(0!==e){var a=t,i=this.folderTable.body[e-1];this.folderTable.body[e]=i,this.folderTable.body[e-1]=a,this.$refs.table.setCurrentRow(null),this.moveSubmit(t.id,"/user/folder/up")}},handleDownMove:function(e,t){if(e!==this.folderTable.body.length-1){var a=t,i=this.folderTable.body[e+1];this.folderTable.body[e]=i,this.folderTable.body[e+1]=a,this.$refs.table.setCurrentRow(null),this.moveSubmit(t.id,"/user/folder/down")}},moveSubmit:function(e,t){var a=this;this.$axios({url:t,method:"put",data:{id:e}}).then(function(e){a.formSort.isSorted=!0,0===e.c||a.$message.error(e.msg)})},handleFolderHide:function(e,t){var a=void 0;!0===t.disabled?(t.disabled=!1,a="/user/folder/display"):(t.disabled=!0,a="/user/folder/disabled"),this.moveSubmit(t.id,a)},formClose:function(){this.formSort.isSorted&&location.reload()}}},b=(a("qsM7"),Object(r.a)(g,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"文件夹排序",visible:e.formSort.visible,"close-on-click-modal":!0,width:"500px"},on:{"update:visible":function(t){e.$set(e.formSort,"visible",t)},close:e.formClose}},[a("el-form",{ref:"formSort",attrs:{model:e.formSort.data,"label-width":"120px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.folderTable.loading,expression:"folderTable.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{height:"300px",data:e.folderTable.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"}}},[a("el-table-column",{attrs:{prop:"name",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.permissionMap.read?a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:" javascript:void(0) "},on:{click:function(a){e.handleClickFolder(t.$index,t.row)}}},[a("b",[e._v(e._s(t.row.name))])])],1):a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.name))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-caret-top",circle:""},on:{click:function(a){e.handleUpMove(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-caret-bottom",circle:""},on:{click:function(a){e.handleDownMove(t.$index,t.row)}}}),e._v(" "),!1===t.row.disabled?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"隐藏文件夹",placement:"bottom"}},[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-view",circle:""},on:{click:function(a){e.handleFolderHide(t.$index,t.row)}}})],1):e._e(),e._v(" "),!0===t.row.disabled?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"显示文件夹",placement:"bottom"}},[a("el-button",{staticStyle:{color:"grey"},attrs:{type:"text",size:"mini",icon:"el-icon-view",circle:""},on:{click:function(a){e.handleFolderHide(t.$index,t.row)}}})],1):e._e()]}}])})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.formSort.visible=!1}}},[e._v("关闭")])],1)],1)},[],!1,null,"53fb927a",null).exports),v={name:"PasswordExceed",data:function(){return{formPassword:{visible:!1,loading:!1},docIndexView:null}},methods:{updatePassword:function(){this.docIndexView&&this.docIndexView.updatePassword(),this.formPassword.visible=!1},showPasswordExceedMsg:function(e){this.docIndexView=e,this.formPassword.visible=!0},closeRemind:function(){var e=this;this.formPassword.loading=!0,this.$axios({url:"/settings/updatePasswordRemind",method:"post"}).then(function(t){0===t.c?(e.$message.success("设置成功"),e.formPassword.visible=!1):e.$message.error(t.msg),e.formPassword.loading=!1})}}},y=(a("f46f"),Object(r.a)(v,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"安全提醒",visible:e.formPassword.visible,"close-on-click-modal":!0,width:"500px"},on:{"update:visible":function(t){e.$set(e.formPassword,"visible",t)}}},[a("div",[e._v("您的密码已超出安全期限，是否修改密码？")]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger",loading:e.formPassword.loading},nativeOn:{click:function(t){return e.closeRemind(t)}}},[e._v("不再提示")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.formPassword.loading},nativeOn:{click:function(t){return e.updatePassword(t)}}},[e._v("去修改")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formPassword.visible=!1}}},[e._v("取消")])],1)])},[],!1,null,"dafb22ca",null).exports),x=a("L2JU"),_=a("p46w"),w=a.n(_),k=a("Fvx+"),C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},$={components:{Password:k.a,editFolder:d.a,uploadFolder:m,uploadFile:u.a,linkFile:p.a,preview:h.a,sortFolder:b,PasswordExceed:y,UploadResource:c,PreviewDatabase:n.a},data:function(){return{viewImageUrl:this.$upload+"/setting/getLogoImg?seed=",folderClear:!0,folderHeader:{selfId:0,selfFileCount:0,selfFolderCount:0,size:this.$maxFileSize,item:[{id:0,name:"",data:null}]},folderTable:{loading:!1,body:[],height:0,pageSize:100,total:0,curPage:0,multipleSelection:[],sort:{prop:"",order:""}},rankList:[{name:"创建时间",value:"createdate"},{name:"修改时间",value:"lastupdatedate"},{name:"作者姓名",value:"rankAuthor"},{name:"文献名称",value:"name"},{name:"文献来源",value:"rankSource"}],rankField:"createdate",sort:"DESC",searchTxt:"",isShowAll:!1,isaa:!1,activeCollapse:[]}},mounted:function(){var e=this;this.tableColumnWidth();var t=JSON.parse(localStorage.getItem("applyTableColSort"));t&&(["name","lastUpdateDate","lastUpdateUserName"].indexOf(t[0])>-1?this.folderTable.sort={prop:t[0],order:t[1]}:localStorage.removeItem("applyTableColSort")),"true"===w.a.get("passwordExceed")&&(this.$refs.myPasswordExceed.showPasswordExceedMsg(this),w.a.set("passwordExceed",!1)),s.a.$on("refreshHome",function(){e.refresh()}),s.a.$on("search",function(t){e.searchTxt=t,e.search()}),s.a.$on("breadcrumbClick",function(t){e.breadcrumbClick(t)})},computed:{selectFolder:function(){return this.$store.state.selectFolder}},watch:{selectFolder:function(){this.refresh()}},methods:C({},Object(x.b)({preFolderAction:"folderHistory/preFolder",nextFolderAction:"folderHistory/nextFolder",addHis:"folderHistory/addFolder",addHisById:"folderHistory/addFolderById"}),{getBrowser:function(){var e=navigator.userAgent,t=e.indexOf("Opera")>-1;return t?"Opera":e.indexOf("Firefox")>-1?"FF":e.indexOf("Chrome")>-1?"Chrome":e.indexOf("Safari")>-1?"Safari":e.indexOf("Trident")>-1?"Edge":e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t?"IE":void 0},tableHeight:function(){this.$nextTick(function(){this.folderTable.height=window.innerHeight-this.$refs.table.$el.offsetTop-60;var e=this;window.onresize=function(){e.folderTable.height=window.innerHeight-e.$refs.table.$el.offsetTop-60}})},tableColumnWidth:function(){this.$nextTick(function(){var e=localStorage.getItem("applyTableColWidths");if(e&&void 0!=this.$refs.table)for(var t=0;t<this.$refs.table.columns.length;t++)this.$refs.table.columns[t].width=JSON.parse(e)[t]})},colChange:function(e,t,a,i){var s=this;setTimeout(function(){console.log(e,t,a,i);for(var n=[],o=s.$refs.table,l=0;l<o.columns.length;l++)n.push(o.columns[l].width);console.log(n),localStorage.setItem("applyTableColWidths",JSON.stringify(n))},100)},labelHead:function(e,t){var a=t.column,i=(t.index,a.label.length);return a.minWidth=16*i,e("div",{class:"table-head",style:{width:"100%"}},[a.label])},sortChange:function(e,t,a){console.log(e+"-"+e.prop+"-"+e.order),localStorage.removeItem("applyTableColSort");var i=[];i.push(e.prop),i.push(e.order),localStorage.setItem("applyTableColSort",JSON.stringify(i)),this.folderTable.sort={prop:e.prop,order:e.order},this.refresh()},getHeader:function(e){var t=this;this.selectFolder&&1===this.folderTable.curPage&&this.$axios({url:"/user/folder/"+this.selectFolder.id,method:"get"}).then(function(e){if(0===e.c){for(var a=e.ctt.fullName.split("/"),i=e.ctt.fullPath.split("/"),n=[],o=0;o<i.length;o++){var l={id:parseInt(i[o]),name:a[o]};n.push(l)}t.folderHeader.selfId=e.ctt.id,t.folderHeader.selfFileCount=e.ctt.files.length,t.folderHeader.selfFolderCount=e.ctt.children.length,t.folderHeader.size=e.ctt.fileSize,t.folderHeader.item=n}else t.folderHeader.name.push("取得文件夹信息失败");s.a.$emit("setFolderHeader",t.folderHeader)}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},rank:function(){"ASC"===this.sort?this.sort="DESC":this.sort="ASC",this.refresh()},getData:function(e){var t=this;if(this.selectFolder){var a=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.1)"});this.$axios({url:"/user/folder/"+this.selectFolder.id+"/docs/"+this.folderTable.curPage+"-"+this.folderTable.pageSize+"?column="+this.folderTable.sort.prop+"&&order="+this.folderTable.sort.order+"&rankField="+this.rankField+"&sort="+this.sort,method:"get"}).then(function(s){if(0===s.c){var n=[];if(t.selectFolder.permissionMap&&!t.selectFolder.permissionMap.visible)for(var o=0;o<s.ctt.list.length;o++)!1===t.isShowAll&&!0===s.ctt.list[o].disabled||s.ctt.list[o].permissionMap.visible&&n.push(s.ctt.list[o]);else for(var l=0;l<s.ctt.list.length;l++)!1===t.isShowAll&&!0===s.ctt.list[l].disabled||s.ctt.list[l].permissionMap.visible&&n.push(s.ctt.list[l]);n.forEach(function(e){null===e.disabled&&(e.disabled=!1)}),t.folderTable.body=t.folderTable.body.concat(n),t.folderTable.body=t.folderTable.body.map(function(e){var t=[],a=!1,s=[],n=null,o="",l=e.checked||!1;if(e.fileAccessoryDto){s=e.fileAccessoryDto.filter(function(e){return 2!==e.type});var r=e.fileAccessoryDto.find(function(e){return 2===e.type});r&&(a=!0,n=r.saveId,o=r.name)}return e.fileMetadataDto&&(t=e.fileMetadataDto.map(function(e){var t=e.value;return 7===e.dataType&&e.value&&(t=Object(i.formatDateTime)(e.value,"年月日")),6===e.dataType&&(t="true"===e.value?"是":"否"),{title:e.name,content:t}})),C({},e,{expandData:t,hasDatabase:a,dbId:n,appendFiles:s,checked:l,dbName:o})}),t.folderTable.total=s.ctt.total,t.folderTable.loading=!1,0===s.ctt.list.length?e&&e.complete():e&&e.loaded(),t.$nextTick(function(){}),!1===t.isaa&&(t.isaa=!0),a.close()}else t.$message.error(s.msg),t.folderTable.loading=!1,a.close()}).catch(function(e){console.log(e),t.$message.error("获取数据失败，失败码："+e.response.status),a.close()})}},refresh:function(){this.folderTable.total=0,this.folderTable.body=[],this.folderTable.curPage=0,this.$refs.infinite.stateChanger.reset()},handleSelectionChange:function(e){this.folderTable.multipleSelection=e},dateShortFormat:function(e){return e?this.$moment(e).format("MM月DD日 HH:mm"):""},dateFormat:function(e){return e?this.$moment(e).format("YYYY年MM月DD日 HH:mm"):""},handleClickFolder:function(e,t){this.$router.push("/home"),this.addHis(t),this.$store.state.selectFolder=t,this.$store.commit("setSelectFolder",t)},handleAddFolder:function(){this.$refs.editFolder.handleAddFolder(this.selectFolder)},handleCommand:function(e){switch(e){case"fileOpen":this.handleUploadFile();break;case"folderOpen":this.handleUploadFolder();break;case"open":this.handleUploadResource("create")}},handleReName:function(e,t){this.$refs.editFolder.handleEditFolder(this.selectFolder,t)},handleDeleteSubmit:function(e,t){this.$refs.editFolder.handleDeleteSubmit(t)},addFolder:function(e){this.refresh(),this.$emit("lay_addFolder",e)},renameFolder:function(e){var t=void 0;this.folderTable.body.forEach(function(a){a.id===e.id&&a.kind===e.kind&&(t=a)}),t&&(t.name=e.name,this.refresh()),"folder"===e.kind&&this.$emit("lay_putFolder",e)},deleteFolder:function(e){this.refresh(),"folder"===e.kind&&this.$emit("lay_delFolder",e)},deleteFolders:function(e){this.refresh();for(var t=0;t<e.length;t++)"folder"===e[t].kind&&this.$emit("lay_delFolder",e[t])},handleUploadFolder:function(){this.$refs.uploadFolder.handleUploadFolder(this.selectFolder,this.folderHeader.size)},handleUploadFile:function(){this.$refs.uploadFile.handleUploadFile(this.selectFolder,this.folderTable.body,this.folderHeader.size)},handleEditFile:function(e,t){20===t.docType?(this.$refs.uploadResource.types="edit",this.$refs.uploadResource.editData=t,this.$refs.uploadResource.folderId=this.selectFolder.id,this.$refs.uploadResource.visible=!0):this.$refs.uploadFile.handleEditFile(t,this.selectFolder)},handleDownloadSubmit:function(e,t){this.$refs.uploadFile.handleDownloadSubmit(t)},handleDownloadResource:function(e){var t=this;this.$confirm("开始下载吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){t.$axios({url:"user/file/"+e.saveId+"/download",method:"get",responseType:"blob"}).then(function(a){if(a){var i=new Blob([a]),s=e.name+"."+e.suffix;if("download"in document.createElement("a")){var n=document.createElement("a");n.download=s,n.style.display="none",n.href=URL.createObjectURL(i),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else console.log(i),navigator.msSaveBlob(i,s)}else t.$message({message:"下载失败",type:"error"})})})},handleAddLink:function(){var e=this.folderTable.body.filter(function(e){return e.checked});this.$refs.linkFile.handleAddLink(e)},handleMultiDeleteSubmit:function(){var e=this.folderTable.body.filter(function(e){return e.checked});this.$refs.editFolder.handleMultiDeleteSubmit(e)},handleHistory:function(e,t){this.$refs.preview.handleHistory(t)},handlePreview:function(e,t){"file"!==t.kind&&this.$refs.preview.handlePreview(t)},search:function(){this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):this.$router.push({path:"/search",query:{searchKey:this.searchTxt}}):this.$message.success("请输入搜索关键词")},nextPage:function(e){this.folderTable.curPage+=1,this.getData(e),this.getHeader(e)},showAllChange:function(){this.refresh()},breadcrumbClick:function(e){this.selectFolder.id!==e.id&&this.addHisById(e.id)},updatePassword:function(){this.$refs.myPassword.handlePassword()},rowClicked:function(e){"folder"!==e.kind&&this.$refs.table.toggleRowExpansion(e)},handleClickFile:function(e){20===e.docType?this.handleCollapse(e):this.$refs.preview.handlePreview(e)},handlePreviewAppendFile:function(e,t){var a=C({},e,{nextId:t});this.$refs.preview.handlePreview(a)},stopProp:function(e){e.stopPropagation()},handleCollapse:function(e){20===e.docType&&(this.activeCollapse.includes(e.key)?this.activeCollapse=this.activeCollapse.filter(function(t){return t!==e.key}):this.activeCollapse.push(e.key))},handleUploadResource:function(e){this.$refs.uploadResource.visible=!0,this.$refs.uploadResource.types=e,this.$refs.uploadResource.folderId=this.selectFolder.id,this.$refs.uploadResource.upload.size=this.folderHeader.size},handleOpenReviewDB:function(e){this.$refs.previewDatabase.dbId=e.dbId,this.$refs.previewDatabase.visible=!0}})},S=(a("K0e7"),Object(r.a)($,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"fxb",staticStyle:{padding:"10px 0px 10px 0px","background-color":"#FAFAFA"}},[this.selectFolder?a("div",{staticClass:"fx-lr pd5"},[this.selectFolder.permissionMap.new?a("el-dropdown",{staticClass:"plr10",on:{command:e.handleCommand}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.handleUploadResource("create")}}},[a("svg",{staticClass:"icon",staticStyle:{width:"1.2rem",height:"1rem"},attrs:{t:"1615781333955",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"15073"}},[a("path",{attrs:{d:"M826 548.9c-22 0-40 18-40 40v200H236v-202c0-22-18-40-40-40s-40 18-40 40v242c0 22 18 40 40 40h630c22 0 40-18 40-40v-240c0-22-18-40-40-40z","p-id":"15074",fill:"#ffffff"}}),a("path",{attrs:{d:"M273.1 489.6h128.5v156.3c0 38.4 31.2 69.6 69.6 69.6h80c38.4 0 69.6-31.2 69.6-69.6V489.6h128.1c22.7 0 41.1-18.4 41.1-41.1 0-10.5-3.9-20.1-10.4-27.3l0.3-0.3-239-239-0.1 0.1c-7.4-7.5-17.8-12.2-29.2-12.2-12.8 0-24.2 5.8-31.7 14.9L250.2 414.4c-10.9 7.4-18.1 19.9-18.1 34.1 0 22.7 18.3 41.1 41 41.1z","p-id":"15075",fill:"#ffffff"}})]),e._v("\n                            文献上传\n                        ")]),e._v(" "),"IE"!==e.getBrowser()&&"Edge"!==e.getBrowser()?a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{icon:"el-icon-upload",command:"open"}},[e._v("文献上传")]),e._v(" "),a("el-dropdown-item",{attrs:{icon:"el-icon-upload",command:"fileOpen"}},[e._v("资源上传")])],1):e._e()],1):e._e(),e._v(" "),a("div",{staticClass:"plr10 buttonBox"},[this.selectFolder.permissionMap.new?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleAddFolder}},[a("svg",{staticClass:"icon",staticStyle:{width:"1.2rem",height:"1rem"},attrs:{t:"1615780650144",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1802",width:"200",height:"200"}},[a("path",{attrs:{d:"M874.24 150.016C777.6 53.376 648.96 0.256 512 0.256s-265.6 53.12-362.24 149.76c-199.68 199.68-199.68 524.16 0 723.84 96.64 96.64 225.28 149.76 362.24 149.76s265.6-53.12 362.24-149.76c96.64-96.64 149.76-224.64 149.76-361.6s-53.12-265.6-149.76-362.24z m-72.32 652.16c-77.44 76.8-180.48 119.68-289.92 119.68-109.44 0-212.48-42.88-289.92-119.68-160-160-160-419.84 0-579.2 77.44-77.44 180.48-119.68 289.92-119.68 109.44 0 212.48 42.88 289.92 119.68 77.44 77.44 119.68 180.48 119.68 289.92 0 109.44-42.88 211.84-119.68 289.28z m-85.12-341.12h-153.6v-153.6c0-28.16-23.04-51.2-51.2-51.2s-51.2 23.04-51.2 51.2v153.6h-153.6c-28.16 0-51.2 23.04-51.2 51.2s23.04 51.2 51.2 51.2h153.6v153.6c0 28.16 23.04 51.2 51.2 51.2s51.2-23.04 51.2-51.2v-153.6h153.6c28.16 0 51.2-23.04 51.2-51.2s-23.04-51.2-51.2-51.2z","p-id":"1803",fill:"#29A5FA"}})]),e._v("\n                            新建文件夹\n                        ")]):e._e(),e._v(" "),this.selectFolder.permissionMap.link?a("el-button",{staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"},on:{click:e.handleAddLink}},[a("svg",{staticClass:"icon",staticStyle:{width:"1.2rem",height:"1rem"},attrs:{t:"1615783875077",viewBox:"0 0 1027 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"36773",width:"200",height:"200"}},[a("path",{attrs:{d:"M734.72 964.48H106.24a103.04 103.04 0 0 1-103.04-103.04V225.28A103.04 103.04 0 0 1 106.24 121.6h409.6a51.84 51.84 0 0 1 0 103.68h-409.6v636.16h628.48V576a51.84 51.84 0 1 1 103.04 0v287.36a103.04 103.04 0 0 1-103.04 101.12zM847.36 450.56l179.84-195.84-92.16-94.08-87.68-89.6v379.52z","p-id":"36774",fill:"#29A5FA"}}),a("path",{attrs:{d:"M542.08 618.24H438.4a409.6 409.6 0 0 1 408.96-408.96v103.68a305.92 305.92 0 0 0-305.28 305.28z","p-id":"36775",fill:"#29A5FA"}})]),e._v("\n                            分享\n                        ")]):e._e(),e._v(" "),this.selectFolder.permissionMap.delete?a("el-button",{staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"},on:{click:e.handleMultiDeleteSubmit}},[a("svg",{staticClass:"icon",staticStyle:{width:"1.2rem",height:"1rem"},attrs:{t:"1615781143926",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"12292"}},[a("path",{attrs:{d:"M356.5 202l48.3-96.6c2.2-4.4 6.7-7.2 11.6-7.2h191.5c4.9 0 9.4 2.8 11.6 7.2l48.3 96.6h142.7c7.2 0 13 5.8 13 13v77.8c0 7.2-5.8 13-13 13H213.8c-7.2 0-13-5.8-13-13V215c0-7.2 5.8-13 13-13h142.7z m-90.8 155.6h492.9c7.2 0 13 5.8 13 13v505.8c0 28.7-23.2 51.9-51.9 51.9h-415c-28.7 0-51.9-23.2-51.9-51.9V370.6c-0.1-7.2 5.7-13 12.9-13z m142.6 181.6v207.5c0 14.3 11.6 25.9 25.9 25.9 14.3 0 25.9-11.6 25.9-25.9V539.2c0-14.3-11.6-25.9-25.9-25.9-14.2 0-25.9 11.6-25.9 25.9z m155.7 0v207.5c0 14.3 11.6 25.9 25.9 25.9 14.3 0 25.9-11.6 25.9-25.9V539.2c0-14.3-11.6-25.9-25.9-25.9-14.3 0-25.9 11.6-25.9 25.9z","p-id":"12293",fill:"#29A5FA"}})]),e._v("\n                            删除\n                        ")]):e._e()],1),e._v(" "),e.folderHeader?a("div",{staticClass:"fxr"},[a("span",{staticStyle:{color:"#DEBF8B","font-size":"12px","margin-right":"30px"}},[e._v("上传限制："),a("b",[e._v(e._s(e.folderHeader.size)+"MB")])]),e._v(" "),a("span",{staticStyle:{color:"#A8B0B5","font-size":"12px"}},[e._v("文件夹数："),a("b",[e._v(e._s(e.folderHeader.selfFolderCount)+"  ")]),e._v(" 文件数："),a("b",[e._v(e._s(e.folderHeader.selfFileCount))])])]):e._e()],1):e._e(),e._v(" "),a("div",{staticClass:"fxc pdr20"},[a("div",{staticClass:"fxl mr20"},[a("el-select",{staticStyle:{width:"120px",height:"30px"},attrs:{size:"mini"},on:{change:e.refresh},model:{value:e.rankField,callback:function(t){e.rankField=t},expression:"rankField"}},e._l(e.rankList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),e._v(" "),a("div",{staticClass:"fx-lr-c finger",staticStyle:{border:"1px solid #0099FF",padding:"2px",width:"1.6rem","border-radius":"4px","margin-left":"6px"},on:{click:function(t){e.rank()}}},["ASC"==e.sort?a("svg",{staticClass:"icon",staticStyle:{width:"1.2rem",height:"1.2rem"},attrs:{t:"1617770647367",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4747"}},[a("path",{attrs:{d:"M771.104 331.584v435.968a30.944 30.944 0 0 1-9.6 22.912c-6.304 6.08-14.944 9.536-24 9.536-18.624-0.32-33.568-14.784-33.568-32.448V331.584L569.632 458.88a33.792 33.792 0 0 1-23.84 9.664c-9.024 0-17.632-3.488-23.872-9.664a31.008 31.008 0 0 1-9.92-22.592c0-8.512 3.584-16.64 9.92-22.592L712 233.568c6.176-6.08 14.656-9.504 23.52-9.536 8.896-0.32 17.568 2.624 24.192 8.256l190.08 180.128A30.4 30.4 0 0 1 960 435.008a30.4 30.4 0 0 1-10.24 22.592 34.56 34.56 0 0 1-23.84 9.408 34.56 34.56 0 0 1-23.84-9.408L771.104 331.584zM88.864 736h398.24c13.76 0 24.896 14.176 24.896 31.68 0 17.504-11.136 31.68-24.896 31.68H88.896C75.136 799.36 64 785.184 64 767.68 64 750.176 75.136 736 88.896 736z m1.792-256h266.688c14.72 0 26.656 14.176 26.656 31.68 0 17.504-11.936 31.68-26.656 31.68H90.656C75.936 543.36 64 529.184 64 511.68 64 494.176 75.936 480 90.656 480z m396.48-256H88.864C75.136 224 64 238.176 64 255.68c0 17.504 11.136 31.68 24.896 31.68h398.208c13.76 0 24.896-14.176 24.896-31.68 0-17.504-11.136-31.68-24.896-31.68z",fill:"#29A5FA","p-id":"4748"}})]):e._e(),e._v(" "),"DESC"==e.sort?a("svg",{staticClass:"icon",staticStyle:{width:"1.2rem",height:"1.2rem"},attrs:{t:"1617770718141",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4940"}},[a("path",{attrs:{d:"M843.84 690.368V256.32a31.488 31.488 0 0 0-9.152-22.848 32.192 32.192 0 0 0-22.912-9.472 32.512 32.512 0 0 0-32 32.32v434.048l-128.192-126.72a31.552 31.552 0 0 0-45.44 0 31.488 31.488 0 0 0 0 44.928l181.312 179.328a31.552 31.552 0 0 0 22.4 9.536 32.896 32.896 0 0 0 23.04-8.32l181.376-179.2a30.912 30.912 0 0 0 0-45.056 32.192 32.192 0 0 0-45.504 0l-124.928 125.44zM32 730.88h512.512c17.728 0 32.064 14.208 32.064 31.68a31.872 31.872 0 0 1-32 31.68H32a31.872 31.872 0 0 1-32-31.68c0-17.472 14.336-31.68 32-31.68z m0-253.44h320.32c17.728 0 32 14.208 32 31.68a31.872 31.872 0 0 1-32 31.68H32.064A31.872 31.872 0 0 1 0 509.12c0-17.472 14.336-31.68 32-31.68zM544.576 224H32.064c-17.728 0-32 14.208-32 31.68s14.272 31.68 32 31.68h512.512c17.728 0 32-14.208 32-31.68a31.872 31.872 0 0 0-32-31.68z",fill:"#29A5FA","p-id":"4941"}})]):e._e()])],1),e._v(" "),a("div",{staticClass:"finger",on:{click:e.refresh}},[a("svg",{staticClass:"icon",staticStyle:{"margin-right":"4px"},attrs:{t:"1615544331757",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"11287",width:"200",height:"200"}},[a("path",{attrs:{d:"M900.13268 352.212595c-17.746424-30.688359-56.998953-41.124182-87.436598-23.438133-30.621843 17.622603-41.119065 56.748239-23.43404 87.373152 27.935627 48.373384 42.685769 103.682835 42.685769 159.868247 0 176.434783-143.558565 319.990278-319.991302 319.990278-176.43069 0-319.985162-143.555495-319.985162-319.990278 0-176.43069 143.554472-319.988232 319.985162-319.988232 0.099262 0 0.198524 0.00307 0.297786 0.00307 0.046049 38.789987 0.079819 68.711879 0.079819 72.371273 0 30.746688-0.312113 55.621563 32.496566 55.621563 16.626912 0 31.561251-6.498085 42.312257-16.876602l0.24969 0.125868c0 0 167.056051-156.99374 174.992925-163.492849 4.005276-3.375934 5.689662-7.625784 5.563794-11.749766-0.064469-3.998113-1.745785-7.875475-4.749231-10.624114C757.072472 175.655013 585.889369 15.531959 585.889369 15.531959l-0.310066 0.25276c-10.685513-9.621259-25.124565-15.748903-41.125205-15.748903-32.809702 0-32.43312 24.875898-32.43312 55.622587 0 3.524316 0.03377 33.492257 0.079819 72.375367-0.049119 0-0.097215-0.001023-0.146335-0.001023-247.057202 0-447.980045 200.991406-447.980045 447.983115 0 246.993756 200.923867 447.984139 447.980045 447.984139 246.994779 0 447.988232-200.990382 447.988232-447.984139C959.943717 497.39517 939.25627 420.021905 900.13268 352.212595z","p-id":"11288"}})]),e._v(" "),a("span",[e._v(" 刷新")])])])])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0",staticStyle:{border:"none"},attrs:{id:"main_table"}},[e._l(e.folderTable.body,function(t,i){return a("div",{key:i,staticClass:"custom-search-table-cell doc-item-file-container"},[a("el-collapse",{ref:"collapsible",refInFor:!0,model:{value:e.activeCollapse,callback:function(t){e.activeCollapse=t},expression:"activeCollapse"}},["folder"===t.kind?a("div",[t.permissionMap.visible?a("div",[a("el-collapse-item",{attrs:{name:t.key}},[a("template",{slot:"title"},[a("div",{staticClass:"doc-item-file-title-container",on:{click:e.stopProp}},[a("div",{staticClass:"doc-item-file-title"},[a("div",{staticClass:"doc-item-file-title-main"},[a("el-checkbox",{model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"item.checked"}}),e._v(" "),a("app-svg",{staticStyle:{"font-size":"24px","margin-right":"4px"},attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("a",{staticStyle:{"margin-left":"5px","text-decoration-line":"none"},attrs:{href:"javascript:void(0)"},on:{click:function(a){e.handleClickFolder(i,t)}}},[a("b",[e._v(e._s(t.name))])])],1),e._v(" "),a("div",{staticClass:"doc-item-file-icon-list"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑文件夹",placement:"bottom"}},[t.permissionMap.modify?a("el-button",{staticClass:"btnEdit2",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-node",circle:""},on:{click:function(a){e.handleReName(i,t)}}}):e._e()],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除文件夹",placement:"bottom"}},[t.permissionMap.delete?a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"el-icon-close",circle:""},on:{click:function(a){e.handleDeleteSubmit(i,t)}}}):e._e()],1)],1)])])])],2)],1):a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.name))])],1),e._v(" "),a("div",[a("p",{domProps:{innerHTML:e._s(t.highLight)}})])]):a("div",[a("el-collapse-item",{attrs:{name:t.key}},[a("template",{slot:"title"},[a("div",{staticClass:"doc-item-file-title-container",on:{click:e.stopProp}},[a("div",{staticClass:"doc-item-file-title"},[a("div",{staticClass:"doc-item-file-title-main"},[[a("el-checkbox",{model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"item.checked"}}),e._v(" "),20===t.docType?a("img",{staticStyle:{width:"28px",height:"auto"},attrs:{src:e.viewImageUrl,alt:""}}):a("app-svg",{staticStyle:{"font-size":"20px"},attrs:{iconText:t.suffix}})],e._v(" "),a("a",{staticStyle:{"margin-left":"5px","text-decoration-line":"none","font-size":"14px"},attrs:{href:"javascript:void(0)"},on:{click:function(a){e.handleClickFile(t)}}},[20===t.docType?a("b",[e._v(e._s(t.name))]):a("b",[e._v(e._s(t.name)+"."+e._s(t.suffix))])]),e._v(" "),a("span",{staticStyle:{"padding-left":"20px","font-size":"12px"}},[t.hasDatabase?[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览数据库",placement:"bottom"}},[t.permissionMap.modify?a("el-button",{staticClass:"btnEdit1",staticStyle:{color:"gray"},attrs:{type:"text",size:"mini",icon:"iconfont icon-wenzhangpailie-",circle:""},on:{click:function(a){e.handleOpenReviewDB(t)}}}):e._e()],1)]:e._e()],2)],2),e._v(" "),a("div",{staticClass:"doc-item-file-icon-list"},[20!==t.docType?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载文件",placement:"bottom"}},[t.permissionMap.download?a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-caozuo-shangchuan-download",circle:""},on:{click:function(a){e.handleDownloadSubmit(i,t)}}}):e._e()],1):e._e(),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑文件路径和名称",placement:"bottom"}},[t.permissionMap.modify?a("el-button",{staticClass:"btnEdit1",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-file",circle:""},on:{click:function(a){e.handleReName(i,t)}}}):e._e()],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件更新",placement:"bottom"}},[t.permissionMap.update?a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-add-list",circle:""},on:{click:function(a){e.handleEditFile(i,t)}}}):e._e()],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件版本履历",placement:"bottom"}},[t.permissionMap.read?a("el-button",{staticClass:"btnEdit1",attrs:{type:"text",size:"mini",icon:"iconfont icon-wenzhangpailie-",circle:""},on:{click:function(a){e.handleHistory(i,t)}}}):e._e()],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件删除",placement:"bottom"}},[t.permissionMap.delete?a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"el-icon-close",circle:""},on:{click:function(a){e.handleDeleteSubmit(i,t)}}}):e._e()],1)],1)]),e._v(" "),a("div",{staticClass:"doc-item-file-content"},[a("div",{staticStyle:{padding:"5px"}},[a("p",{domProps:{innerHTML:e._s(t.highLight)}})]),e._v(" "),a("div",{staticStyle:{padding:"2px 0px 2px 40px"}},[a("p",{staticStyle:{"font-size":"12px",color:"#969896"}},[20===t.docType?a("span",{staticClass:"finger",domProps:{innerHTML:e._s(t.parentPathName)},on:{click:function(a){e.handleCollapse(t)}}}):e._e(),e._v(" "),10===t.docType?a("span",{domProps:{innerHTML:e._s(t.parentPathName)},on:{click:function(a){e.handleCollapse(t)}}}):e._e(),e._v(" "),a("span",{staticStyle:{"padding-left":"30px","font-size":"12px",color:"#969896"}},[e._v(e._s(e.dateShortFormat(t.lastUpdateDate)))]),e._v(" "),a("span",{staticStyle:{"padding-left":"10px","font-size":"12px",color:"#969896"}},[e._v(e._s(t.size))]),e._v(" "),a("span",{staticStyle:{"padding-left":"10px","font-size":"12px",color:"#969896"}},[e._v(e._s(t.lastUpdateUserName))])])])])])]),e._v(" "),a("div",{staticStyle:{"padding-left":"40px"}},[a("el-form",{staticClass:"doc-item-content-expand",attrs:{"label-position":"left",inline:""}},[e._l(t.expandData,function(t,i){return[a("el-form-item",{key:i,attrs:{label:t.title}},[a("span",[e._v(e._s(t.content))])])]})],2),e._v(" "),e._l(t.appendFiles,function(i,s){return a("div",{key:s,staticClass:"resource-file-list"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handlePreviewAppendFile(t,i.id)}}},[a("app-svg",{attrs:{iconText:i.suffix}}),e._v(" "),a("span",[e._v(e._s(i.name)+"."+e._s(i.suffix))])],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载文件",placement:"bottom"}},[t.permissionMap.download?a("el-button",{staticClass:"btnAdd",staticStyle:{"margin-left":"10px","margin-top":"8px"},attrs:{type:"text",size:"mini",icon:"iconfont icon-caozuo-shangchuan-download",circle:""},on:{click:function(t){e.handleDownloadResource(i)}}}):e._e()],1)],1)})],2)],2)],1)])],1)}),e._v(" "),a("infinite-loading",{ref:"infinite",on:{infinite:e.nextPage}},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],2),e._v(" "),a("edit-folder",{ref:"editFolder",attrs:{"add-folder":e.addFolder,"rename-folder":e.renameFolder,"delete-folder":e.deleteFolder,"delete-folders":e.deleteFolders}}),e._v(" "),a("upload-file",{ref:"uploadFile",attrs:{uploaded:e.refresh}}),e._v(" "),a("upload-folder",{ref:"uploadFolder",attrs:{uploaded:e.refresh}}),e._v(" "),a("upload-resource",{ref:"uploadResource"}),e._v(" "),a("link-file",{ref:"linkFile",attrs:{linked:e.refresh}}),e._v(" "),a("preview",{ref:"preview"}),e._v(" "),a("preview-database",{ref:"previewDatabase"}),e._v(" "),a("sort-folder",{ref:"sortFolder"}),e._v(" "),a("PasswordExceed",{ref:"myPasswordExceed"}),e._v(" "),a("Password",{ref:"myPassword"})],1)},[],!1,null,null,null));t.default=S.exports},Z4iQ:function(e,t,a){},"Z70/":function(e,t,a){"use strict";var i=a("nGH7");a.n(i).a},ZKo4:function(e,t,a){"use strict";var i=a("guNd");a.n(i).a},ZTAR:function(e,t,a){},ajjD:function(e,t,a){"use strict";a.r(t);var i={name:"EditSysAdmin",props:{addUser:{type:Function,default:null},editUser:{type:Function,default:null}},data:function(){return{formSysAdmin:{data:{folderId:0,folderName:"",userId:0,userName:"",deptId:0},visible:!1,loading:!1},deptTree:{data:[],props:{children:"children",label:"name"},loading:!1,selected:null},memberTable:{height:0,body:[],pageSize:1e3,total:0,curPage:1,loading:!1,selected:null},paginationData:{pageSize:1e3,total:0,curPage:1},adminName:""}},methods:{getDept:function(){var e=this;this.deptTree.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),e.deptTree.data=a,e.deptTree.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},deptSelect:function(e){this.deptTree.selected=e,this.getUser(e)},getUser:function(e){var t=this;this.memberTable.loading=!0,this.$axios({url:"/admin/dept/"+e.id+"/users/"+this.paginationData.curPage+"-"+this.paginationData.pageSize,method:"get"}).then(function(e){t.memberTable.body=e.ctt.list,t.paginationData.total=e.ctt.total,t.memberTable.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},memberSelect:function(e){this.memberTable.selected=e,this.formSysAdmin.data.userId=e.id,this.formSysAdmin.data.userName=e.name,this.formSysAdmin.data.deptId=this.deptTree.selected.id},handleAdminAdd:function(){this.formSysAdmin.data={folderId:0,folderName:"",deptId:0,userId:0,userName:""},this.formSysAdmin.visible=!0,this.$refs.formAddAdmin&&this.$refs.formAddAdmin.resetFields()},handleSysAdminSubmit:function(){var e=this;if(this.memberTable.selected){var t=this.memberTable.selected,a="确认把["+t.name+"]设置为系统管理员吗?";this.$confirm(a,"提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.$axios({url:"/admin/user/"+t.id+"/sysadmin",method:"put",data:t}).then(function(t){0===t.c?(e.$message.success("已设为系统管理员"),e.memberTable.selected=null,e.memberTable.body=[],e.formSysAdmin.loading=!1,e.formSysAdmin.visible=!1,e.editUser()):1013===t.c||1014===t.c?(e.$message.error(t.msg),e.formSysAdmin.loading=!1):(e.$message.error(t.msg),e.memberTable.selected=null,e.memberTable.body=[],e.formSysAdmin.loading=!1,e.formSysAdmin.visible=!1,e.editUser())})}).catch(function(){})}else this.$message.error("请选择系统管理员！")},handleSysAdminClose:function(){this.formSysAdmin.loading=!1,this.formSysAdmin.visible=!1,this.memberTable.body=[],this.memberTable.selected=null}}},s=(a("oPgD"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"新增系统管理员",visible:e.formSysAdmin.visible,"close-on-click-modal":!1,width:"700px"},on:{"update:visible":function(t){e.$set(e.formSysAdmin,"visible",t)},open:e.getDept}},[a("el-form",{ref:"formAddAdmin",attrs:{model:e.formSysAdmin.data,"label-width":"80px",rules:e.formSysAdmin.rules}},[a("el-row",{staticStyle:{"min-height":"400px",height:"400px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"400px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTree.loading,expression:"deptTree.loading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptTree.data,"highlight-current":"",props:e.deptTree.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.deptSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTable.loading,expression:"memberTable.loading"}],ref:"memberTable",staticClass:"custom-table-cell",attrs:{data:e.memberTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",height:"400px"},on:{"current-change":e.memberSelect}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new",loading:e.formSysAdmin.loading},nativeOn:{click:function(t){return e.handleSysAdminSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.handleSysAdminClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,"2606b9f1",null).exports,o={name:"EditFolderAdmin",props:{addUser:{type:Function,default:null},editUser:{type:Function,default:null}},data:function(){return{defaultKey:[1],formFolderAdmin:{data:{folderId:0,folderName:"",userId:0,userName:"",deptId:0},visible:!1,loading:!1},deptTree:{data:[],props:{children:"children",label:"name"},loading:!1,selected:null},memberTable:{height:0,body:[],pageSize:1e3,total:0,curPage:1,loading:!1,selected:null},folderTree:{visible:!1,loading:!1,props:{label:"name",children:"children"},body:[],selected:null},paginationData:{pageSize:1e3,total:0,curPage:1},adminName:""}},methods:{getData:function(){this.getDept()},printFolderTree:function(e,t){var a=this,i=void 0;i=0===e.level?0:e.data.id,this.folderTree.loading=!0,this.$axios({url:"/admin/folder/"+i+"/children",method:"get"}).then(function(e){t(e.ctt),a.folderTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},folderSelect:function(e){this.folderTree.selected=e,this.formFolderAdmin.data.folderId=e.id,this.formFolderAdmin.data.folderName=e.name},getDept:function(){var e=this;this.deptTree.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),e.deptTree.data=a,e.deptTree.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},deptSelect:function(e){this.deptTree.selected=e,this.getUser(e)},getUser:function(e){var t=this;this.memberTable.loading=!0,this.$axios({url:"/admin/dept/"+e.id+"/users/"+this.paginationData.curPage+"-"+this.paginationData.pageSize,method:"get"}).then(function(e){t.memberTable.body=e.ctt.list,t.paginationData.total=e.ctt.total,t.memberTable.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},memberSelect:function(e){this.memberTable.selected=e,this.formFolderAdmin.data.userId=e.id,this.formFolderAdmin.data.userName=e.name,this.formFolderAdmin.data.deptId=this.deptTree.selected.id},handleAdminAdd:function(){this.formFolderAdmin.data={folderId:0,folderName:"",deptId:0,userId:0,userName:""},this.formFolderAdmin.visible=!0,this.$refs.formAddAdmin&&this.$refs.formAddAdmin.resetFields()},handleFolderAdminSubmit:function(){var e=this;this.memberTable.selected?this.folderTree.selected?this.$confirm("确认添加文件夹管理员吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formFolderAdmin.loading=!0;var t=Object.assign({},e.formFolderAdmin.data);e.$axios({url:"/admin/folder/"+e.formFolderAdmin.data.folderId+"/admin",method:"put",data:t}).then(function(t){0===t.c?(e.$message.success("已设为文件夹管理员"),e.memberTable.selected=null,e.memberTable.body=[],e.folderTree.selected=null,e.formFolderAdmin.loading=!1,e.formFolderAdmin.visible=!1,e.editUser()):1013===t.c||1014===t.c?(e.$message.error(t.msg),e.formFolderAdmin.loading=!1):(e.$message.error(t.msg),e.memberTable.selected=null,e.memberTable.body=[],e.folderTree.selected=null,e.formFolderAdmin.loading=!1,e.formFolderAdmin.visible=!1,e.editUser())})}).catch(function(){}):this.$message.error("请选择文件夹！"):this.$message.error("请选择文件夹管理员！")},handleFolderAdminClose:function(){this.formFolderAdmin.loading=!1,this.formFolderAdmin.visible=!1,this.folderTree.selected=null,this.memberTable.body=[],this.memberTable.selected=null}}},l=(a("+a51"),Object(s.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"新增文件夹管理员",visible:e.formFolderAdmin.visible,"close-on-click-modal":!1,width:"1200px"},on:{"update:visible":function(t){e.$set(e.formFolderAdmin,"visible",t)},open:e.getData}},[a("el-form",{ref:"formAddAdmin",attrs:{model:e.formFolderAdmin.data,"label-width":"80px",rules:e.formFolderAdmin.rules}},[a("el-row",{staticStyle:{"min-height":"400px",height:"400px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"400px"}},[a("el-scrollbar",{staticStyle:{height:"400px"}},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTree.loading,expression:"deptTree.loading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptTree.data,"highlight-current":"",props:e.deptTree.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.deptSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTable.loading,expression:"memberTable.loading"}],ref:"memberTable",staticClass:"custom-table-cell",attrs:{data:e.memberTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",height:"400px"},on:{"current-change":e.memberSelect}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"400px"}},[a("el-scrollbar",{staticStyle:{height:"400px"}},[e.formFolderAdmin.visible?a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.folderTree.loading,expression:"folderTree.loading"}],ref:"folderTree",staticClass:"mr20",attrs:{accordion:!0,"highlight-current":!0,data:e.folderTree.body,props:e.folderTree.props,"default-expand-all":!1,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":e.defaultKey,lazy:"",load:e.printFolderTree},on:{"node-click":e.folderSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("b",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-wenjianjia"}})]),e._v(" "),a("b",[e._v(e._s(i.label))])])])}}])}):e._e()],1)],1)])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new",loading:e.formFolderAdmin.loading},nativeOn:{click:function(t){return e.handleFolderAdminSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.handleFolderAdminClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,"2ab27c12",null).exports),r=a("Gas7"),c={components:{EditSysAdmin:n,EditFolderAdmin:l,splitPane:a.n(r).a},name:"user",data:function(){return{splitClass:"",searchTxt:"",searchData:"",tableData:{height:0,loading:!0,body:[],pageSize:20,total:0,curPage:0},folderData:{loading:!1,body:[],pageSize:20,total:0,curPage:0}}},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.table.$el.offsetTop;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.table.$el.offsetTop}})},getData:function(e){var t=this;this.tableData.loading=this.$refs.infinite.isFirstLoad;var a=void 0;a=this.searchData?"/admin/search/users/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name="+this.searchData+"&islove=true":"/admin/adminusers/"+this.tableData.curPage+"-"+this.tableData.pageSize,this.$axios({url:a,method:"get"}).then(function(a){var i=[];i.push(a.ctt.list),i[0].length>0&&1===i[0][0].id&&(i[0][0].isRoot=!0),t.tableData.body=t.tableData.body.concat(a.ctt.list),t.tableData.total=a.ctt.total,t.tableData.loading=!1,0==a.ctt.list.length?e&&e.complete():e&&e.loaded(),t.$nextTick(function(){t.tableHeight()})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},nextPage:function(e){this.tableData.curPage+=1,this.getData(e)},handleSysAdminAdd:function(){this.$refs.editSysAdmin.handleAdminAdd()},handleFolderAdminAdd:function(){this.$refs.editFolderAdmin.handleAdminAdd()},handleUserDeleteSubmit:function(e,t){var a=this;this.$confirm("确认删除该用户的管理员权限?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e=Object.assign({},t.admin);a.$axios({url:"/admin/admin/"+e.id,method:"delete",data:e}).then(function(t){0===t.c?a.$message({message:"用户状态已更新",type:"success"}):a.$message.error(t.msg),a.refresh(),a.findFolderList(e.id)})}).catch(function(){})},search:function(){this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchData=this.searchTxt,this.refresh()):this.$message.success("请输入搜索关键词")},clearSearchTxt:function(){this.searchData="",this.refresh()},refresh:function(){this.tableData.total=0,this.tableData.body=[],this.tableData.curPage=0,this.$refs.infinite.stateChanger.reset(),this.folderData.total=0,this.folderData.body=[],this.folderData.curPage=0},onMouseDown:function(){this.$refs.split.active&&(this.splitClass="active")},onMouseUp:function(){this.$refs.split.active||(this.splitClass="")},getFolders:function(e,t){var a=0;a=null!==e?e.admin.id:t.admin.id,this.findFolderList(a)},findFolderList:function(e){var t=this;this.folderData.loading=!0,this.$axios({url:"/admin/userFolders/"+e,method:"get"}).then(function(e){t.folderData.body=e.ctt.list,t.folderData.total=e.ctt.total,t.folderData.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},deleteFolderByAdmin:function(e,t){var a=this;this.$confirm("确认删除该文件夹的管理员权限?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){a.folderData.loading=!0,a.$axios({url:"/admin/deleteFolderByAdmin/"+e,method:"delete"}).then(function(e){a.folderData.loading=!1,a.$message({message:"删除成功",type:"success"}),a.findFolderList(t)}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})}).catch(function(){})}}},d=(a("CVmM"),Object(s.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"guanlirenyuan"}}),e._v("  管理人员设定")],1)])]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline",plain:""},on:{click:e.handleSysAdminAdd}},[e._v("新增系统管理员")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline",plain:""},on:{click:e.handleFolderAdminAdd}},[e._v("新增文件夹管理员")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("split-pane",{ref:"split",attrs:{split:"vertical",className:e.splitClass,defaultPercent:70},nativeOn:{mousedown:function(t){return e.onMouseDown(t)},mouseup:function(t){return e.onMouseUp(t)}}},[a("template",{slot:"paneL"},[a("el-scrollbar",{directives:[{name:"show",rawName:"v-show",value:!e.searchData.isSearch,expression:"!searchData.isSearch"}]},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height},on:{"current-change":e.getFolders}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名",align:"left",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"departments",label:"用户组织",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.departments,function(t){return a("div",[1===t.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v("\n                                            "+e._s(t.name)+"\n                                        ")]):a("div",[1===t.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v("\n                                                "+e._s(t.name)+"\n                                            ")]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v("\n                                                "+e._s(t.name)+"\n                                            ")])])])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"管理目录","min-width":"50%"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.adminStatus?a("div",[a("span",[e._v("文件夹管理员")])]):a("div",[a("span",[e._v("系统管理员")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[8===t.row.status?a("div",[a("span",[e._v("离职")])]):4===t.row.status?a("div",[a("span",[e._v("账户封禁")])]):a("div",[a("span",[e._v("正常")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除管理员权限",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-yonghushanchu",circle:""},on:{click:function(a){e.handleUserDeleteSubmit(t.$index,t.row)}}})],1)],1)]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1)],1),e._v(" "),a("template",{slot:"paneR"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.folderData.loading,expression:"folderData.loading"}],ref:"folderTable",staticClass:"custom-table-cell",attrs:{data:e.folderData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height}},[a("el-table-column",{attrs:{prop:"folderName",label:"文件夹名称",align:"left",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia"}}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.folderName))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除管理员权限",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-yonghushanchu",circle:""},on:{click:function(a){e.deleteFolderByAdmin(t.row.id,t.row.adminId)}}})],1)],1)]}}])})],1)],1)],1)],2)],1),e._v(" "),a("edit-sys-admin",{ref:"editSysAdmin",attrs:{"add-user":e.refresh,"edit-user":e.refresh}}),e._v(" "),a("edit-folder-admin",{ref:"editFolderAdmin",attrs:{"add-user":e.refresh,"edit-user":e.refresh}})],1)},[],!1,null,"4e756b6a",null));t.default=d.exports},aq6f:function(e,t,a){"use strict";var i=a("JVPl");a.n(i).a},bZsl:function(e,t){var a=[{label:"字符串",value:1},{label:"大文本",value:2},{label:"整数",value:3},{label:"长整数",value:4},{label:"浮点数",value:5},{label:"布尔值",value:6},{label:"日期",value:7}];e.exports={dataTypes:a,formatDataType:function(e){var t=void 0;switch(e){case"字符串":case"大文本":case"日期":t="";break;case"布尔值":t=!1;break;case"整数":case"长整数":case"浮点数":t=0;break;default:t=""}return t},checkTime:function(e){return e<10&&(e="0"+e),e},dataTypeToText:function(e){var t=a.find(function(t){return t.value===e});return t?t.label:""},generateNewName:function(e,t){return t||(t=1),e.split(".").slice(0,-1).join(".")+"("+t+")."+e.substring(e.lastIndexOf(".")+1)},formatDateTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",a="/",i="/",s="",n=new Date(e),o=n.getFullYear(),l=n.getMonth()+1,r=n.getDate(),c=" "+(n.getHours()<10?"0"+n.getHours():n.getHours())+":"+(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes())+":"+(n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds());"年月日"===t&&(a="年",i="月",s="日",c="");var d=""+o+a+l+i+r+s+c;return NaN===d?e:d}}},ck2T:function(e,t,a){},dRDj:function(e,t,a){},diN0:function(e,t,a){},dpPX:function(e,t,a){},eYmZ:function(e,t,a){},f46f:function(e,t,a){"use strict";var i=a("lrOn");a.n(i).a},fO0c:function(e,t,a){},feW8:function(e,t,a){},gCzg:function(e,t,a){"use strict";var i={name:"LinkFile",data:function(){return{copyBtn:null,linkUrlHead:{head:this.$linkUrlHead},props:{linked:{type:Function,default:null}},formLink:{title:"文档共享",data:{randomFolderName:"",fullUrl:"",password:"",days:"",endDate:"",resources:[]},rules:{password:[{required:!0,message:"请输入密码",trigger:"blur"}]},pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},visible:!1,loading:!1}}},methods:{handleAddLink:function(e){if(0!==e.length){this.formLink.visible=!0;var t=this.randomString(24);this.formLink.data={id:0,randomFolderName:t,password:this.randomString(6),fullUrl:this.linkUrlHead.head+"/link/"+t+"/",resources:new Array};for(var a=0;a<e.length;a++){var i={resourceId:e[a].id,kind:e[a].kind,name:e[a].name,suffix:e[a].suffix};this.formLink.data.resources.push(i),console.log(e[a].kind)}this.$refs.formLinkData&&this.$refs.formLinkData.resetFields()}else this.$message.error("没有选择需要外链的文件或者文件夹，请重新选择！")},handleResetRandom:function(){this.formLink.data.randomFolderName=this.randomString(24),this.formLink.data.fullUrl=this.linkUrlHead.head+"/share/"+this.formLink.data.randomFolderName+"/"},handleResetPassword:function(){this.formLink.data.password=this.randomString(6)},handleCopyClipboard:function(){var e="外链地址:"+this.formLink.data.fullUrl+" 密码:"+this.formLink.data.password;this.copyBtn=new this.$clipboard(".btnCopy",{text:function(){return e}});var t=this,a=t.copyBtn;a.on("success",function(){t.$message({message:"已复制外链信息到剪贴板",type:"success"})}),a.on("error",function(){t.$message({message:"复制失败，请手动选择复制",type:"error"})})},handleLinkSubmit:function(){var e=this;this.$refs.formLinkData.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formLink.loading=!0;var t=Object.assign({},e.formLink.data);e.$axios({url:"/user/link",method:"post",data:t}).then(function(t){e.$message({message:"提交成功",type:"success"}),e.$refs.formLinkData.resetFields(),e.formLink.loading=!1,e.formLink.visible=!1,e.linked()}).catch(function(){})}).catch(function(){})})},randomString:function(e){e=e||24;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=t.length,i="",s=0;s<e;s++)i+=t.charAt(Math.floor(Math.random()*a));return i}}},s=(a("skaa"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.formLink.title,visible:e.formLink.visible,"close-on-click-modal":!0,width:"800px"},on:{"update:visible":function(t){e.$set(e.formLink,"visible",t)}}},[a("el-form",{ref:"formLinkData",attrs:{model:e.formLink.data,"label-width":"80px",rules:e.formLink.rules}},[a("el-row",[a("el-form-item",{attrs:{label:"外部链接",prop:"fullUrl"}},[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formLink.data.fullUrl,callback:function(t){e.$set(e.formLink.data,"fullUrl",t)},expression:"formLink.data.fullUrl"}},[a("template",{slot:"prepend"},[e._v("https://")]),e._v(" "),a("el-button",{attrs:{slot:"append",icon:"el-icon-refresh"},on:{click:function(t){e.handleResetRandom()}},slot:"append"},[e._v("重新生成")])],2)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"访问密码",prop:"password"}},[a("el-input",{attrs:{id:"success_form_input","auto-complete":"off"},model:{value:e.formLink.data.password,callback:function(t){e.$set(e.formLink.data,"password",t)},expression:"formLink.data.password"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-refresh"},on:{click:function(t){e.handleResetPassword()}},slot:"append"},[e._v("自动生成")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:4,offset:8}},[a("el-button",{ref:"copy",staticClass:"btnCopy",staticStyle:{float:"right"},attrs:{type:"primary",icon:"iconfont icon-wenjian",plain:""},on:{click:function(t){e.handleCopyClipboard()}}},[e._v("\n                        拷贝到剪贴板\n                    ")])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"截至日期"}},[a("el-date-picker",{attrs:{type:"date",size:"small",placeholder:"选择外链截至日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd","picker-options":e.formLink.pickerOptions},model:{value:e.formLink.data.endDate,callback:function(t){e.$set(e.formLink.data,"endDate",t)},expression:"formLink.data.endDate"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.formLink.loading},nativeOn:{click:function(t){return e.handleLinkSubmit(t)}}},[e._v("开始共享")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formLink.visible=!1}}},[e._v("关闭")])],1)],1)],1)},[],!1,null,null,null);t.a=n.exports},gXa5:function(e,t,a){"use strict";var i=a("kR3x");a.n(i).a},gllY:function(e,t,a){"use strict";var i={name:"CopyUserPermission",props:{addUser:{type:Function,default:null},editUser:{type:Function,default:null}},data:function(){return{formCopyUserPermission:{data:{id:0,radio:1,isMove:!1,user:{name:""}},submit:{isMove:0,from:[],to:[]},visible:!1,loading:!1},deptTree:{data:[],props:{children:"children",label:"name"},loading:!1,selected:null},memberTable:{height:0,body:[],total:0,loading:!1,selected:null},selectedTable:{height:0,body:[],loading:!1,selected:null,changeSelectedDept:!1},paginationData:{pageSize:1e3,total:0,curPage:1}}},methods:{printDept:function(){var e=this;this.deptTree.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),e.deptTree.data=a,e.deptTree.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},selectDept:function(e){this.deptTree.selected=e,this.printUser(e),this.selectedTable.changeSelectedDept=!0},printUser:function(e){var t=this;this.memberTable.loading=!0,this.$axios({url:"/admin/dept/"+e.id+"/users/"+this.paginationData.curPage+"-"+this.paginationData.pageSize,method:"get"}).then(function(e){t.memberTable.body=e.ctt.list,t.paginationData.total=e.ctt.total,t.memberTable.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},addUserToGroup:function(e){for(var t=0;t<this.selectedTable.body.length;t++)if(this.selectedTable.body[t].id===e.id)return void this.$message.warning("成员已在组内，不能再次添加！");this.selectedTable.body.push(e)},removeUserFromGroup:function(e){for(var t=0;t<this.selectedTable.body.length;t++)if(this.selectedTable.body[t].id===e.id)return void this.selectedTable.body.splice(t,1)},handleUserPermissionCopy:function(e){this.formCopyUserPermission.data={id:0,radio:1,user:e},this.formCopyUserPermission.visible=!0,this.$refs.formCopyUserPermission&&this.$refs.formCopyUserPermission.resetFields()},handleUserGroupClose:function(){this.formCopyUserPermission.loading=!1,this.formCopyUserPermission.visible=!1,this.memberTable.body=[],this.memberTable.selected=null,this.selectedTable.body=[],this.selectedTable.selected=null},handleUserGroupSubmit:function(){var e=this;new RegExp("[/:*?'\"<>|\\\\]");if(this.selectedTable.body&&0!==this.selectedTable.body.length){var t="";1===this.formCopyUserPermission.data.radio?(this.formCopyUserPermission.data.isMove?(t="确认把所选用户的权限转移给["+this.formCopyUserPermission.data.user.name+"]吗?<br/> 请注意，这将删除所选用户的相应权限！",this.formCopyUserPermission.submit.isMove=1):(t="确认把所选用户的权限复制给["+this.formCopyUserPermission.data.user.name+"]吗?",this.formCopyUserPermission.submit.isMove=0),this.formCopyUserPermission.submit.from=this.selectedTable.body,this.formCopyUserPermission.submit.to.push(this.formCopyUserPermission.data.user)):(this.formCopyUserPermission.data.isMove?(t="确认把["+this.formCopyUserPermission.data.user.name+"]的权限转移给所选用户吗?<br/> 请注意，这将删除["+this.formCopyUserPermission.data.user.name+"]的相应权限！",this.formCopyUserPermission.submit.isMove=1):(t="确认把["+this.formCopyUserPermission.data.user.name+"]的权限复制给所选用户吗?",this.formCopyUserPermission.submit.isMove=0),this.formCopyUserPermission.submit.from.push(this.formCopyUserPermission.data.user),this.formCopyUserPermission.submit.to=this.selectedTable.body);this.$confirm(t,"提示",{cancelButtonClass:"btn-custom-cancel",dangerouslyUseHTMLString:!0,type:"warning"}).then(function(){e.$axios({url:"/admin/copyRole",method:"post",data:e.formCopyUserPermission.submit}).then(function(t){0===t.c?(e.$message.success("用户权限复制完成！"),e.formCopyUserPermission.loading=!1,e.formCopyUserPermission.visible=!1,e.memberTable.body=[],e.memberTable.selected=null,e.selectedTable.body=[],e.selectedTable.selected=null):(e.$message.error(t.msg),e.formCopyUserPermission.loading=!1,e.formCopyUserPermission.visible=!1,e.memberTable.body=[],e.memberTable.selected=null,e.selectedTable.body=[],e.selectedTable.selected=null)})}).catch(function(){})}else this.$message.error("请选择需要复制权限的用户！")}}},s=(a("gXa5"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"复制用户权限",visible:e.formCopyUserPermission.visible,"close-on-click-modal":!1,width:"1000px"},on:{"update:visible":function(t){e.$set(e.formCopyUserPermission,"visible",t)},open:e.printDept}},[a("el-form",{ref:"formCopyUserPermission",attrs:{model:e.formCopyUserPermission.data,"label-width":"80px",rules:e.formCopyUserPermission.rules}},[a("el-row",{staticStyle:{"min-height":"460px",height:"460px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"460px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTree.loading,expression:"deptTree.loading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptTree.data,"highlight-current":"",props:e.deptTree.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.selectDept},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:16}},[a("el-row",{staticStyle:{"margin-bottom":"20px"}},[a("el-col",{attrs:{span:19}},[a("el-radio-group",{model:{value:e.formCopyUserPermission.data.radio,callback:function(t){e.$set(e.formCopyUserPermission.data,"radio",t)},expression:"formCopyUserPermission.data.radio"}},[a("el-radio-button",{attrs:{label:1}},[e._v("把所选用户的权限复制给"+e._s(e.formCopyUserPermission.data.user.name))]),e._v(" "),a("el-radio-button",{attrs:{label:2}},[e._v("把"+e._s(e.formCopyUserPermission.data.user.name)+"的权限复制给所选用户")])],1)],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-checkbox",{model:{value:e.formCopyUserPermission.data.isMove,callback:function(t){e.$set(e.formCopyUserPermission.data,"isMove",t)},expression:"formCopyUserPermission.data.isMove"}},[e._v("删除复制来源")])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTable.loading,expression:"memberTable.loading"}],ref:"memberTable",staticClass:"custom-table-cell",attrs:{data:e.memberTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",border:"",height:"400px"}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"增加成员",placement:"right"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"el-icon-d-arrow-right",circle:""},on:{click:function(a){e.addUserToGroup(t.row)}}})],1)],1)]}}])})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.selectedTable.loading,expression:"selectedTable.loading"}],ref:"selectedTable",staticClass:"custom-table-cell",attrs:{data:e.selectedTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",border:"",height:"400px"}},[a("el-table-column",{attrs:{prop:"name",label:"已选择用户"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除成员",placement:"right"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-yonghushanchu",circle:""},on:{click:function(a){e.removeUserFromGroup(t.row)}}})],1)],1)]}}])})],1)],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new",loading:e.formCopyUserPermission.loading},nativeOn:{click:function(t){return e.handleUserGroupSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.handleUserGroupClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,"2f2dd1a3",null);t.a=n.exports},gtv3:function(e,t,a){},guNd:function(e,t,a){},"h75/":function(e,t,a){},h8Z9:function(e,t,a){},hSeo:function(e,t,a){},hiyP:function(e,t,a){"use strict";var i=a("IUcV");a.n(i).a},iaoZ:function(e,t,a){"use strict";var i={name:"EditFolderWhite",props:{editJob:{type:Function,default:null}},data:function(){return{fromIpInput:{folderId:0,folderName:"",ipInfo:"",visible:!1,loading:!1,rules:{ipInfo:[{required:!0,message:"请输入ip白名单",trigger:"blur"}]}}}},methods:{handleWhiteList:function(e){var t=this;this.$refs.fromIpInput&&this.$refs.fromIpInput.resetFields(),this.$axios({url:"/admin/folder/"+e.data.id+"/ip",method:"get"}).then(function(a){a.ctt?t.fromIpInput.ipInfo=a.ctt.ipInfo:t.fromIpInput.ipInfo="",t.fromIpInput.folderId=e.data.id,t.fromIpInput.folderName=e.data.name,t.fromIpInput.visible=!0}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},handleEditWhiteList:function(e){var t=this;this.$refs.fromIpInput&&this.$refs.fromIpInput.resetFields(),this.$axios({url:"/admin/folder/"+e.id+"/ip",method:"get"}).then(function(a){a.ctt?t.fromIpInput.ipInfo=a.ctt.ipInfo:t.fromIpInput.ipInfo="",t.fromIpInput.folderId=e.id,t.fromIpInput.folderName=e.name,t.fromIpInput.visible=!0}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},handleWhiteListSubmit:function(){var e=this;this.$refs.ipInputForm.validate(function(t){t&&e.$confirm("确认添加这些IP白名单吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){var t=Object.assign({},e.fromIpInput);e.$axios({url:"/admin/folder/"+e.fromIpInput.folderId+"/ip",method:"put",data:t}).then(function(t){0===t.c||e.$message.error(t.msg),e.fromIpInput.visible=!1})}).catch(function(){})})}}},s=(a("3QlK"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"设置文件夹访问IP白名单",visible:e.fromIpInput.visible,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(t){e.$set(e.fromIpInput,"visible",t)},open:e.handleWhiteList}},[a("el-form",{ref:"ipInputForm",attrs:{model:e.fromIpInput,"label-width":"80px",rules:e.fromIpInput.rules}},[a("el-form-item",{staticStyle:{"font-style":"oblique","font-weight":"bold"},attrs:{label:"目录名："}},[a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("span",{staticStyle:{"font-style":"normal","font-weight":"normal"}},[e._v(e._s(e.fromIpInput.folderName))])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"IP白名单",prop:"ipInfo"}},[a("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入白名单规则，规则之间用';'号隔开"},model:{value:e.fromIpInput.ipInfo,callback:function(t){e.$set(e.fromIpInput,"ipInfo",t)},expression:"fromIpInput.ipInfo"}})],1),e._v(" "),a("div",{staticStyle:{margin:"15px 0 0 15px",padding:"5px",display:"flex",height:"100px","border-radius":"5px",border:"1px solid #dcdfe6"}},[a("span",{staticStyle:{color:"#606266","font-weight":"bold"}},[e._v("说明："),a("br"),e._v("\n                        1、输入需要开通的IP白名单列表，IP与IP直接用';'号间隔。"),a("br"),e._v("\n                              \n                        如：10.0.4.5;10.0.4.6"),a("br"),e._v("\n                        2、支持IP段的设置，设置方式为起始IP与结束IP间用'-'号连接。"),a("br"),e._v("\n                              \n                        如：10.0.4.5-10.0.4.15"),a("br")])])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.fromIpInput.loading},nativeOn:{click:function(t){return e.handleWhiteListSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){e.fromIpInput.visible=!1}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,"146f9a89",null);t.a=n.exports},igIz:function(e,t,a){"use strict";var i=a("dRDj");a.n(i).a},jURs:function(e,t,a){"use strict";a.r(t);var i={name:"EditLog",props:{setCondition:{type:Function,default:null},editLog:{type:Function,default:null},deleteCondition:{type:Function,default:null},refresh:{type:Function,default:null}},data:function(){return{formDelete:{data:{dateRange:""},rules:{},visible:!1,loading:!1},formOutPut:{isOutPut:!1,title:"",data:{isDelete:!1,dateRange:""},rules:{},visible:!1,loading:!1},memberTree:{data:[],loading:!1,props:{children:"children",label:"name"},selected:null,vis:!0},pickerDateRange:{Options:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}}},methods:{memberSelect:function(e){this.memberTree.selected=e},handleOutputCSV:function(){this.formOutPut.title="导出历史数据",this.formOutPut.visible=!0,this.formOutPut.isOutPut=!0},handleCondition:function(){this.formOutPut.title="选择检索条件",this.formOutPut.visible=!0,this.formOutPut.isOutPut=!1},handleDelete:function(){this.formDelete.visible=!0},printMemberTree:function(e,t){var a=this,i=void 0;if(0===e.level)i=0;else{if("dept"!==e.data.kind)return void t([]);i=e.data.id}this.memberTree.loading=!0,this.$axios({url:"/admin/dept/"+i+"/members",method:"get"}).then(function(e){t(e.ctt),a.memberTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},handleDeleteSubmit:function(){var e=this;this.$refs.formDelete.validate(function(t){t&&e.$confirm("确认要删除吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"error"}).then(function(){e.deleteCondition(e.formDelete.data.dateRange),e.clear()})})},handleOutputCSVSubmit:function(){var e=this;this.$refs.formOutPut.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){var t="",a=0,i="",s="";null!==e.memberTree.selected&&(t=e.memberTree.selected.kind,a=e.memberTree.selected.id),""!==e.formOutPut.data.dateRange&&(i=e.formOutPut.data.dateRange[0],s=e.formOutPut.data.dateRange[1]),e.$axios({url:"admin/logs/download",method:"post",responseType:"blob",params:{kind:t,id:a,startTime:i,endTime:s,isDelete:e.formOutPut.data.isDelete}}).then(function(t){if(t){var a=new Blob([t]);if("download"in document.createElement("a")){var i=document.createElement("a");i.download="log.csv",i.style.display="none",i.href=URL.createObjectURL(a),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)}else window.navigator.msSaveBlob(a,"log.csv");e.formOutPut.data.isDelete&&e.refresh(),e.clear()}else e.$message({message:"下载失败",type:"error"})})})})},handleConditionSubmit:function(){this.setCondition(this.memberTree.selected,this.formOutPut.data.dateRange),this.clear(),this.formOutPut.visible=!1},clear:function(){this.formDelete.data.dateRange="",this.formDelete.loading=!1,this.formDelete.visible=!1,this.formOutPut.isOutPut=!1,this.formOutPut.title="",this.formOutPut.data.isDelete=!1,this.formOutPut.data.dateRange="",this.formOutPut.visible=!1}}},s=(a("qfG7"),a("KHd+")),n={components:{EditLog:Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.formOutPut.title,visible:e.formOutPut.visible,"close-on-click-modal":!0,width:"700px"},on:{"update:visible":function(t){e.$set(e.formOutPut,"visible",t)}}},[a("el-form",{ref:"formOutPut",attrs:{model:e.formOutPut.data,"label-width":"0px",rules:e.formOutPut.rules}},[a("el-row",{staticStyle:{"min-height":"400px",height:"400px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"400px"}},[a("el-scrollbar",[e.formOutPut.visible?a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTree.loading,expression:"memberTree.loading"}],ref:"memberTree",attrs:{data:e.memberTree.data,"highlight-current":"",props:e.memberTree.props,"expand-on-click-node":!1,lazy:"","node-key":"key",load:e.printMemberTree,"default-expanded-keys":["dept-1"]},on:{"node-click":e.memberSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",["dept"===s.kind?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-user"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):2===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):0===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-user"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("span",[e._v(e._s(i.label))])])])])}}])}):e._e()],1)],1)]),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-form-item",{attrs:{label:"",prop:"name"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","value-format":"yyyy-MM-dd HH:mm:ss","end-placeholder":"结束日期","picker-options":e.pickerDateRange.Options},model:{value:e.formOutPut.data.dateRange,callback:function(t){e.$set(e.formOutPut.data,"dateRange",t)},expression:"formOutPut.data.dateRange"}})],1),e._v(" "),e.formOutPut.isOutPut?a("el-form-item",[a("el-checkbox",{model:{value:e.formOutPut.data.isDelete,callback:function(t){e.$set(e.formOutPut.data,"isDelete",t)},expression:"formOutPut.data.isDelete"}},[e._v("同时删除履历")])],1):e._e()],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.formOutPut.isOutPut?a("el-button",{attrs:{type:"primary",loading:e.formOutPut.loading},on:{click:e.handleOutputCSVSubmit}},[e._v("确定")]):e._e(),e._v(" "),e.formOutPut.isOutPut?e._e():a("el-button",{attrs:{type:"primary",loading:e.formOutPut.loading},on:{click:e.handleConditionSubmit}},[e._v("确定")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formOutPut.visible=!1}}},[e._v("取消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"删除历史履历",visible:e.formDelete.visible,"close-on-click-modal":!0,width:"400px"},on:{"update:visible":function(t){e.$set(e.formDelete,"visible",t)}}},[a("el-form",{ref:"formDelete",attrs:{model:e.formDelete.data,"label-width":"0px",rules:e.formDelete.rules}},[a("el-form-item",{attrs:{label:"",prop:"name"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerDateRange.Options},model:{value:e.formDelete.data.dateRange,callback:function(t){e.$set(e.formDelete.data,"dateRange",t)},expression:"formDelete.data.dateRange"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.formDelete.loading},on:{click:e.handleDeleteSubmit}},[e._v("确定")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formDelete.visible=!1}}},[e._v("取消")])],1)],1)],1)},[],!1,null,"53fee725",null).exports},name:"log",data:function(){return{searchForm:{time:"",type:"",text:""},tableData:{height:0,loading:!0,body:[],pageSize:25,total:0,curPage:1},tagCondition:{visible:!1,name:"",member:{id:0,kind:""},dateRange:["",""]}}},mounted:function(){this.tableHeight(),this.getData()},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.table.$el.offsetTop-75;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.table.$el.offsetTop-75}})},getData:function(){var e=this;this.tableData.loading=!0,this.$axios({url:"/admin/logs/"+this.tableData.curPage+"-"+this.tableData.pageSize+"/filter",method:"get",params:{kind:this.tagCondition.member.kind,id:this.tagCondition.member.id,startTime:this.tagCondition.dateRange[0],endTime:this.tagCondition.dateRange[1]}}).then(function(t){e.tableData.body=t.ctt.list,e.tableData.total=t.ctt.total,e.tableData.loading=!1,e.$nextTick(function(){e.tableHeight()})}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},search:function(){console.log("欲提交的数据   日期:"+this.searchForm.time+"  下拉条件:"+this.searchForm.type+"  文本: "+this.searchForm.text)},setCondition:function(e,t){this.tagCondition.name="",console.log(e),null!==e?(this.tagCondition.member=e,this.tagCondition.name=e.name+"  "):this.tagCondition.id=0,null!==t&&t.length>0?this.tagCondition.dateRange=t:this.tagCondition.dateRange=["",""],t&&2===t.length&&(this.tagCondition.name+=this.$moment(t[0]).format("YYYY年MM月DD日")+"〜"+this.$moment(t[1]).format("MM月DD日")),""!==this.tagCondition.name&&(this.tagCondition.visible=!0),this.refresh()},deleteCondition:function(e){var t=this;this.$axios({url:"/admin/deleteLogs",method:"delete",params:{startTime:e[0],endTime:e[1]}}).then(function(e){0===e.c?(t.$message.success("删除成功"),t.refresh()):t.$message.error(e.msg)}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},clearCondition:function(e){this.tagCondition.visible=!1},selectPage:function(e){this.tableData.curPage=e,this.getData()},refresh:function(){this.tableData.total=0,this.tableData.body=[],this.tableData.curPage=1,this.getData()}}},o=(a("PGVT"),Object(s.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"zhinengrizhiguanlipingtai"}}),e._v("  系统日志")],1)])]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-system-extension",plain:""},on:{click:function(t){e.$refs.editLog.handleCondition()}}},[e._v("  设置检索条件")]),e._v(" "),a("el-button-group",{staticClass:"plr10"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-caozuo-shangchuan-download",plain:""},on:{click:function(t){e.$refs.editLog.handleOutputCSV()}}},[e._v("  导出记录")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-trash",plain:""},on:{click:function(t){e.$refs.editLog.handleDelete()}}},[e._v("  删除记录")])],1),e._v(" "),e.tagCondition.visible?a("el-tag",{key:"condition",staticStyle:{"margin-left":"50px"},attrs:{size:"medium",closable:"",type:"info"},on:{close:e.clearCondition}},[e._v(e._s(e.tagCondition.name))]):e._e()],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"64",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"execinfo",label:"操作","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"IP","min-width":"20%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"url",label:"URL","min-width":"40%","show-overflow-tooltip":!0}})],1),e._v(" "),a("div",{staticStyle:{"padding-top":"15px","text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev,pager,next,jumper","page-size":e.tableData.pageSize,"current-page":e.tableData.curPage,total:e.tableData.total},on:{"current-change":e.selectPage}})],1)],1),e._v(" "),a("edit-log",{ref:"editLog",attrs:{"set-condition":e.setCondition,"delete-condition":e.deleteCondition,refresh:e.refresh,editLog:e.getData}})],1)},[],!1,null,"17e20501",null));t.default=o.exports},jhdv:function(e,t,a){"use strict";var i=a("oCYn");t.a=new i.default},"k/fZ":function(e,t,a){"use strict";var i=a("TDVK");a.n(i).a},k0WT:function(e,t,a){},k1At:function(e,t,a){"use strict";var i=a("69qQ");a.n(i).a},kDyiO:function(e,t,a){"use strict";a.r(t);var i=a("jhdv"),s=a("bZsl"),n=a("JGdg"),o=a("gllY"),l={name:"solrField",data:function(){return{title:"",visible:!1,fieldData:[],docType:null,keywords:"",selectedSolr:null}},watch:{docType:function(e){e&&this.initFields()}},methods:{initFields:function(){var e=this;this.docType&&this.$axios({method:"get",url:"/external/solr/type/"+this.docType+"?name="+this.keywords}).then(function(t){e.fieldData=t.ctt})},handleCurrentChange:function(e){this.selectedSolr=e},dialogOnClose:function(){this.visible=!1},dialogOnSubmit:function(){i.a.$emit("selectedSolr",this.selectedSolr),this.dialogOnClose()}}},r=(a("ZKo4"),a("KHd+")),c=Object(r.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.title,visible:e.visible,"append-to-body":"",width:"460px"},on:{"update:visible":function(t){e.visible=t}}},[a("el-table",{attrs:{data:e.fieldData,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{property:"code",label:"字段"}}),e._v(" "),a("el-table-column",{attrs:{property:"name",label:"名称"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new"},on:{click:e.dialogOnSubmit}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.dialogOnClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,null,null).exports,d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var f={name:"EditMetaData",components:{SolrField:c},data:function(){var e;return{visible:!1,dialogType:"create",rules:{docType:[{required:!0,message:"请选择文档类型",trigger:"change"}],code:[{required:!0,message:"请输入字段编码",trigger:"blur"}],name:[{required:!0,message:"请输入字段名称",trigger:"blur"}],seq:[{required:!0,message:"请输入排序",trigger:"blur"}],dataType:[{required:!0,message:"请输入数据类型",trigger:"blur"}],size:[{required:!0,message:"请输入长度"},(e={validator:!0},u(e,"validator",function(e,t,a){return t>4e3?a(new Error("长度不能大于4000")):a()}),u(e,"trigger","blur"),e)]},form:{id:"",docType:"",code:"",name:"",seq:"",dataType:"",size:"",notnull:!1,solrId:"",solrName:"",comment:""},docTypes:[],dataTypes:[]}},computed:{dialogTitle:function(){return"edit"===this.dialogType?"修改元数据":"新增元数据"}},mounted:function(){var e=this;this.dataTypes=s.dataTypes,i.a.$on("selectedSolr",function(t){e.form.solrId=t.id,e.form.solrName=t.name})},methods:{onOpen:function(){},onClose:function(){this.initForm(),this.$refs.form.resetFields()},initForm:function(){this.form={id:"",docType:"",code:"",name:"",seq:"",dataType:"",size:"",notnull:!1,solrId:"",solrName:"",comment:""}},dialogOnClose:function(){this.visible=!1,this.initForm(),this.$refs.form.resetFields()},dialogOnSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(t&&""!==e.form.solrId){if("create"===e.dialogType){var a=e.form,s=(a.id,a.docType),n=a.notnull,o=(a.solrName,a.solrId),l=function(e,t){var a={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);return a}(a,["id","docType","notnull","solrName","solrId"]),r=d({},l,{docType:parseInt(s),notnull:n?1:0,status:1,solrId:o});e.$axios({method:"post",url:"/external/metadata",data:r}).then(function(t){e.$message.success("新建成功"),e.dialogOnClose(),i.a.$emit("refreshMetadata")}).catch(function(t){e.$message.error("新建失败")})}if("edit"===e.dialogType){var c=d({},e.form,{notnull:e.form.notnull?1:0,docType:parseInt(e.form.docType)});e.$axios({method:"put",url:"/external/metadata",data:c}).then(function(t){0===t.c&&(e.$message.success("修改成功"),e.dialogOnClose(),i.a.$emit("refreshMetadata"))}).catch(function(t){e.$message.error("修改失败")})}}})},showSolrFieldDialog:function(){""!==this.form.docType?(this.$refs.solrField.visible=!0,this.$refs.solrField.docType=this.form.docType):this.$message.warning("请选择文档类型")},handleChangeDocType:function(e){},handleChangeDataType:function(e){}}},m=(a("QNTy"),Object(r.a)(f,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit-matadata-container"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,"close-on-click-modal":!1,width:"700px"},on:{"update:visible":function(t){e.visible=t},open:e.onOpen,close:e.onClose}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","label-position":"left"}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"源数据id",prop:"id"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文档类型",prop:"docType"}},[a("el-select",{attrs:{placeholder:"请选择文档类型"},on:{change:e.handleChangeDocType},model:{value:e.form.docType,callback:function(t){e.$set(e.form,"docType",t)},expression:"form.docType"}},e._l(e.docTypes,function(e,t){return a("el-option",{key:t,attrs:{label:e.comment,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"字段编码",prop:"code"}},[a("el-input",{model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"字段名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"seq"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.seq,callback:function(t){e.$set(e.form,"seq",t)},expression:"form.seq"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据类型",prop:"dataType"}},[a("el-select",{attrs:{placeholder:"请选择数据类型"},on:{change:e.handleChangeDataType},model:{value:e.form.dataType,callback:function(t){e.$set(e.form,"dataType",t)},expression:"form.dataType"}},e._l(e.dataTypes,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"长度",prop:"size"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.size,callback:function(t){e.$set(e.form,"size",t)},expression:"form.size"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"非空",prop:"notnull"}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.form.notnull,callback:function(t){e.$set(e.form,"notnull",t)},expression:"form.notnull"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"solr字段",prop:"solrId"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.solrName,callback:function(t){e.$set(e.form,"solrName",t)},expression:"form.solrName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-more"},on:{click:e.showSolrFieldDialog},slot:"append"})],1),e._v(" "),""===e.form.solrId?a("div",{staticClass:"el-form-item__error custom"},[e._v("请选择solr字段")]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"说明",prop:"comment"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new"},on:{click:e.dialogOnSubmit}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.dialogOnClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1),e._v(" "),a("solr-field",{ref:"solrField"})],1)],1)},[],!1,null,null,null).exports),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};var h={components:{CopyUserPermission:o.a,EditUser:n.a,EditMetaData:m},name:"metadata",data:function(){return{searchTxt:"",searchData:"",tableData:{height:0,loading:!0,body:[],pageSize:20,total:0,curPage:0},isShowAll:!1,docTypes:[]}},mounted:function(){var e=this;this.initDocTypes(),i.a.$on("refreshMetadata",function(t){e.refresh()})},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.table.$el.offsetTop;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.table.$el.offsetTop}})},getData:function(e){var t=this;this.tableData.loading=this.$refs.infinite.isFirstLoad;var a=void 0;a=this.searchData?"/external/metadata/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name="+this.searchData:"/external/metadata/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name=",this.$axios({url:a,method:"get"}).then(function(a){var i=[];i.push(a.ctt.list),i[0].length>0&&1===i[0][0].id&&(i[0][0].isRoot=!0),t.tableData.body=t.tableData.body.concat(a.ctt.list),t.tableData.total=a.ctt.total,t.tableData.loading=!1,0==a.ctt.list.length?e&&e.complete():e&&e.loaded(),t.$nextTick(function(){t.tableHeight()})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},search:function(){this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchData=this.searchTxt,this.refresh()):this.$message.success("请输入搜索关键词")},handleUserAdd:function(){this.$refs.editUser.handleUserAdd()},handleUserInput:function(){var e=this;this.$confirm("开始导入最新用户数据吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.tableData.loading=!0,e.$axios({url:"/relay/users",method:"post"}).then(function(t){e.$message({message:"已经完成导入",type:"success"}),e.tableData.loading=!1,e.refresh()}).catch(function(t){e.tableData.loading=!1,e.$message.error("获取数据失败，失败码："+t.response.status)})}).catch(function(){})},handleUserUnlockSubmit:function(e,t){this.$refs.editUser.handleUserUnlockSubmit(e,t)},handleCopyUserPermission:function(e,t){this.$refs.copyUserPermission.handleUserPermissionCopy(t)},handleUserBaseEdit:function(e,t){this.$refs.editUser.handleUserBaseEdit(e,t)},handleUserPasswordEdit:function(e,t){this.$refs.editUser.handleUserPasswordEdit(e,t)},handleAdminSubmit:function(e,t){this.$refs.editUser.handleAdminSubmit(e,t)},handleUserLockSubmit:function(e,t){this.$refs.editUser.handleUserLockSubmit(e,t)},handleUserLeaveSubmit:function(e,t){this.$refs.editUser.handleUserLeaveSubmit(e,t)},handleUserDeleteSubmit:function(e,t){this.$refs.editUser.handleUserDeleteSubmit(e,t)},nextPage:function(e){this.tableData.curPage+=1,this.getData(e)},refresh:function(){this.tableData.total=0,this.tableData.body=[],this.tableData.curPage=0,this.$refs.infinite.stateChanger.reset()},clearSearchTxt:function(){this.searchData="",this.refresh()},showAllChange:function(){this.refresh()},handleEditItem:function(e,t){this.$refs.editMetaData.dialogType="edit",this.$refs.editMetaData.visible=!0,this.$refs.editMetaData.docTypes=this.docTypes;t.dataProperty,t.solrStructure;var a=t.docType,i=function(e,t){var a={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);return a}(t,["dataProperty","solrStructure","docType"]);this.$refs.editMetaData.form=p({},i,{docType:String(a),notnull:1===t.notnull})},handleDelItem:function(e,t){var a=this;this.$confirm("此操作将删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$axios({method:"delete",url:"/external/metadata",data:{id:t.id}}).then(function(e){a.refresh(),a.$message.success("删除成功")}).catch(function(e){a.$message.error("删除数据失败，失败码："+e.response.status)})}).catch(function(){})},handleSetValidItem:function(e,t){var a=this;this.$confirm("此操作将该数据置为"+(1===t.status?"无效":"有效")+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$axios({method:"put",url:"/external/metadataInvalid",data:{id:t.id,status:1===t.status?9:1}}).then(function(e){0===e.c&&(a.refresh(),a.$message.success("设置成功"))}).catch(function(e){a.$message.error("设置数据失败，失败码："+e.response.status)})}).catch(function(){})},handleAddMetaData:function(){this.$refs.editMetaData.dialogType="create",this.$refs.editMetaData.docTypes=this.docTypes,this.$refs.editMetaData.visible=!0},initDocTypes:function(){var e=this;this.$axios({method:"get",url:"/external/metadataType"}).then(function(t){e.docTypes=t.ctt})},formatNum2Str:function(e){return 1===e?"是":"否"},formatDocType:function(e){var t=this.docTypes.find(function(t){return parseInt(t.value)===e});return t&&t.comment?t.comment:e},formatDataType:function(e){var t=s.dataTypes.find(function(t){return parseInt(t.value)===e});return t?t.label:e}}},g=(a("JuzV"),Object(r.a)(h,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"web-xietongwendang"}}),e._v("  元数据设置")],1)]),e._v(" "),a("div",{staticClass:"ib pd10"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入关键字",clearable:""},on:{clear:e.clearSearchTxt},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline",plain:""},on:{click:e.handleAddMetaData}},[e._v("新增元数据")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height}},[a("el-table-column",{attrs:{prop:"id",label:"id",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.id))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"docType",label:"文档类型",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.formatDocType(t.row.docType)))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"code",label:"字段编码",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.code))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"字段名称",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"seq",label:"排序",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.seq))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"dataType",label:"数据类型",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.formatDataType(t.row.dataType)))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"size",label:"长度",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.size))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"notnull",label:"非空",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.formatNum2Str(t.row.notnull)))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"solrId",label:"solr对应字段",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.solrName))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"bottom"}},[a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-file",circle:""},on:{click:function(a){e.handleEditItem(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},on:{click:function(a){e.handleDelItem(t.$index,t.row)}}})],1),e._v(" "),1===t.row.status?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"无效化",placement:"bottom"}},[a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-dongjie",circle:""},on:{click:function(a){e.handleSetValidItem(t.$index,t.row)}}})],1):e._e(),e._v(" "),9===t.row.status?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"有效化",placement:"bottom"}},[a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-jiechu",circle:""},on:{click:function(a){e.handleSetValidItem(t.$index,t.row)}}})],1):e._e()],1)]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1),e._v(" "),a("edit-user",{ref:"editUser",attrs:{"add-user":e.refresh,"edit-user":e.refresh}}),e._v(" "),a("edit-meta-data",{ref:"editMetaData"}),e._v(" "),a("copy-user-permission",{ref:"copyUserPermission"})],1)},[],!1,null,"b40d76d4",null));t.default=g.exports},kR3x:function(e,t,a){},kgFX:function(e,t,a){"use strict";var i=a("ck2T");a.n(i).a},kmx4:function(e,t,a){},lrOn:function(e,t,a){},ltQa:function(e,t,a){"use strict";var i=a("mv2y");a.n(i).a},mv2y:function(e,t,a){},nGH7:function(e,t,a){},nWR2:function(e,t,a){e.exports=a.p+"images/logo.66dffee.png"},oFcs:function(e,t,a){},oIJY:function(e,t,a){"use strict";var i=a("va8q");a.n(i).a},oPgD:function(e,t,a){"use strict";var i=a("6fut");a.n(i).a},ovVj:function(e,t,a){"use strict";a.r(t);var i={name:"EditUserGroup",props:{addUser:{type:Function,default:null},editUser:{type:Function,default:null}},data:function(){return{formUserGroup:{isNew:!0,data:{id:0,name:""},submit:{id:0,name:"",type:2,status:1,users:[]},rules:{name:[{required:!0,message:"请输入用户组名称",trigger:"blur"}]},visible:!1,loading:!1},deptTree:{data:[],props:{children:"children",label:"name"},loading:!1,selected:null},memberTable:{height:0,body:[],total:0,loading:!1,selected:null},selectedTable:{height:0,body:[],loading:!1,selected:null,changeSelectedDept:!1},paginationData:{pageSize:1e3,total:0,curPage:1}}},methods:{printDept:function(){var e=this;this.deptTree.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),e.deptTree.data=a,e.deptTree.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},selectDept:function(e){this.deptTree.selected=e,this.printUser(e),this.selectedTable.changeSelectedDept=!0},printUser:function(e){var t=this;this.memberTable.loading=!0,this.$axios({url:"/admin/dept/"+e.id+"/users/"+this.paginationData.curPage+"-"+this.paginationData.pageSize,method:"get"}).then(function(e){t.memberTable.body=e.ctt.list,t.paginationData.total=e.ctt.total,t.memberTable.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},addUserToGroup:function(e){for(var t=0;t<this.selectedTable.body.length;t++)if(this.selectedTable.body[t].id===e.id)return void this.$message.warning("成员已在组内，不能再次添加！");this.selectedTable.body.push(e)},removeUserFromGroup:function(e){for(var t=0;t<this.selectedTable.body.length;t++)if(this.selectedTable.body[t].id===e.id)return void this.selectedTable.body.splice(t,1)},handleUserGroupAdd:function(){this.formUserGroup.data={id:0,name:""},this.formUserGroup.isNew=!0,this.formUserGroup.visible=!0,this.$refs.formUserGroup&&this.$refs.formUserGroup.resetFields()},handleUserGroupEdit:function(e,t){this.formUserGroup.data={id:e.id,name:e.name},this.formUserGroup.isNew=!1,this.selectedTable.body=t.body,this.selectedTable.total=t.total,this.selectedTable.loading=!1,this.formUserGroup.visible=!0,this.$refs.formUserGroup&&this.$refs.formUserGroup.resetFields()},handleUserGroupClose:function(){this.formUserGroup.loading=!1,this.formUserGroup.visible=!1,this.memberTable.body=[],this.memberTable.selected=null,this.selectedTable.body=[],this.selectedTable.selected=null},handleUserGroupSubmit:function(){var e=this;if(this.formUserGroup.data.name.trim())if(new RegExp("[/:*?'\"<>|\\\\]").test(this.formUserGroup.data.name.trim()))this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|");else if(this.selectedTable.body&&0!==this.selectedTable.body.length){this.formUserGroup.submit={id:this.formUserGroup.data.id,name:this.formUserGroup.data.name,type:2,status:1,users:this.selectedTable.body};var t="",a="";this.formUserGroup.isNew?(t="确认新增["+this.formUserGroup.submit.name+"]用户组吗?",a="post"):(t="确认编辑["+this.formUserGroup.submit.name+"]用户组吗?",a="put"),this.$confirm(t,"提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.$axios({url:"/admin/group",method:a,data:e.formUserGroup.submit}).then(function(t){0===t.c?(e.$message.success("新增用户组成功！"),e.formUserGroup.loading=!1,e.formUserGroup.visible=!1,e.memberTable.body=[],e.memberTable.selected=null,e.selectedTable.body=[],e.selectedTable.selected=null,e.addUser()):(e.$message.error(t.msg),e.formUserGroup.loading=!1,e.formUserGroup.visible=!1,e.memberTable.body=[],e.memberTable.selected=null,e.selectedTable.body=[],e.selectedTable.selected=null,e.addUser())})}).catch(function(){})}else this.$message.error("请选择用户组成员！");else this.$message.error("请输入用户组名称！")}}},s=(a("Tk/2"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"用户组编辑",visible:e.formUserGroup.visible,"close-on-click-modal":!1,width:"1000px"},on:{"update:visible":function(t){e.$set(e.formUserGroup,"visible",t)},open:e.printDept}},[a("el-form",{ref:"formUserGroup",attrs:{model:e.formUserGroup.data,"label-width":"80px",rules:e.formUserGroup.rules}},[a("el-row",{staticStyle:{"min-height":"460px",height:"460px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"460px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTree.loading,expression:"deptTree.loading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptTree.data,"highlight-current":"",props:e.deptTree.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.selectDept},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:16}},[a("el-row",[a("el-form-item",{attrs:{"label-width":"120px",label:"编辑用户组名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formUserGroup.data.name,callback:function(t){e.$set(e.formUserGroup.data,"name",t)},expression:"formUserGroup.data.name"}})],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTable.loading,expression:"memberTable.loading"}],ref:"memberTable",staticClass:"custom-table-cell",attrs:{data:e.memberTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",border:"",height:"400px"}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"增加成员",placement:"right"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"el-icon-d-arrow-right",circle:""},on:{click:function(a){e.addUserToGroup(t.row)}}})],1)],1)]}}])})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.selectedTable.loading,expression:"selectedTable.loading"}],ref:"selectedTable",staticClass:"custom-table-cell",attrs:{data:e.selectedTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",border:"",height:"400px"}},[a("el-table-column",{attrs:{prop:"name",label:"已选择用户"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除成员",placement:"right"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-yonghushanchu",circle:""},on:{click:function(a){e.removeUserFromGroup(t.row)}}})],1)],1)]}}])})],1)],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new",loading:e.formUserGroup.loading},nativeOn:{click:function(t){return e.handleUserGroupSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){return e.handleUserGroupClose(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1)],1)},[],!1,null,"e280713e",null).exports,o=a("Gas7"),l={components:{EditUserGroup:n,splitPane:a.n(o).a},name:"usergroup",data:function(){return{splitClass:"",userGroupData:{height:0,loading:!0,body:[],pageSize:1e3,total:0,curPage:0},userData:{loading:!1,groupId:0,body:[],pageSize:1e3,total:0,curPage:1}}},methods:{tableHeight:function(){this.$nextTick(function(){this.userGroupData.height=window.innerHeight-this.$refs.table.$el.offsetTop;var e=this;window.onresize=function(){e.userGroupData.height=window.innerHeight-e.$refs.table.$el.offsetTop}})},onMouseDown:function(){this.$refs.split.active&&(this.splitClass="active")},onMouseUp:function(){this.$refs.split.active||(this.splitClass="")},onClickUserGroup:function(e,t){var a=0;a=null!==e?e.id:t.id,this.printUser(a)},refresh:function(){this.userGroupData.total=0,this.userGroupData.body=[],this.userGroupData.curPage=0,this.$refs.infinite.stateChanger.reset(),this.userData.total=0,this.userData.groupId=0,this.userData.body=[],this.userData.curPage=1},nextPage:function(e){this.userGroupData.curPage+=1,this.printUserGroup(e)},printUserGroup:function(e){var t=this;this.userGroupData.loading=this.$refs.infinite.isFirstLoad;var a="/admin/groups/"+this.userGroupData.curPage+"-"+this.userGroupData.pageSize;this.$axios({url:a,method:"get"}).then(function(a){t.userGroupData.body=t.userGroupData.body.concat(a.ctt.list),t.userGroupData.total=a.ctt.total,t.userGroupData.loading=!1,0==a.ctt.list.length?e&&e.complete():e&&e.loaded(),t.$nextTick(function(){t.tableHeight()})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},printUser:function(e){var t=this;this.userData.loading=!0,this.$axios({url:"/admin/dept/"+e+"/users/"+this.userData.curPage+"-"+this.userData.pageSize,method:"get"}).then(function(a){t.userData.groupId=e,t.userData.body=a.ctt.list,t.userData.total=a.ctt.total,t.userData.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},handleSysAdminAdd:function(){this.$refs.editUserGroup.handleUserGroupAdd()},handleUserGroupEditSubmit:function(e,t){var a=this;this.userData.loading=!0,this.$axios({url:"/admin/dept/"+t.id+"/users/"+this.userData.curPage+"-"+this.userData.pageSize,method:"get"}).then(function(e){a.userData.groupId=t.id,a.userData.body=e.ctt.list,a.userData.total=e.ctt.total,a.userData.loading=!1,a.$refs.editUserGroup.handleUserGroupEdit(t,a.userData)}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},handleUserGroupDeleteSubmit:function(e,t){var a=this;this.$confirm("确认删除该用户组?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var e=Object.assign({},t);a.$axios({url:"/admin/group/"+e.id,method:"delete",data:e}).then(function(e){0===e.c?a.$message({message:"用户组已删除",type:"success"}):a.$message.error(e.msg),a.refresh()})}).catch(function(){})},deleteUserByGroup:function(e){var t=this;this.$confirm("确认从当前用户组中删除该成员?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){t.userData.loading=!0,t.$axios({url:"/admin/group/"+t.userData.groupId+"/user/"+e,method:"delete"}).then(function(e){t.userData.loading=!1,t.$message({message:"删除成功",type:"success"}),t.printUser(t.userData.groupId)}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})}).catch(function(){})}}},r=(a("Ik9H"),Object(s.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"lyq-qunguanli"}}),e._v("  项目组")],1)])]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline",plain:""},on:{click:e.handleSysAdminAdd}},[e._v("新增用户组")])],1)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("split-pane",{ref:"split",attrs:{split:"vertical",className:e.splitClass,defaultPercent:70},nativeOn:{mousedown:function(t){return e.onMouseDown(t)},mouseup:function(t){return e.onMouseUp(t)}}},[a("template",{slot:"paneL"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.userGroupData.loading,expression:"userGroupData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.userGroupData.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.userGroupData.height,"highlight-current-row":""},on:{"current-change":e.onClickUserGroup}},[a("el-table-column",{attrs:{prop:"name",label:"项目组名称",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑项目组",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-guanli_danse",circle:""},on:{click:function(a){e.handleUserGroupEditSubmit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除项目组",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},on:{click:function(a){e.handleUserGroupDeleteSubmit(t.$index,t.row)}}})],1)],1)]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1)],1),e._v(" "),a("template",{slot:"paneR"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.userData.loading,expression:"userData.loading"}],ref:"userTable",staticClass:"custom-table-cell",attrs:{data:e.userData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.userGroupData.height}},[a("el-table-column",{attrs:{prop:"name",label:"用户名字",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除用户",placement:"right"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-yonghushanchu",circle:""},on:{click:function(a){e.deleteUserByGroup(t.row.id)}}})],1)],1)]}}])})],1)],1)],1)],2)],1),e._v(" "),a("edit-user-group",{ref:"editUserGroup",attrs:{"add-user":e.refresh,"edit-user":e.refresh}})],1)},[],!1,null,"d3e9c9be",null));t.default=r.exports},pmdA:function(e,t,a){"use strict";var i=a("eYmZ");a.n(i).a},pqbm:function(e,t,a){},pwrt:function(e,t,a){"use strict";var i=a("rdlN");a.n(i).a},qfG7:function(e,t,a){"use strict";var i=a("dpPX");a.n(i).a},qr45:function(e,t,a){},qsM7:function(e,t,a){"use strict";var i=a("CAaF");a.n(i).a},qunu:function(e,t,a){"use strict";var i=a("fO0c");a.n(i).a},"r/9I":function(e,t,a){"use strict";var i=a("zoVh"),s=a("kLgE"),n=(a("CAgN"),a("bZsl")),o=a("26K/"),l={name:"Preview",components:{AppFrame:i.a,PreviewDatabase:o.a},data:function(){return{viewImageUrl:this.$upload+"/setting/getLogoImg?seed=",appFrameHeight:"85vh",pdf:{url:this.$pdf},formPreview:{title:"预览",data:{id:0,name:"",suffix:"",seq:"",size:"",comment:"",url:"",pdfDoc:null,canvasData:[]},visible:!1},formHistory:{title:"文件版本履历",data:{id:0,name:"",list:[]},visible:!1},formLiteratureHistory:{title:"文件版本履历",data:{id:0,name:"",fileMetadataHistoryList:[],fileAccessoryHistoryList:[],dbId:0,dbName:""},visible:!1},formActionHistory:{title:"文件查看和下载履历",data:{id:0,name:"",list:[]},visible:!1},imagePreview:{src:"",viewer:""},isFullScreen:!1,dialogHeight:0}},mounted:function(){this.imagePreview.viewer=new s.a(document.getElementById("image"),{toolbar:{zoomIn:4,zoomOut:4,oneToOne:4,reset:4,rotateLeft:4,rotateRight:4,flipHorizontal:4,flipVertical:4}})},methods:{handlePreview:function(e){var t=this,a=0,i="/user/file/"+(a=e.resourceId>0?e.resourceId:e.id)+"/seq/0/preview";e.nextId&&(i="/user/file/"+a+"/accessory/"+e.nextId+"/seq/0/preview"),this.$axios({url:i,method:"get"}).then(function(e){if(0===e.c){if(!1===e.ctt.permissionMap.visible||!1===e.ctt.permissionMap.read)return void t.$message.error("您没有查看文件的权限！请联系文件夹管理员！");t.formPreview.data={id:e.ctt.id,name:e.ctt.name+"."+e.ctt.suffix,suffix:e.ctt.suffix,seq:0,comment:e.ctt.comment,size:e.ctt.size,url:e.ctt.url.url},t.showPreview()}else 6001===e.c&&t.$message.warning("文件已被删除，不能查看！")})},handleLiteratureAccessory:function(e){var t=this;this.$axios({url:"/user/file/"+e.id+"/seq/"+e.id+"/Literature/preview",method:"get"}).then(function(e){t.formPreview.data={suffix:e.ctt.suffix,url:e.ctt.url.url,name:e.ctt.name+"."+e.ctt.suffix},t.$refs.appFrameLiterature&&t.$refs.appFrameLiterature.loadFile(t.formPreview.data.suffix,t.formPreview.data.url)})},handleLiteraturePreview:function(e){var t=this;this.$axios({url:"/user/file/"+e.fileId+"/seq/"+e.seq,method:"get"}).then(function(e){null===e.ctt.fileMetadataHistoryDto&&t.$message.warning("该数据为旧版系统数据，不能查看！"),t.formLiteratureHistory.data.fileAccessoryHistoryList=e.ctt.fileAccessoryHistoryDto.filter(function(e){return 2!==e.type}),t.formLiteratureHistory.data.fileMetadataHistoryList=e.ctt.fileMetadataHistoryDto;var a=e.ctt.fileAccessoryHistoryDto.filter(function(e){return 2===e.type});a&&(t.formLiteratureHistory.data.dbId=a[0].saveId,t.formLiteratureHistory.data.dbName=a[0].name),t.formLiteratureHistory.data.fileMetadataHistoryList.forEach(function(e){7===e.dataType&&""!=e.value?e.valueData=Object(n.formatDateTime)(e.value,"年月日"):e.valueData=e.value}),t.formLiteratureHistory.visible=!0,6001===e.c&&t.$message.warning("文件已被删除，不能查看！")})},selectReviewDB:function(){this.$refs.appFrame&&(this.$refs.appFrame.isShow=!1),this.$refs.previewDatabase.dbId=this.formLiteratureHistory.data.dbId,this.$refs.previewDatabase.dbName=this.formLiteratureHistory.data.dbName,this.$refs.previewDatabase.visible=!0},showPreview:function(){switch(this.formPreview.data.suffix.toLowerCase()){case"jpg":case"jpeg":case"png":case"bmp":case"gif":this.imagePreview.src=this.formPreview.data.url,this.imagePreview.viewer.show();break;default:this.formPreview.visible=!0,this.$refs.appFrame&&this.$refs.appFrame.loadFile(this.formPreview.data.suffix,this.formPreview.data.url)}},handleHistoryPreview:function(e){var t=this;this.$axios({url:"/user/file/"+e.fileId+"/seq/"+e.seq+"/preview",method:"get"}).then(function(e){t.formPreview.data={id:e.ctt.id,name:e.ctt.name+"."+e.ctt.suffix,suffix:e.ctt.suffix,seq:0,comment:e.ctt.comment,size:e.ctt.size,url:e.ctt.url.url},t.formPreview.visible=!0,t.$refs.appFrame&&t.$refs.appFrame.loadFile(t.formPreview.data.suffix,t.formPreview.data.url)})},handleDownloadSubmit:function(e){var t=this;this.$confirm("开始下载吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){t.$axios({url:"user/file/"+e.fileId+"/seq/"+e.seq+"/download",method:"get"}).then(function(a){a?9!==a.status?window.location.href=t.$upload+"/user/file/download/"+e.fileId+"/"+a.guid:t.$message({message:"文件已经删除，不能下载",type:"error"}):t.$message({message:"下载失败",type:"error"})})})},handleDownloadResource:function(e){var t=this;this.$confirm("开始下载吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){t.$axios({url:"user/file/"+e.saveId+"/download",method:"get",responseType:"blob"}).then(function(a){if(a){var i=new Blob([a]),s=e.name+"."+e.suffix;if("download"in document.createElement("a")){var n=document.createElement("a");n.download=s,n.style.display="none",n.href=URL.createObjectURL(i),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else console.log(i),navigator.msSaveBlob(i,s)}else t.$message({message:"下载失败",type:"error"})})})},handleHistory:function(e){var t=this;this.$axios({url:"/user/file/"+e.id,method:"get"}).then(function(e){t.formHistory.title="文件版本履历",t.formHistory.data={id:e.ctt.id,name:e.ctt.suffix?e.ctt.name+"."+e.ctt.suffix:e.ctt.name,list:e.ctt.fileHistoryDto},console.log(t.formHistory.data),t.formHistory.visible=!0})},handleActionHistory:function(){var e=this;this.$axios({url:"/user/file/"+this.formHistory.data.id+"/actionhistory",method:"get"}).then(function(t){e.formActionHistory.visible=!0,e.formActionHistory.data={id:e.formHistory.data.id,name:e.formHistory.data.name,list:t.ctt}})},historyDateFormat:function(e){var t=e.updateDate;return this.dateFormat(t)},dateFormat:function(e){return e?this.$moment(e).format("YYYY年MM月DD日 HH:mm"):""},historyCommentFormat:function(e){var t=null==e.comment?"":e.comment;return t.length>5?t.substr(0,5)+"...":t},formPreviewOpened:function(){this.$refs.appFrame.loaded||this.$refs.appFrame.loadFile(this.formPreview.data.suffix,this.formPreview.data.url)},handleCloseDialog:function(){this.formPreview.visible=!1,this.formLiteratureHistory.visible=!1,this.isFullScreen=!1},handleChangeMaxMinDialog:function(){this.isFullScreen=!this.isFullScreen,this.isFullScreen?this.appFrameHeight="calc(100vh - 60px)":this.appFrameHeight="85vh"}}},r=(a("aq6f"),a("Cq+a"),a("KHd+")),c=Object(r.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{display:"none"}},[a("div",[a("img",{attrs:{id:"image",src:e.imagePreview.src,alt:"Picture"}})])]),e._v(" "),a("el-dialog",{attrs:{title:e.formHistory.title,visible:e.formHistory.visible,"close-on-click-modal":!0,width:"800px"},on:{"update:visible":function(t){e.$set(e.formHistory,"visible",t)}}},[a("el-form",{ref:"formHistoryData",attrs:{model:e.formHistory.data,"label-width":"200px"}},[a("P",{staticStyle:{"line-height":"50px",color:"#000000","font-size":"16px"}},[e._v(e._s(e.formHistory.data.name))])],1),e._v(" "),a("el-table",{staticClass:"custom-table-cell",staticStyle:{width:"100%"},attrs:{data:e.formHistory.data.list}},[a("el-table-column",{attrs:{prop:"seq",label:"版本",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"最后更新者",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{formatter:e.historyDateFormat,prop:"updateDate",label:"最后更新日期",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"size",label:"文件大小",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"版本描述",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.row.comment))]),e._v(" "),a("div",[e._v(e._s(e.historyCommentFormat(t.row))+"\n                        ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.suffix?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"el-icon-view",circle:""},on:{click:function(a){e.handleHistoryPreview(t.row)}}})],1):e._e(),e._v(" "),t.row.suffix?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"el-icon-download",circle:""},on:{click:function(a){e.handleDownloadSubmit(t.row)}}})],1):e._e(),e._v(" "),t.row.suffix?e._e():a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"el-icon-view",circle:""},on:{click:function(a){e.handleLiteraturePreview(t.row)}}})],1)]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.formActionHistory.title,visible:e.formActionHistory.visible,"append-to-body":"",width:"500px"},on:{"update:visible":function(t){e.$set(e.formActionHistory,"visible",t)}}},[a("el-table",{staticClass:"custom-table-cell",staticStyle:{width:"100%"},attrs:{data:e.formActionHistory.data.list,height:"400px"}},[a("el-table-column",{attrs:{prop:"seq",label:"序号",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"操作者",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{formatter:e.historyDateFormat,prop:"updateDate",label:"操作日期",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"actionName",label:"操作行为",width:"110",align:"center"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.formActionHistory.visible=!1}}},[e._v("关闭")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleActionHistory}},[e._v("查看和下载履历")]),e._v(" "),a("el-button",{on:{click:function(t){e.formHistory.visible=!1}}},[e._v("关闭")])],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"文献数据",fullscreen:e.isFullScreen,visible:e.formLiteratureHistory.visible,"show-close":!1,"close-on-click-modal":!1,width:"1200px",top:"10px"},on:{"update:visible":function(t){e.$set(e.formLiteratureHistory,"visible",t)}}},[a("div",{staticClass:"custom-title-container",attrs:{slot:"title"},slot:"title"},[a("span"),e._v(" "),a("span",{staticClass:"custom-title"},[e._v("文献数据")]),e._v(" "),a("span",{staticClass:"custom-icons"},[e.isFullScreen?a("i",{on:{click:e.handleChangeMaxMinDialog}},[a("svg",{staticClass:"icon",attrs:{t:"1614587768535",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5438",width:"200",height:"200"}},[a("path",{attrs:{d:"M449.92 543.36C449.92 520.96 431.36 512 410.24 512L97.92 512c-17.92 0-32 14.08-32 32 0 17.92 14.08 32 32 32l242.56 0-267.52 267.52c-12.16 12.16-12.16 31.36 0 43.52 12.16 12.16 31.36 12.16 43.52 0l269.44-269.44 0 246.4c0 17.92 14.08 32 32 32 17.92 0 32-14.08 32-32l0-320M865.92 384 622.72 384l267.52-267.52c12.16-12.16 12.16-31.36 0-43.52-12.16-12.16-31.36-12.16-43.52 0L577.92 342.4 577.92 96C577.92 78.08 563.2 64 545.92 64c-17.92 0-32 14.08-32 32l0 320c0 0.64 0.64 1.28 0.64 1.92 0 8.32 2.56 16.64 8.96 22.4C531.2 448.64 542.72 451.2 552.96 448l312.32 0c17.92 0 32-14.08 32-32C897.92 398.08 883.2 384 865.92 384z","p-id":"5439",fill:"#ffffff"}})])]):a("i",{on:{click:e.handleChangeMaxMinDialog}},[a("svg",{staticClass:"icon",attrs:{t:"1614587805849",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5979",width:"200",height:"200"}},[a("path",{attrs:{d:"M444.3 539.9L202 782.2 199.8 563c0-16.5-13.5-30-30-30s-30 13.5-30 30l2.2 285.1c0 8.8 3.8 16.7 9.8 22.2 5.5 6 13.4 9.8 22.2 9.8h295.6c16.5 0 30-13.5 30-30s-13.5-30-30-30H248.9l237.8-237.8c11.7-11.7 11.7-30.8 0-42.4-11.6-11.6-30.7-11.6-42.4 0zM578.1 488l242.3-242.3 2.2 219.2c0 16.5 13.5 30 30 30s30-13.5 30-30l-2.2-285.1c0-8.8-3.8-16.7-9.8-22.2-5.5-6-13.4-9.8-22.2-9.8H552.8c-16.5 0-30 13.5-30 30s13.5 30 30 30h220.7L535.7 445.6c-11.7 11.7-11.7 30.8 0 42.4 11.7 11.7 30.8 11.7 42.4 0z","p-id":"5980",fill:"#ffffff"}})])]),e._v(" "),a("i",{staticClass:"el-icon-close",on:{click:e.handleCloseDialog}})])]),e._v(" "),a("div",{staticClass:"fxl",staticStyle:{width:"100%"}},[a("div",{staticClass:"fxl",staticStyle:{width:"50%"}},[a("el-form",{staticClass:"preview-item-content-expand",staticStyle:{width:"60%"},attrs:{inline:""}},[e._l(this.formLiteratureHistory.data.fileMetadataHistoryList,function(t,i){return[a("el-form-item",{key:i,attrs:{label:t.name}},[a("span",[e._v(e._s(t.valueData))])])]})],2),e._v(" "),a("div",{staticStyle:{position:"relative",bottom:"14px",width:"38%"}},[e._l(this.formLiteratureHistory.data.fileAccessoryHistoryList,function(t,i){return a("div",{key:i,staticClass:"resource-file-list"},[a("div",{staticClass:"word-hidden finger",staticStyle:{color:"#409EFF","font-size":"14px"},on:{click:function(a){e.handleLiteratureAccessory(t)}}},[a("app-svg",{attrs:{iconText:t.suffix}}),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:t.name+"."+t.suffix,placement:"bottom"}},[a("span",[e._v(e._s(t.name)+"."+e._s(t.suffix))])])],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载文件",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",staticStyle:{"font-size":"20px"},attrs:{type:"text",size:"medium",icon:"iconfont icon-caozuo-shangchuan-download",circle:""},on:{click:function(a){e.handleDownloadResource(t)}}})],1)],1)}),e._v(" "),this.formLiteratureHistory.data.dbName?a("div",{staticClass:"resource-file-list"},[a("div",{staticClass:"word-hidden finger",staticStyle:{color:"#409EFF","font-size":"14px"},on:{click:e.selectReviewDB}},[a("svg",{staticClass:"icon",attrs:{t:"1614846486792",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1852",width:"1.2rem",height:"1.2rem"}},[a("path",{attrs:{d:"M858.2 766.3V616.7c-22.1 19.3-47 35.2-73.7 47.2-86.5 38-180 57.2-274.5 56.3-122 7.1-242.8-27-343.1-96.7v150.7C173.7 840 318.8 912 512.3 912c193.5 0 337.5-72.6 345.9-138.9v-6.8z","p-id":"1853",fill:"#0072D9"}}),a("path",{attrs:{d:"M858.2 507v-2.8 6.8c-8.4 66.4-152.4 138.9-345.9 138.9-193.5 0-338.6-72-345.4-137.8V361.3C267.2 431.1 388 465.1 510 458c94.5 0.9 188-18.2 274.5-56.3 26.7-12.1 51.6-28 73.7-47.2V507z","p-id":"1854",fill:"#0072D9"}}),a("path",{attrs:{d:"M762.6 160.5c57.4 25.3 91.7 61.3 91.7 93.4 0 31.5-35.4 66.4-91.7 93.4-80 34-166.2 50.7-253.1 48.9-196.9 0-343.7-74.8-343.7-141.7s147.4-142.3 344.8-142.3c86.5-1.9 172.3 14.6 252 48.3z","p-id":"1855",fill:"#0072D9"}})]),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:this.formLiteratureHistory.data.dbName,placement:"bottom"}},[a("span",[e._v(e._s(this.formLiteratureHistory.data.dbName))])])],1)]):e._e()],2)],1),e._v(" "),a("div",{staticStyle:{width:"50%"}},[a("app-frame",{ref:"appFrameLiterature",attrs:{height:"calc("+e.appFrameHeight+" - 60px)",suffix:e.formPreview.data.suffix,"file-url":e.formPreview.data.url}})],1)])]),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{fullscreen:e.isFullScreen,"show-close":!1,title:e.formPreview.title+":"+e.formPreview.data.name,visible:e.formPreview.visible,"close-on-click-modal":!1,top:"10px","custom-class":"custom-dialog"},on:{"update:visible":function(t){e.$set(e.formPreview,"visible",t)},opened:e.formPreviewOpened}},[a("div",{staticClass:"custom-title-container",attrs:{slot:"title"},slot:"title"},[a("span"),e._v(" "),a("span",{staticClass:"custom-title word-hidden"},[a("el-tooltip",{attrs:{content:e.formPreview.data.name,placement:"bottom"}},[a("span",[e._v(e._s(e.formPreview.title+":"+e.formPreview.data.name))])])],1),e._v(" "),a("span",{staticClass:"custom-icons"},[e.isFullScreen?a("i",{on:{click:e.handleChangeMaxMinDialog}},[a("svg",{staticClass:"icon",attrs:{t:"1614587768535",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5438",width:"200",height:"200"}},[a("path",{attrs:{d:"M449.92 543.36C449.92 520.96 431.36 512 410.24 512L97.92 512c-17.92 0-32 14.08-32 32 0 17.92 14.08 32 32 32l242.56 0-267.52 267.52c-12.16 12.16-12.16 31.36 0 43.52 12.16 12.16 31.36 12.16 43.52 0l269.44-269.44 0 246.4c0 17.92 14.08 32 32 32 17.92 0 32-14.08 32-32l0-320M865.92 384 622.72 384l267.52-267.52c12.16-12.16 12.16-31.36 0-43.52-12.16-12.16-31.36-12.16-43.52 0L577.92 342.4 577.92 96C577.92 78.08 563.2 64 545.92 64c-17.92 0-32 14.08-32 32l0 320c0 0.64 0.64 1.28 0.64 1.92 0 8.32 2.56 16.64 8.96 22.4C531.2 448.64 542.72 451.2 552.96 448l312.32 0c17.92 0 32-14.08 32-32C897.92 398.08 883.2 384 865.92 384z","p-id":"5439",fill:"#ffffff"}})])]):a("i",{on:{click:e.handleChangeMaxMinDialog}},[a("svg",{staticClass:"icon",attrs:{t:"1614587805849",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5979",width:"200",height:"200"}},[a("path",{attrs:{d:"M444.3 539.9L202 782.2 199.8 563c0-16.5-13.5-30-30-30s-30 13.5-30 30l2.2 285.1c0 8.8 3.8 16.7 9.8 22.2 5.5 6 13.4 9.8 22.2 9.8h295.6c16.5 0 30-13.5 30-30s-13.5-30-30-30H248.9l237.8-237.8c11.7-11.7 11.7-30.8 0-42.4-11.6-11.6-30.7-11.6-42.4 0zM578.1 488l242.3-242.3 2.2 219.2c0 16.5 13.5 30 30 30s30-13.5 30-30l-2.2-285.1c0-8.8-3.8-16.7-9.8-22.2-5.5-6-13.4-9.8-22.2-9.8H552.8c-16.5 0-30 13.5-30 30s13.5 30 30 30h220.7L535.7 445.6c-11.7 11.7-11.7 30.8 0 42.4 11.7 11.7 30.8 11.7 42.4 0z","p-id":"5980",fill:"#ffffff"}})])]),e._v(" "),a("i",{staticClass:"el-icon-close",on:{click:e.handleCloseDialog}})])]),e._v(" "),a("el-form",{ref:"formPreviewData",staticStyle:{height:"100%"},attrs:{model:e.formPreview.data}},[a("app-frame",{ref:"appFrame",attrs:{height:e.appFrameHeight+"",suffix:e.formPreview.data.suffix,"file-url":e.formPreview.data.url}})],1)],1),e._v(" "),a("preview-database",{ref:"previewDatabase"})],1)},[],!1,null,"63d3e2f7",null);t.a=c.exports},"r/zx":function(e,t,a){"use strict";var i;function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var n={name:"UploadFile",props:{uploaded:{type:Function,default:null}},computed:{token:function(){return{Authorization:"Bearer "+this.$store.state.auth.token}}},data:function(){return{folderClear:!0,parentFolder:{files:[]},upload:{url:this.$upload,size:this.$maxFileSize},settingTable:{height:0,body:[],total:0,loading:!1,selected:null,multipleSelection:[],settingDetailTable:{isNew:!0,title:"编辑送信用户组",data:{id:0,name:""},rules:{name:[{required:!0,message:"请输入用户组名称",trigger:"blur"}]},visible:!1},submit:{id:0,name:"",kind:"",status:0,details:[]}},deptTree:{data:[],props:{children:"children",label:"name"},loading:!1,selected:null},memberTable:{height:0,body:[],total:0,loading:!1,selected:null},selectedTable:{height:0,body:[],loading:!1,selected:null,changeSelectedDept:!1},paginationData:{pageSize:1e3,total:0,curPage:1},formFile:{isNew:!1,title:"",action:"",visible:!1,loading:!1,data:{id:0,fileName:"",folderId:0,folderName:"",comment:""},fileList:[],uploadFileList:[]}}},methods:(i={handleUploadFile:function(e,t,a){this.formFile.title="文档上传",this.formFile.isNew=!0;for(var i=0;i<t.length;i++)"file"===t[i].kind&&this.parentFolder.files.push(t[i].name+"."+t[i].suffix);this.upload.size=a,this.formFile.data={id:0,fileName:"",folderName:e.name,folderId:e.id,comment:""},this.printUserSetting(),this.$refs.formFileData&&this.$refs.formFileData.resetFields(),this.$refs.uploadFile&&this.$refs.uploadFile.clearFiles(),this.formFile.visible=!0},createRequestParam:function(){for(var e="?send=",t=0;t<this.settingTable.multipleSelection.length;t++)e+=this.settingTable.multipleSelection[t].id+"_";return e+="&comment="+this.formFile.data.comment},handleAddFileSubmit:function(){var e=this;if(this.fileValidate()){for(var t=!1,a=0;a<this.formFile.uploadFileList.length;a++)for(var i=0;i<this.parentFolder.files.length;i++)if(this.formFile.uploadFileList[a].name===this.parentFolder.files[i]){t=!0;break}t?this.$confirm("发现有同名的文件在作为新文件上传！<br>选择【版本更新】将更新同名文件的最新版本<br>选择【新文件】将作为新文件上传。","提示",{dangerouslyUseHTMLString:!0,cancelButtonClass:"btn-custom-cancel",confirmButtonText:"版本更新",cancelButtonText:"新文件",type:"warning"}).then(function(){e.onUploadFileProcess("确认更新同名文件的最新版本吗？",e.upload.url+"/user/folder/"+e.formFile.data.folderId+"/update"+e.createRequestParam())}).catch(function(){e.onUploadFileProcess("确认把同名文件作为新文件上传吗？",e.upload.url+"/user/folder/"+e.formFile.data.folderId+"/file"+e.createRequestParam())}):this.onUploadFileProcess("确认上传新文件吗？",this.upload.url+"/user/folder/"+this.formFile.data.folderId+"/file"+this.createRequestParam())}},onUploadFileProcess:function(e,t){var a=this;this.formFile.action=t,this.$refs.formFileData.validate(function(t){t&&a.$confirm(e,"提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){a.formFile.loading=!0,a.$refs.uploadFile.submit()}).catch(function(){})})},handleEditFile:function(e,t){this.formFile.title="文档更新",this.formFile.isNew=!1,this.formFile.visible=!0,this.formFile.data={id:e.id,fileName:e.name+"."+e.suffix,folderName:t.name,folderId:t.id,comment:""},this.printUserSetting(),this.$refs.formFileData&&this.$refs.formFileData.resetFields(),this.$refs.uploadFile&&this.$refs.uploadFile.clearFiles()}},s(i,"handleEditFile",function(e){this.formFile.title="文档更新",this.formFile.isNew=!1,this.formFile.visible=!0,this.formFile.data={id:e.id,fileName:e.name+"."+e.suffix,folderName:e.parentPathName,comment:""},this.printUserSetting(),this.$refs.formFileData&&this.$refs.formFileData.resetFields(),this.$refs.uploadFile&&this.$refs.uploadFile.clearFiles()}),s(i,"handleEditFileSubmit",function(){var e=this;this.fileValidate()&&(this.formFile.action=this.upload.url+"/user/file/"+this.formFile.data.id+"/upload"+this.createRequestParam(),this.$refs.formFileData.validate(function(t){t&&e.$confirm("确认更新同名文件的最新版本吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formFile.loading=!0,e.$refs.uploadFile.submit()}).catch(function(){})}))}),s(i,"onFileChange",function(e,t){if(!this.checkFileSize(e))return this.$message.error("上传文件大小不能超过 "+this.upload.size+"MB!"),void this.$refs.uploadFile.uploadFiles.pop();this.formFile.uploadFileList=t}),s(i,"onFileRemove",function(e,t){this.formFile.uploadFileList=t}),s(i,"onUploadSuccess",function(e,t,a){this.$message.success("文件上传完成"),this.uploaded(),this.formFile.loading=!1,this.formFile.visible=!1,console.log("上传文件",e)}),s(i,"onUploadError",function(e,t,a){this.$message.error("上传失败，请重试！"),this.uploaded(),this.formFile.loading=!1,this.formFile.visible=!1,console.log("上传失败")}),s(i,"handleDownloadSubmit",function(e){var t=this;this.$confirm("开始下载吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){t.$axios({url:"user/file/"+e.id+"/seq/0/download",method:"get"}).then(function(a){a?window.location.href=t.$upload+"/user/file/download/"+e.id+"/"+a.guid:t.$message({message:"下载失败",type:"error"})})})}),s(i,"printUserSetting",function(){var e=this;this.$axios({url:"/user/setting/senduser",method:"get"}).then(function(t){e.settingTable.body=t.ctt}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})}),s(i,"handleEditSendUser",function(e){var t=this;this.settingTable.settingDetailTable.visible=!0,this.settingTable.settingDetailTable.isNew=!0,e&&(this.settingTable.settingDetailTable.data.id=e.id,this.settingTable.settingDetailTable.data.name=e.name,this.settingTable.settingDetailTable.isNew=!1,this.$axios({url:"/user/setting/"+e.id+"/detail",method:"get"}).then(function(e){t.selectedTable.body=e.ctt}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)}))}),s(i,"handleCloseSendUser",function(){this.settingTable.settingDetailTable.data.id=0,this.settingTable.settingDetailTable.data.name="",this.memberTable.body=[],this.memberTable.selected=null,this.selectedTable.body=[],this.selectedTable.selected=null,this.settingTable.settingDetailTable.visible=!1}),s(i,"handleSaveSendUser",function(){var e=this;if(this.settingTable.settingDetailTable.data.name.trim())if(new RegExp("[/:*?'\"<>|\\\\]").test(this.settingTable.settingDetailTable.data.name.trim()))this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|");else if(this.selectedTable.body&&0!==this.selectedTable.body.length){for(var t=[],a=0;a<this.selectedTable.body.length;a++)t.push({code:this.selectedTable.body[a].id,value:this.selectedTable.body[a].name});this.settingTable.submit={id:this.settingTable.settingDetailTable.data.id,name:this.settingTable.settingDetailTable.data.name,kind:"senduser",status:1,details:t};var i="",s="";this.settingTable.settingDetailTable.isNew?(i="确认新增["+this.settingTable.submit.name+"]用户组吗?",s="post"):(i="确认编辑["+this.settingTable.submit.name+"]用户组吗?",s="put"),this.$confirm(i,"提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.$axios({url:"/user/setting",method:s,data:e.settingTable.submit}).then(function(t){0===t.c?e.$message.success("新增用户组成功！"):e.$message.error(t.msg),e.printUserSetting(),e.handleCloseSendUser()})}).catch(function(){})}else this.$message.error("请选择用户组成员！");else this.$message.error("请输入用户组名称！")}),s(i,"handleDeleteSendUser",function(e){var t=this;this.$confirm("确认删除该用户组?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var a=Object.assign({},e);t.$axios({url:"/user/setting",method:"delete",data:a}).then(function(e){0===e.c?t.$message({message:"用户组已删除",type:"success"}):t.$message.error(e.msg),t.printUserSetting()})}).catch(function(){})}),s(i,"printDept",function(){var e=this;this.deptTree.loading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),e.deptTree.data=a,e.deptTree.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})}),s(i,"selectDept",function(e){this.deptTree.selected=e,this.printUser(e),this.selectedTable.changeSelectedDept=!0}),s(i,"printUser",function(e){var t=this;this.memberTable.loading=!0,this.$axios({url:"/admin/dept/"+e.id+"/users/"+this.paginationData.curPage+"-"+this.paginationData.pageSize,method:"get"}).then(function(e){t.memberTable.body=e.ctt.list,t.paginationData.total=e.ctt.total,t.memberTable.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})}),s(i,"addUserToGroup",function(e){for(var t=0;t<this.selectedTable.body.length;t++)if(this.selectedTable.body[t].id===e.id)return void this.$message.warning("成员已在组内，不能再次添加！");this.selectedTable.body.push(e)}),s(i,"removeUserFromGroup",function(e){for(var t=0;t<this.selectedTable.body.length;t++)if(this.selectedTable.body[t].id===e.id)return void this.selectedTable.body.splice(t,1)}),s(i,"handleSelectionChange",function(e){this.settingTable.multipleSelection=e}),s(i,"checkFileSize",function(e){return e.size/1024/1024<=this.upload.size}),s(i,"fileValidate",function(){var e=this;return 0===this.formFile.uploadFileList.length?(this.$message.error("请选择上传文件"),!1):(this.formFile.uploadFileList.forEach(function(t){if(!e.checkFileSize(t))return e.$message.error("上传文件大小不能超过 "+e.upload.size+"MB!"),!1}),!0)}),i)},o=(a("2h3Y"),a("KHd+")),l=Object(o.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.formFile.title,visible:e.formFile.visible,"close-on-click-modal":!1,width:"400px"},on:{"update:visible":function(t){e.$set(e.formFile,"visible",t)}}},[a("el-form",{ref:"formFileData",attrs:{model:e.formFile.data}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple-dark"},[a("el-upload",{ref:"uploadFile",staticClass:"upload-demo",attrs:{drag:"",multiple:"","auto-upload":!1,headers:e.token,"file-list":e.formFile.fileList,action:e.formFile.action,"on-change":e.onFileChange,"on-remove":e.onFileRemove,onSuccess:e.onUploadSuccess,onError:e.onUploadError}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("文件大小不能超过"+e._s(this.upload.size)+"MB")])])],1)])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple-dark"},[a("P",{staticStyle:{"line-height":"50px",color:"#2F5A74","font-size":"16px"}},[e._v("上传目录：")])],1)]),e._v(" "),a("el-col",{attrs:{span:18}},[a("div",{staticClass:"grid-content bg-purple-dark"},[a("P",{staticStyle:{"line-height":"50px",color:"#E51C23","font-size":"20px"}},[e._v(e._s(e.formFile.data.folderName))])],1)])],1),e._v(" "),e.formFile.isNew?e._e():a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple-dark"},[a("P",{staticStyle:{"line-height":"40px",color:"#2F5A74","font-size":"16px"}},[e._v("文件名：")]),e._v(" "),a("P",{staticStyle:{"line-height":"40px",color:"#20A0FF","font-size":"20px"}},[e._v(e._s(e.formFile.data.fileName))])],1)])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple-dark"},[a("el-form-item",{attrs:{label:"版本描述",prop:"name"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.formFile.data.comment,callback:function(t){e.$set(e.formFile.data,"comment",t)},expression:"formFile.data.comment"}})],1)],1)])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"通知用户组编辑",visible:e.settingTable.settingDetailTable.visible,modal:!1,width:"1000px"},on:{"update:visible":function(t){e.$set(e.settingTable.settingDetailTable,"visible",t)},open:e.printDept}},[a("el-form",{ref:"settingDetail",attrs:{model:e.settingTable.settingDetailTable.data,"label-width":"80px",rules:e.settingTable.settingDetailTable.rules}},[a("el-row",{staticStyle:{"min-height":"460px",height:"460px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"460px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTree.loading,expression:"deptTree.loading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptTree.data,"highlight-current":"",props:e.deptTree.props,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.selectDept},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:16}},[a("el-row",[a("el-form-item",{attrs:{"label-width":"120px",label:"编辑用户组名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.settingTable.settingDetailTable.data.name,callback:function(t){e.$set(e.settingTable.settingDetailTable.data,"name",t)},expression:"settingTable.settingDetailTable.data.name"}})],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.memberTable.loading,expression:"memberTable.loading"}],ref:"memberTable",staticClass:"custom-table-cell",attrs:{data:e.memberTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",border:"",height:"400px"}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"增加成员",placement:"right"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"el-icon-d-arrow-right",circle:""},on:{click:function(a){e.addUserToGroup(t.row)}}})],1)],1)]}}])})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.selectedTable.loading,expression:"selectedTable.loading"}],ref:"selectedTable",staticClass:"custom-table-cell",attrs:{data:e.selectedTable.body,"cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},"highlight-current-row":"",border:"",height:"400px"}},[a("el-table-column",{attrs:{prop:"name",label:"已选择用户"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除成员",placement:"right"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-yonghushanchu",circle:""},on:{click:function(a){e.removeUserFromGroup(t.row)}}})],1)],1)]}}])})],1)],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSaveSendUser()}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.handleCloseSendUser()}}},[e._v("关闭")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.formFile.isNew?a("el-button",{attrs:{type:"primary",loading:e.formFile.loading},nativeOn:{click:function(t){return e.handleAddFileSubmit(t)}}},[e._v("上传")]):e._e(),e._v(" "),e.formFile.isNew?e._e():a("el-button",{attrs:{type:"primary",loading:e.formFile.loading},nativeOn:{click:function(t){return e.handleEditFileSubmit(t)}}},[e._v("提交")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formFile.visible=!1}}},[e._v("关闭")])],1)],1)],1)},[],!1,null,null,null);t.a=l.exports},rRse:function(e,t,a){"use strict";a.r(t);var i=a("26K/"),s=a("uZRj"),n=a("r/zx"),o=a("gCzg"),l=a("r/9I"),r=a("bZsl"),c=a("L2JU"),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},u={components:{editFolder:s.a,uploadFile:n.a,linkFile:o.a,preview:l.a,PreviewDatabase:i.a},computed:d({},Object(c.c)({getClusterName:"constant/getClusterName"})),name:"message",data:function(){return{viewImageUrl:this.$upload+"/setting/getLogoImg?seed=",searchTxt:"",searchKey:"",searchTable:{loading:!1,data:[],height:0,pageSize:5,total:0,curPage:0,multipleSelection:[],body:[]},tagBar:{loading:!0,body:[],inputVisible:!1,inputValue:""},activeCollapse:[],clusterList:[],clusterParamList:[],paramStr:"",clusterParamShow:!1,activeName:["author","authorUnit","projectName","keyword","docType"],yLabel:""}},mounted:function(){this.searchKey=this.$route.query.searchKey,this.getTag()},methods:d({},Object(c.b)({curFolderAction:"folderHistory/curFolder",nextFolderAction:"folderHistory/nextFolder"}),{tableHeight:function(){this.$nextTick(function(){if(this.$refs.table){this.searchTable.height=window.innerHeight-this.$refs.table.$el.offsetTop-60;var e=this;window.onresize=function(){e.searchTable.height=window.innerHeight-e.$refs.table.$el.offsetTop-60}}})},tagSearch:function(e){this.searchKey=e,this.refresh()},getData:function(e){var t=this;this.searchTable.loading=this.$refs.infinite.isFirstLoad;var a=encodeURIComponent(this.searchKey);this.$axios({url:"/search/key/"+this.searchTable.curPage+"-"+this.searchTable.pageSize+"?key="+a+"&paramStr="+this.paramStr,method:"get"}).then(function(a){t.clusterList=a.ctt.solrFacet;for(var i=[],s=0;s<a.ctt.pageList.list.length;s++)a.ctt.pageList.list[s].permissionMap.visible&&i.push(a.ctt.pageList.list[s]);t.searchTable.body=t.searchTable.body.concat(i).map(function(e,t){var a=[],i=!1,s=[],n=null,o="";if(e.fileAccessoryDto){s=e.fileAccessoryDto.filter(function(e){return 2!==e.type});var l=e.fileAccessoryDto.find(function(e){return 2===e.type});l&&(i=!0,n=l.saveId,o=l.name)}return e.fileMetadataDto&&(a=e.fileMetadataDto.map(function(e){var t=e.value;if(7===e.dataType){var a=new Date(e.value);t=a.getFullYear()+"年"+Object(r.checkTime)(a.getMonth()+1)+"月"+Object(r.checkTime)(a.getDate())+"日"}return 6===e.dataType&&(t=1===e.value?"是":"否"),{title:e.name,content:t}})),d({},e,{key:e.kind+"-"+t+"-"+e.id,expandData:a,hasDatabase:i,dbId:n,dbName:o,appendFiles:s})}),t.searchTable.total=a.ctt.pageList.total,t.searchTable.loading=!1,0==a.ctt.pageList.list.length?e&&e.complete():e&&e.loaded(),t.$nextTick(function(){t.tableHeight(),t.initCharts(null)})}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},initCharts:function(e){if(null==e)for(var t=0;t<this.clusterList.length;t++)this.setOption(t);else this.setOption(e)},setOption:function(e){var t=this,a=[["#81B587","#77AB7D","#6DA173","#639769","#598D5F","#4F8355","#45794B"],["#6195FD","#578BF3","#4D81E9","#4377DF","#396DD5","#2F62CB","#2558C1"],["#FFB4C1","#FAAAB7","#F0A0AD","#E696A3","#DC8C99","#D2828F","#C16F7B"],["#A07FD5","#9675CB","#8C6BC1","#8261B7","#50398F","#7857AD","#6E4DA3"],["#FAB650","#F0AC46","#E6A23C","#DC9832","#D28E28","#C8841E","#BE7A14"]],i="clusterCharts_"+e,s=document.getElementById(i),n=this.$echarts.init(s),o=[["amount","product"]];for(var l in this.clusterList[e])for(var r=this.clusterList[e][l].sort(function(e,t){for(var a in e)for(var i in t)return e[a]-t[i]}),c=0;c<r.length;c++){var d=[];for(var u in r[c])r[c][u]>0&&(d.push(r[c][u]),d.push(u));d.length>0&&o.push(d)}var f={dataset:{source:o},grid:{containLabel:!1,borderWidth:0,left:"26%",bottom:"20%"},xAxis:{show:!1,name:"amount",splitLine:{show:!1}},yAxis:{type:"category",triggerEvent:!0,axisLabel:{show:!0,interval:0,rotate:0,textStyle:{color:"#333"},formatter:function(e){return void 0===e?"":e.length>4?e.substring(0,4)+"...":e}},splitLine:{show:!1},axisLine:{show:!1},axisTick:{show:!1}},series:[{type:"bar",encode:{x:"amount",y:"product"},label:{show:!0,position:"inside",color:"white"},barWidth:16,itemStyle:{normal:{color:function(t){return a[e][t.dataIndex]}},barBorderRadius:[50,50,50,50]}}],tooltip:{formatter:this.formateTooltip}};n.off("mouseover"),n.on("mouseover",function(e){if("yAxis"===e.componentType){t.yLabel=e.value;var a=e.event.offsetX+10,i=e.event.offsetY+10;n.setOption({tooltip:{formatter:t.formateTooltip,alwaysShowContent:!0}}),n.dispatchAction({type:"showTip",seriesIndex:0,dataIndex:0,position:[a,i]})}}),n.off("mouseout"),n.on("mouseout",function(e){"yAxis"===e.componentType&&(t.yLabel="",n.setOption({tooltip:{formatter:t.formateTooltip,alwaysShowContent:!1}}))}),n.off("click");var m=this;n.on("click",function(e){if(null!=e.data&&e.data.length>1)for(var t=0;t<m.clusterList.length;t++)for(var a in m.clusterList[t])for(var i=m.clusterList[t][a],s=0;s<i.length;s++)for(var n in i[s])i[s][n]>0&&e.data[1]===n&&m.clusterSearch(a,e.data[1])}),n.setOption(f);var p=50*(o.length-1)+50;n.getDom().style.height=p+"px",n.getDom().childNodes[0].style.height=p+"px",void 0!=n.getDom().childNodes[0].childNodes[0]&&(n.getDom().childNodes[0].childNodes[0].setAttribute("height",p),n.getDom().childNodes[0].childNodes[0].style.height=p+"px",n.resize())},collapseHandleChange:function(e){for(var t=this,a=function(a){for(var i in t.clusterList[a])e==i&&setTimeout(function(){t.initCharts(Number(a))},100)},i=0;i<this.clusterList.length;i++)a(i)},formateTooltip:function(e){return this.yLabel?'<div class="toolDiv">'+this.yLabel+"</div>":this.yLabel},clusterSearch:function(e,t){for(var a=0;a<this.clusterParamList.length;a++)for(var i in this.clusterParamList[a])if(i==e&&this.clusterParamList[a][i]==t)return;var s={};s[e]=t,this.clusterParamList.push(s);var n="@"+e+':"'+t+'"';this.paramStr=this.paramStr+n,this.refresh(),this.clusterParamShow=!0},removeClusterSearch:function(e,t){if(this.clusterParamList=this.clusterParamList.filter(function(a){return a[e]!=t}),this.paramStr="",0==this.clusterParamList.length)this.refresh(),this.clusterParamShow=!1;else for(var a=0;a<this.clusterParamList.length;a++)for(var i in this.clusterParamList[a]){var s="@"+i+':"'+this.clusterParamList[a][i]+'"';this.paramStr=this.paramStr+s,this.refresh(),this.clusterParamShow=!0}},dateShortFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("MM月DD日 HH:mm")},dateFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("YYYY年MM月DD日 HH:mm")},getTag:function(){var e=this;this.tagBar.loading=!0,this.$axios({url:"/user/tags",method:"get"}).then(function(t){e.tagBar.body=t.ctt,e.tagBar.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},search:function(){this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchKey=this.searchTxt.trim(),this.refresh()):this.$message.warning("请输入搜索关键词")},showInput:function(){var e=this;this.tagBar.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var e=this,t={id:0,name:this.tagBar.inputValue,type:2};t.name&&(this.tagBar.loading=!0,this.$axios({url:"/user/tag",method:"post",data:t}).then(function(a){0===a.c?(e.$message.success("已添加新标签"),t.id=a.ctt.id,e.tagBar.body.push(t),e.tagBar.loading=!1):e.$message.error(a.msg)}).catch(function(e){})),this.tagBar.inputVisible=!1,this.tagBar.inputValue=""},handleClose:function(e){var t=this;this.$confirm("删除这个标签?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){t.tagBar.loading=!0;var a=e;t.$axios({url:"user/tag",method:"delete",data:a}).then(function(a){t.tagBar.body.splice(t.tagBar.body.indexOf(e),1),t.tagBar.loading=!1})}).catch(function(){})},refresh:function(){this.searchTable.body=[],this.searchTable.curPage=0,this.$refs.infinite.stateChanger.reset()},nextPage:function(e){this.searchTable.curPage+=1,this.getData(e)},renameFolder:function(e){var t=void 0;this.searchTable.body.forEach(function(a){a.id===e.id&&a.kind===e.kind&&(t=a)}),t&&(t.name=e.name)},deleteFolder:function(e){this.refresh()},handleClickFile:function(e){20===e.docType?this.handleCollapse(e):this.$refs.preview.handlePreview(e)},stopProp:function(e){e.stopPropagation()},handleCollapse:function(e){20===e.docType&&(this.activeCollapse.includes(e.key)?this.activeCollapse=this.activeCollapse.filter(function(t){return t!==e.key}):this.activeCollapse.push(e.key))},handleDownloadResource:function(e){var t=this;this.$confirm("开始下载吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){t.$axios({url:"user/file/"+e.saveId+"/download",method:"get",responseType:"blob"}).then(function(a){if(a){var i=new Blob([a]),s=e.name+"."+e.suffix;if("download"in document.createElement("a")){var n=document.createElement("a");n.download=s,n.style.display="none",n.href=URL.createObjectURL(i),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else console.log(i),navigator.msSaveBlob(i,s)}else t.$message({message:"下载失败",type:"error"})})})},handlePreviewAppendFile:function(e,t){var a=d({},e,{nextId:t});this.$refs.preview.handlePreview(a)},handleOpenReviewDB:function(e){this.$refs.previewDatabase.dbId=e.dbId,this.$refs.previewDatabase.visible=!0}})},f=(a("PZqn"),a("KHd+")),m=Object(f.a)(u,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr"},[a("el-button-group",[a("el-button",{attrs:{size:"small",icon:"el-icon-arrow-left"},on:{click:e.curFolderAction}}),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.nextFolderAction}},[a("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),e._v(" "),a("el-breadcrumb",{staticClass:"pl10",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("关键词 "),a("span",{staticStyle:{color:"red","font-weight":"bold"}},[e._v('" '+e._s(e.searchKey)+' "')]),e._v(" 的相关搜索结果  ")])],1)],1),e._v(" "),a("div",{staticClass:"ib"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("span",{staticStyle:{"font-weight":"bold","letter-spacing":"3px","padding-left":"10px"}},[e._v("最新标签：")]),e._v(" "),e._l(e.tagBar.body,function(t,i){return a("el-tag",{key:t.id,attrs:{closable:"",type:"warning","disable-transitions":!1},on:{close:function(a){e.handleClose(t)}},nativeOn:{click:function(a){e.tagSearch(t.name)}}},[a("a",{key:i,staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:" javascript:void(0)"}},[e._v(e._s(t.name))])])}),e._v(" "),e.tagBar.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{span:1,size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleInputConfirm(t):null}},model:{value:e.tagBar.inputValue,callback:function(t){e.$set(e.tagBar,"inputValue",t)},expression:"tagBar.inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{span:3,size:"small"},on:{click:e.showInput}},[e._v("+ 点击添加新标签\n                    ")])],2)])]),e._v(" "),a("el-container",{staticStyle:{height:"calc(100% - 105px)"}},[a("el-main",{staticClass:"sys-content pd0",staticStyle:{width:"calc(100% - 300px)",float:"left"}},[a("div",[e._l(e.searchTable.body,function(t,i){return a("div",{key:i,staticClass:"custom-search-table-cell  doc-item-file-container"},[a("el-collapse",{ref:"collapsible",refInFor:!0,model:{value:e.activeCollapse,callback:function(t){e.activeCollapse=t},expression:"activeCollapse"}},["folder"===t.kind?a("div",[t.permissionMap.read?a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("a",{staticStyle:{"margin-left":"5px","text-decoration-line":"none"},attrs:{href:"javascript:void(0)"}},[a("b",[e._v(e._s(t.name))])])],1):a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.name))])],1),e._v(" "),a("div",[a("p",{domProps:{innerHTML:e._s(t.highLight)}})])]):a("div",{staticClass:"doc-item-file-container"},[a("el-collapse-item",{attrs:{name:t.key}},[a("template",{slot:"title"},[a("div",{staticClass:"doc-item-file-title-container",on:{click:e.stopProp}},[a("div",{staticClass:"doc-item-file-title"},[a("div",{staticClass:"doc-item-file-title-main"},[20===t.docType?a("img",{staticStyle:{width:"20px",height:"auto"},attrs:{src:e.viewImageUrl,alt:""}}):a("app-svg",{attrs:{iconText:t.suffix}}),e._v(" "),a("a",{staticStyle:{"margin-left":"5px","text-decoration-line":"none","font-size":"14px"},attrs:{href:"javascript:void(0)"},on:{click:function(a){e.handleClickFile(t)}}},[20===t.docType?a("b",[e._v(e._s(t.name))]):a("b",[e._v(e._s(t.name)+"."+e._s(t.suffix))])]),e._v(" "),a("span",{staticStyle:{"padding-left":"50px","font-size":"12px",color:"#969896"}},[e._v(e._s(e.dateShortFormat(t.lastUpdateDate)))]),e._v(" "),a("span",{staticStyle:{"padding-left":"20px","font-size":"12px",color:"#969896"}},[e._v(e._s(t.size))]),e._v(" "),a("span",{staticStyle:{"padding-left":"20px","font-size":"12px",color:"#969896"}},[e._v(e._s(t.lastUpdateUserName))]),e._v(" "),a("span",{staticStyle:{"padding-left":"20px","font-size":"12px"}},[t.hasDatabase?[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览数据库",placement:"bottom"}},[t.permissionMap.modify?a("el-button",{staticClass:"btnEdit",staticStyle:{color:"black"},attrs:{type:"text",size:"mini",icon:"iconfont icon-wenzhangpailie-",circle:""},on:{click:function(a){e.handleOpenReviewDB(t)}}}):e._e()],1)]:e._e()],2)],1),e._v(" "),t.permissionMap.read?a("div",{staticClass:"doc-item-file-icon-list"},[20!==t.docType?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件下载",placement:"bottom"}},[t.permissionMap.download?a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-caozuo-shangchuan-download",circle:""},on:{click:function(a){e.$refs.uploadFile.handleDownloadSubmit(t)}}}):e._e()],1):e._e(),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件更新",placement:"bottom"}},[t.permissionMap.modify?a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-caozuo-shangchuan-upload",circle:""},on:{click:function(a){e.$refs.uploadFile.handleEditFile(t)}}}):e._e()],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"重命名",placement:"bottom"}},[t.permissionMap.modify?a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-row",circle:""},on:{click:function(a){e.$refs.editFolder.handleReName(t)}}}):e._e()],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件版本履历",placement:"bottom"}},[t.permissionMap.read?a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-wenzhangpailie-",circle:""},on:{click:function(a){e.$refs.preview.handleHistory(t)}}}):e._e()],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件删除",placement:"bottom"}},[t.permissionMap.delete?a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"el-icon-close",circle:""},on:{click:function(a){e.$refs.editFolder.handleDeleteSubmit(t)}}}):e._e()],1)],1):e._e()]),e._v(" "),a("div",{staticClass:"doc-item-file-content"},[a("div",{staticStyle:{padding:"5px"}},[a("p",{staticStyle:{color:"#333333"},domProps:{innerHTML:e._s(t.highLight)}})]),e._v(" "),a("div",{staticStyle:{padding:"2px"}},[a("p",{staticStyle:{"font-size":"12px",color:"#969896"}},[a("span",{domProps:{innerHTML:e._s(t.parentPathName)},on:{click:function(a){e.handleCollapse(t)}}})])])])])]),e._v(" "),a("div",[a("el-form",{staticClass:"doc-item-content-expand",attrs:{"label-position":"left",inline:""}},[e._l(t.expandData,function(t,i){return[a("el-form-item",{key:i,attrs:{label:t.title}},[a("span",[e._v(e._s(t.content))])])]})],2),e._v(" "),e._l(t.appendFiles,function(i,s){return a("div",{key:s,staticClass:"resource-file-list"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handlePreviewAppendFile(t,i.id)}}},[a("app-svg",{attrs:{iconText:i.suffix}}),e._v(" "),a("span",[e._v(e._s(i.name)+"."+e._s(i.suffix))])],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载文件",placement:"bottom"}},[t.permissionMap.download?a("el-button",{staticClass:"btnAdd",staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"mini",icon:"iconfont icon-caozuo-shangchuan-download",circle:""},on:{click:function(t){e.handleDownloadResource(i)}}}):e._e()],1)],1)})],2)],2)],1)])],1)}),e._v(" "),a("infinite-loading",{ref:"infinite",on:{infinite:e.nextPage}},[a("span",{attrs:{slot:"no-more"},slot:"no-more"},[e._v("\n                            已经没有啦~~\n                        ")])])],2)]),e._v(" "),a("el-aside",{staticStyle:{"background-color":"rgb(242, 246, 249)",height:"100%"},attrs:{width:"300px"}},[a("div",{staticStyle:{padding:"20px 10px 20px 20px","background-color":"rgb(242, 246, 249)"}},[a("span",{staticStyle:{"font-size":"14px",color:"gray"}},[e._v(e._s(e.searchTable.total)+"条检索结果")]),a("br"),a("br"),e._v(" "),a("span",{staticStyle:{"font-size":"16px"}},[a("b",[e._v("聚类")])]),a("br"),a("br"),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.clusterParamShow,expression:"clusterParamShow"}],staticClass:"cluster_param"},e._l(e.clusterParamList,function(t,i){return a("div",e._l(t,function(t,i){return a("div",{staticClass:"cluster_param_item fxb"},[a("span",{staticClass:"word-hidden"},[a("b",[e._v(e._s(e.getClusterName(i))+"：")]),e._v(" "),a("el-tooltip",{attrs:{content:t,placement:"bottom",effect:"light"}},[a("span",[e._v(e._s(t))])])],1),e._v(" "),a("i",{staticClass:"el-icon-error finger",on:{click:function(a){e.removeClusterSearch(i,t)}}})])}))})),e._v(" "),a("el-collapse",{attrs:{accordion:!1},on:{change:e.collapseHandleChange},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.clusterList,function(t,i){return a("div",{staticClass:"collapse-item"},e._l(t,function(t,s){return a("el-collapse-item",{attrs:{name:s}},[a("template",{slot:"title"},[e._v("\n                                    "+e._s(e.getClusterName(s))+"\n                                ")]),e._v(" "),a("div",{staticClass:"chartsBox"},[a("div",{staticClass:"charts",attrs:{id:"clusterCharts_"+i}})])],2)}))}))],1)])],1),e._v(" "),a("preview-database",{ref:"previewDatabase"}),e._v(" "),a("edit-folder",{ref:"editFolder",attrs:{"rename-folder":e.renameFolder,"delete-folder":e.deleteFolder}}),e._v(" "),a("upload-file",{ref:"uploadFile",attrs:{uploaded:e.refresh}}),e._v(" "),a("link-file",{ref:"linkFile",attrs:{linked:e.refresh}}),e._v(" "),a("preview",{ref:"preview"})],1)},[],!1,null,null,null);t.default=m.exports},rdlN:function(e,t,a){},rvRY:function(e,t,a){},s432:function(e,t,a){"use strict";a.r(t);var i=a("Gas7"),s=a.n(i),n=a("L2JU"),o=a("p46w"),l=a.n(o),r=a("kLgE"),c=(a("CAgN"),a("26K/")),d=a("bZsl"),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},f={components:{splitPane:s.a,PreviewDatabase:c.a},data:function(){return{viewImageUrl:this.$upload+"/setting/getLogoImg?seed=",folderTree:{body:[],props:{children:"children",label:"name"},loading:!1},splitClass:"",linkRandom:"",shareRandom:"",imagePreview:{src:"",viewer:""},fileAccessoryList:[],fileMetadataList:[],dbId:0,dbName:"",LiteratureBoxShow:!1}},computed:u({},Object(n.d)({username:function(e){return e.user.name},operation:function(e){return e.user.operation}})),mounted:function(){this.linkRandom=this.$route.query.link,this.shareRandom=this.$route.query.shared,this.getData(),this.imagePreview.viewer=new r.a(document.getElementById("image"),{toolbar:{zoomIn:4,zoomOut:4,oneToOne:4,reset:4,rotateLeft:4,rotateRight:4,flipHorizontal:4,flipVertical:4}})},methods:u({},Object(n.b)({sysLogout:"auth/logout"}),{getData:function(){var e=this;this.folderTree.loading=!0;var t=void 0;if(this.shareRandom){var a=l.a.get(this.shareRandom);t="/app/link/"+this.shareRandom+"/?password="+a}else t="/user/link/"+this.linkRandom;this.$axios({url:t,method:"get"}).then(function(t){0===t.c?e.folderTree.body=t.ctt.resources:e.$message.error(t.msg)}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)}),this.folderTree.loading=!1},getLazyData:function(e,t){var a=this;if(0!==e.level){var i=void 0;"folder"===e.data.kind?(i=e.data.resourceId?e.data.resourceId:e.data.id,this.folderTree.loading=!0,this.$axios({url:"/user/link/folder/"+i+"/docs",method:"get"}).then(function(e){t(e.ctt),a.folderTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})):t([])}},clickFolder:function(e){var t=this;if("folder"!==e.kind){this.LiteratureBoxShow=!1,this.$refs.appFrame.isShow=!1,this.fileAccessoryList=[],this.fileMetadataList=[],this.dbName="";var a=void 0;a=e.resourceId?e.resourceId:e.id,null!=e.resource&&20==e.resource.docType||20==e.docType?this.$axios({url:"/user/file/"+a+"/Literature",method:"get"}).then(function(e){if(0==e.c){t.fileAccessoryList=e.ctt.fileAccessoryDto.filter(function(e){return 2!==e.type});var a=e.ctt.fileAccessoryDto.filter(function(e){return 2==e.type});a&&a.length>0&&(t.dbId=a[0].saveId,t.dbName=a[0].name),t.fileMetadataList=e.ctt.fileMetadataDto,t.fileMetadataList.forEach(function(e){7===e.dataType&&""!=e.value?e.valueData=Object(d.formatDateTime)(e.value,"年月日"):6===e.dataType&&""!=e.value?e.valueData=e.value?"是":"否":e.valueData=e.value}),t.LiteratureBoxShow=!0}else t.$message.error(e.msg)}):this.selectFolder("/user/file/"+a+"/seq/0/preview")}},clickLiteratureFolder:function(e){this.$refs.appFrame.isShow=!1,this.selectFolder("/user/file/"+e.fileId+"/accessory/"+e.id+"/seq/0/preview")},selectFolder:function(e){var t=this;this.$axios({url:e,method:"get"}).then(function(e){0==e.c?t.$refs.appFrame&&t.$refs.appFrame.loadFile(e.ctt.suffix,e.ctt.url.url):t.$message.error(e.msg)})},selectReviewDB:function(){this.$refs.appFrame.isShow=!1,this.$refs.previewDatabase.dbId=this.dbId,this.$refs.previewDatabase.dbName=this.dbName,this.$refs.previewDatabase.visible=!0},onMouseDown:function(){this.$refs.split.active&&(this.splitClass="active")},onMouseUp:function(){this.$refs.split.active||(this.splitClass="")},message:function(){this.$router.push("/message")},userCommand:function(e){var t=this;switch(e){case"admin":this.$router.push("/admin");break;case"logout":this.sysLogout().then(function(){t.$router.push("/login")})}}})},m=(a("Fzc/"),a("KHd+")),p=Object(m.a)(f,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"apphead1 fxb bb1 pr0"},[a("div",[a("h1",{staticClass:"fb text1em",staticStyle:{color:"white","font-weight":"bold","font-style":"italic","letter-spacing":"3px","padding-left":"20px"}},[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-as-wendangku"}})]),e._v("\n                外链预览\n            ")])]),e._v(" "),a("div",{staticClass:"top-menu-group fxc",staticStyle:{"background-color":"#f8f8f8"}},[a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.userCommand}},[a("span",{staticClass:"el-dropdown-link pd10"},[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-yonghu"}})]),e._v(" "),a("span",[e._v(" "+e._s(e.username))])]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"logout"}},[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-tuichu1"}})]),e._v(" "),a("span",[e._v("退出")])])],1)],1)],1)]),e._v(" "),a("split-pane",{ref:"split",attrs:{split:"vertical",className:e.splitClass,defaultPercent:20},nativeOn:{mousedown:function(t){return e.onMouseDown(t)},mouseup:function(t){return e.onMouseUp(t)}}},[a("template",{slot:"paneL"},[a("el-container",[a("el-main",{staticClass:"pt10"},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.folderTree.loading,expression:"folderTree.loading"}],ref:"folderTree",attrs:{data:e.folderTree.body,"highlight-current":"",props:e.folderTree.props,load:e.getLazyData,lazy:"","node-key":"id","expand-on-click-node":!1},on:{"node-click":e.clickFolder},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},["folder"===s.kind?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-wenjianjia3"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label)+"1")])])]):a("div",[s.suffix?e._e():a("img",{staticStyle:{width:"20px",height:"auto"},attrs:{src:e.viewImageUrl,alt:""}}),e._v(" "),s.suffix?a("app-svg",{attrs:{iconText:s.suffix}}):e._e(),e._v(" "),a("span",[e._v(e._s(i.label)+"1")])],1)])}}])})],1)],1)],1),e._v(" "),a("template",{slot:"paneR"},[a("div",{staticClass:"fxl",staticStyle:{width:"100%",height:"100%"}},[e.LiteratureBoxShow?a("div",{staticClass:"fxl",staticStyle:{float:"left",width:"50%"}},[a("el-form",{staticClass:"link-item-content-expand",staticStyle:{width:"60%"},attrs:{inline:""}},[e._l(this.fileMetadataList,function(t,i){return[a("el-form-item",{key:i,attrs:{label:t.name}},[a("span",[e._v(e._s(t.valueData))])])]})],2),e._v(" "),a("div",{staticStyle:{width:"38%"}},[e._l(this.fileAccessoryList,function(t,i){return a("div",{key:i,staticClass:"word-hidden finger",staticStyle:{color:"#409EFF","font-size":"14px",padding:"10px 0px 10px 0px"},on:{click:function(a){e.clickLiteratureFolder(t)}}},[a("app-svg",{attrs:{iconText:t.suffix}}),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:t.name+"."+t.suffix,placement:"bottom"}},[a("span",[e._v(e._s(t.name)+"."+e._s(t.suffix))])])],1)}),e._v(" "),this.dbName?a("div",{staticClass:"word-hidden finger",staticStyle:{color:"#409EFF","font-size":"14px",padding:"10px 0px 10px 0px"},on:{click:e.selectReviewDB}},[a("svg",{staticClass:"icon",attrs:{t:"1614846486792",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1852",width:"1.2rem",height:"1.2rem"}},[a("path",{attrs:{d:"M858.2 766.3V616.7c-22.1 19.3-47 35.2-73.7 47.2-86.5 38-180 57.2-274.5 56.3-122 7.1-242.8-27-343.1-96.7v150.7C173.7 840 318.8 912 512.3 912c193.5 0 337.5-72.6 345.9-138.9v-6.8z","p-id":"1853",fill:"#0072D9"}}),a("path",{attrs:{d:"M858.2 507v-2.8 6.8c-8.4 66.4-152.4 138.9-345.9 138.9-193.5 0-338.6-72-345.4-137.8V361.3C267.2 431.1 388 465.1 510 458c94.5 0.9 188-18.2 274.5-56.3 26.7-12.1 51.6-28 73.7-47.2V507z","p-id":"1854",fill:"#0072D9"}}),a("path",{attrs:{d:"M762.6 160.5c57.4 25.3 91.7 61.3 91.7 93.4 0 31.5-35.4 66.4-91.7 93.4-80 34-166.2 50.7-253.1 48.9-196.9 0-343.7-74.8-343.7-141.7s147.4-142.3 344.8-142.3c86.5-1.9 172.3 14.6 252 48.3z","p-id":"1855",fill:"#0072D9"}})]),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:this.dbName,placement:"bottom"}},[a("span",[e._v(e._s(this.dbName))])])],1):e._e()],2)],1):e._e(),e._v(" "),a("app-frame",{ref:"appFrame"})],1),e._v(" "),a("preview-database",{ref:"previewDatabase"}),e._v(" "),a("div",{staticStyle:{display:"none"}},[a("img",{attrs:{id:"image",src:e.imagePreview.src,alt:"Picture"}})])],1)],2)],1)},[],!1,null,null,null);t.default=p.exports},skaa:function(e,t,a){"use strict";var i=a("RYJf");a.n(i).a},uUVA:function(e,t,a){"use strict";a.r(t);var i=a("Gas7"),s=a.n(i),n={components:{EditUser:a("JGdg").a,splitPane:s.a},name:"deptlist",data:function(){return{deptData:[],deptDataProps:{children:"children",label:"name"},deptDataLoading:!1,selectDept:null,tableData:{height:0,loading:!1,body:[],pageSize:1e3,total:0,curPage:0},formDeptAddVisible:!1,formDeptEditVisible:!1,formDeptRules:{name:[{required:!0,message:"请输入组织架构名称",trigger:"blur"}]},formDeptData:{id:0,name:"",parentId:0,parentName:"",type:1},formDeptMoveVisible:!1,formDeptMoveRules:{parentName:[{required:!0,message:"请选择上级组织架构",trigger:"blur"}]},formDeptMoveData:{id:0,name:"",parentId:0,parentName:"",orgParentId:0,orgParentName:"",type:1},splitClass:"",searchTxt:"",searchData:""}},mounted:function(){this.getData()},methods:{tableHeight:function(){this.$nextTick(function(){this.tableData.height=window.innerHeight-this.$refs.split.$el.offsetTop;var e=this;window.onresize=function(){e.tableData.height=window.innerHeight-e.$refs.split.$el.offsetTop}})},getData:function(){var e=this;this.deptDataLoading=!0,this.$axios({url:"/admin/depts",method:"get"}).then(function(t){var a=[];a.push(t.ctt),a[0].isRoot=!0,e.deptData=a,e.deptDataLoading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},mainDeptSelect:function(e){this.searchTxt="",this.searchData="",this.tableData.body=[],this.selectDept=e,this.refresh()},handleDeptAdd:function(e){this.formDeptAddVisible=!0,this.formDeptData={id:0,name:"",parentId:e.data.id,parentName:e.data.name,type:1},this.$refs.formDeptData&&this.$refs.formDeptData.resetFields()},handleDeptInput:function(){var e=this;this.$confirm("开始导入最新组织机构数据吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.tableData.loading=!0,e.$axios({url:"/relay/depts",method:"post"}).then(function(t){e.$message({message:"已经完成导入",type:"success"}),e.tableData.loading=!1,e.refresh()}).catch(function(t){e.tableData.loading=!1,e.$message.error("获取数据失败，失败码："+t.response.status)})}).catch(function(){})},handleDeptAddSubmit:function(){var e=this;this.$refs.formDeptData.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.deptDataLoading=!0;var t=Object.assign({},e.formDeptData);e.$axios({url:"/admin/dept",method:"post",data:t}).then(function(t){e.$message({message:"提交成功",type:"success"}),e.$refs.formDeptData.resetFields(),e.formDeptAddVisible=!1,e.getData(),e.deptDataLoading=!1})})})},handleDeptEdit:function(e){this.formDeptEditVisible=!0,this.formDeptData={id:e.data.id,name:e.data.name,parentId:e.parent.data.id,parentName:e.parent.data.name,type:e.data.type},this.$refs.formDeptData&&this.$refs.formDeptData.resetFields()},handleDeptEditSubmit:function(){var e=this;this.$refs.formDeptData.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.deptDataLoading=!0;var t=Object.assign({},e.formDeptData);e.$axios({url:"/admin/dept",method:"put",data:t}).then(function(t){e.$message({message:"提交成功",type:"success"}),e.$refs.formDeptData.resetFields(),e.formDeptEditVisible=!1,e.getData(),e.deptDataLoading=!1})})})},handleDeptMove:function(e){this.formDeptMoveData={id:e.data.id,name:e.data.name,parentId:0,parentName:"",orgParentId:e.parent.data.id,orgParentName:e.parent.data.name,type:e.data.type},this.formDeptMoveVisible=!0},parentDeptSelect:function(e){this.formDeptMoveData.parentId=e.id,this.formDeptMoveData.parentName=e.name},handleDeptMoveSubmit:function(){var e=this;0!==this.formDeptMoveData.parentId?this.$confirm("确认提交吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.deptDataLoading=!0;var t=Object.assign({},e.formDeptMoveData);e.$axios({url:"/admin/dept",method:"put",data:t}).then(function(t){0===t.c?(e.$message.success("变更成功"),e.formDeptMoveVisible=!1,e.$refs.formDeptMoveData.resetFields(),e.getData()):e.$message.error(t.msg),e.deptDataLoading=!1})}):this.$message.error("请选择移动组织架构")},handleDeptDeleteSubmit:function(e){var t=this;this.$confirm("确认封存该组织吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){t.deptDataLoading=!0;var a=Object.assign({},e.data);t.$axios({url:"/admin/dept",method:"delete",data:a}).then(function(e){0===e.c?(t.$message.success("封存成功"),t.getData()):t.$message.error(e.msg),t.deptDataLoading=!1})}).catch(function(){})},getUserData:function(e,t){var a=this;if(e||this.searchData){this.tableData.loading=this.$refs.infinite.isFirstLoad;var i=void 0;i=this.searchData?"/admin/search/users/"+this.tableData.curPage+"-"+this.tableData.pageSize+"?name="+this.searchData+"&islove=true":"/admin/dept/"+e.id+"/users/"+this.tableData.curPage+"-"+this.tableData.pageSize,this.$axios({url:i,method:"get"}).then(function(e){var i=[];e.ctt.list.length>0&&(i.push(e.ctt.list),i[0].length>0&&1===i[0][0].id&&(i[0][0].isRoot=!0)),a.tableData.body=a.tableData.body.concat(e.ctt.list),a.tableData.total=e.ctt.total,a.tableData.loading=!1,0==e.ctt.list.length?t&&t.complete():t&&t.loaded(),a.$nextTick(function(){a.tableHeight()})}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})}else t&&t.complete()},handleUserAdd:function(e){this.$refs.editUser.handleUserAddByDept(e.data)},handleUserUnlockSubmit:function(e,t){this.$refs.editUser.handleUserUnlockSubmit(e,t)},handleUserBaseEdit:function(e,t){this.$refs.editUser.handleUserBaseEdit(e,t)},handleUserPasswordEdit:function(e,t){this.$refs.editUser.handleUserPasswordEdit(e,t)},handleAdminSubmit:function(e,t){this.$refs.editUser.handleAdminSubmit(e,t)},handleUserLockSubmit:function(e,t){this.$refs.editUser.handleUserLockSubmit(e,t)},handleUserLeaveSubmit:function(e,t){this.$refs.editUser.handleUserLeaveSubmit(e,t)},handleUserDeleteSubmit:function(e,t){this.$refs.editUser.handleUserDeleteSubmit(e,t)},onMouseDown:function(){this.$refs.split.active&&(this.splitClass="active")},onMouseUp:function(){this.$refs.split.active||(this.splitClass="")},refresh:function(){this.tableData.total=0,this.tableData.body=[],this.tableData.curPage=0,this.$refs.infinite.stateChanger.reset()},clearSearchTxt:function(){this.searchData="",this.refresh()},nextPage:function(e){this.tableData.curPage+=1,this.getUserData(this.selectDept,e)},search:function(){this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.searchData=this.searchTxt,this.refresh()):this.$message.success("请输入搜索关键词")}}},o=(a("20+P"),a("KHd+")),l=Object(o.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"106"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr fnt-s20 pd10"},[a("h1",[a("app-svg",{attrs:{iconClass:"drxx95"}}),e._v("  组织架构管理")],1)]),e._v(" "),a("div",{staticClass:"ib pd10"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入用户姓名",clearable:""},on:{clear:e.clearSearchTxt},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)])]),e._v(" "),a("split-pane",{ref:"split",attrs:{split:"vertical",className:e.splitClass,defaultPercent:50},nativeOn:{mousedown:function(t){return e.onMouseDown(t)},mouseup:function(t){return e.onMouseUp(t)}}},[a("template",{slot:"paneL"},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptDataLoading,expression:"deptDataLoading"}],ref:"deptTree",staticClass:"mr20",attrs:{data:e.deptData,"highlight-current":"",props:e.deptDataProps,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.mainDeptSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])]),e._v(" "),a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增下级组织架构",placement:"bottom"}},[s.isRoot?a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-add",circle:""},on:{click:function(t){e.handleDeptAdd(i)}}}):e._e()],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑名称",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",icon:"iconfont icon-edit-row",circle:""},on:{click:function(t){e.handleDeptEdit(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"封存",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-dongjie",circle:""},on:{click:function(t){e.handleDeptDeleteSubmit(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增组织架构用户",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnAddUser",attrs:{type:"text",size:"mini",icon:"iconfont icon-add-user",circle:""},on:{click:function(t){e.handleUserAdd(i)}}})],1)],1)])}}])})],1)],1),e._v(" "),a("template",{slot:"paneR"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableData.loading,expression:"tableData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.tableData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.tableData.height}},[a("el-table-column",{attrs:{prop:"name",label:"用户姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("i",{staticClass:"iconfont icon-geren"}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[8===t.row.status?a("div",[a("span",[e._v("离职用户")]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"再入职",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-add-user",circle:""},on:{click:function(a){e.handleUserUnlockSubmit(t.$index,t.row)}}})],1)],1):4===t.row.status?a("div",[a("span",[e._v("限制登录")]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"解封账户",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-jiechu",circle:""},on:{click:function(a){e.handleUserUnlockSubmit(t.$index,t.row)}}})],1)],1):a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑基本信息",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-row",circle:""},on:{click:function(a){e.handleUserBaseEdit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"密码重置",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-denglumima",circle:""},on:{click:function(a){e.handleUserPasswordEdit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设为系统管理员",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-guanli_danse",circle:""},on:{click:function(a){e.handleAdminSubmit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"封禁",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnLock",attrs:{type:"text",size:"mini",icon:"iconfont icon-dongjie",circle:""},on:{click:function(a){e.handleUserLockSubmit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"账户封存",placement:"bottom"}},[t.row.isRoot?e._e():a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-yonghushanchu",circle:""},on:{click:function(a){e.handleUserDeleteSubmit(t.$index,t.row)}}})],1)],1)]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1)],2),e._v(" "),a("el-dialog",{attrs:{title:"组织架构新增",visible:e.formDeptAddVisible,"close-on-click-modal":!1,width:"450px"},on:{"update:visible":function(t){e.formDeptAddVisible=t}}},[a("el-form",{ref:"formDeptData",attrs:{model:e.formDeptData,"label-width":"100px",rules:e.formDeptRules}},[a("el-form-item",{attrs:{label:"上级组织",prop:"parentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formDeptData.parentName,callback:function(t){e.$set(e.formDeptData,"parentName",t)},expression:"formDeptData.parentName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"组织名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formDeptData.name,callback:function(t){e.$set(e.formDeptData,"name",t)},expression:"formDeptData.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-add-new",loading:e.deptDataLoading},nativeOn:{click:function(t){return e.handleDeptAddSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){e.formDeptAddVisible=!1}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"组织架构编辑",visible:e.formDeptEditVisible,"close-on-click-modal":!1,width:"450px"},on:{"update:visible":function(t){e.formDeptEditVisible=t}}},[a("el-form",{ref:"formDeptData",attrs:{model:e.formDeptData,"label-width":"100px",rules:e.formDeptRules}},[a("el-form-item",{attrs:{label:"上级组织",prop:"parentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formDeptData.parentName,callback:function(t){e.$set(e.formDeptData,"parentName",t)},expression:"formDeptData.parentName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"组织名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formDeptData.name,callback:function(t){e.$set(e.formDeptData,"name",t)},expression:"formDeptData.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-bianji2",loading:e.deptDataLoading},nativeOn:{click:function(t){return e.handleDeptEditSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){e.formDeptEditVisible=!1}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("关闭")])])])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"变更部门组织结构",visible:e.formDeptMoveVisible,"close-on-click-modal":!1,width:"700px"},on:{"update:visible":function(t){e.formDeptMoveVisible=t}}},[a("el-form",{ref:"formDeptMoveData",attrs:{model:e.formDeptMoveData,"label-width":"120px",rules:e.formDeptMoveRules}},[a("el-row",{staticStyle:{"min-height":"400px",height:"400px"},attrs:{gutter:30}},[a("el-col",{staticStyle:{height:"100%"},attrs:{span:12}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc",height:"400px"}},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.deptDataLoading,expression:"deptDataLoading"}],ref:"moveDeptTree",attrs:{data:e.deptData,"highlight-current":"",props:e.deptDataProps,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1]},on:{"node-click":e.parentDeptSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zhuye11"}})]),e._v(" "),a("span",[a("b",[e._v(e._s(i.label))])])]):a("div",[1===s.type?a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-zuzhiguanli-"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-danweizuzhi"}})]),e._v(" "),a("span",[e._v(e._s(i.label))])])])])}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"部门名称",prop:"orgParentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formDeptMoveData.name,callback:function(t){e.$set(e.formDeptMoveData,"name",t)},expression:"formDeptMoveData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"当前上级部门",prop:"orgParentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formDeptMoveData.orgParentName,callback:function(t){e.$set(e.formDeptMoveData,"orgParentName",t)},expression:"formDeptMoveData.orgParentName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新的上级部门",prop:"parentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formDeptMoveData.parentName,callback:function(t){e.$set(e.formDeptMoveData,"parentName",t)},expression:"formDeptMoveData.parentName"}})],1),e._v(" "),a("div",{staticStyle:{margin:"15px 0 0 15px",padding:"5px",display:"flex",height:"100px","border-radius":"5px",border:"1px solid #dcdfe6"}},[a("span",{staticStyle:{color:"#606266","font-weight":"bold"}},[e._v("注意：修正上级部门时，将同时转换本身部门的下级部门和部门人员的组织关系。")])])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-edit-node",loading:e.deptDataLoading},nativeOn:{click:function(t){return e.handleDeptMoveSubmit(t)}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("确定")])])]),e._v(" "),a("el-button",{attrs:{icon:"iconfont icon-jieshu"},nativeOn:{click:function(t){e.formDeptMoveVisible=!1}}},[a("span",{staticStyle:{"padding-left":"10px"}},[a("b",[e._v("取消")])])])],1)],1),e._v(" "),a("edit-user",{ref:"editUser",attrs:{"add-user":e.refresh,"edit-user":e.refresh}})],1)},[],!1,null,"32dfec9b",null);t.default=l.exports},uZRj:function(e,t,a){"use strict";var i={name:"EditFolder",props:{addFolder:{type:Function,default:null},renameFolder:{type:Function,default:null},deleteFolder:{type:Function,default:null},deleteFolders:{type:Function,default:null}},data:function(){return{defaultKey:[1],folderTree:{visible:!1,loading:!1,props:{label:"name",children:"children"},body:[],selected:null},formFolder:{title:"新建文件夹",data:{id:0,name:"",parentId:"",parentName:""},visible:!1,loading:!1,rules:{name:[{required:!0,message:"请输入文件夹名",trigger:"blur"}]}},formEditFolder:{title:"编辑文件夹",data:{id:0,kind:"",orgName:"",name:"",suffix:"",orgParentId:0,orgParentName:"",parentId:0,parentName:""},visible:!1,loading:!1,rules:{name:[{required:!0,message:"请输入新的名称",trigger:"blur"}]}},formReNameFolder:{title:"文件夹重命名",data:{id:0,kind:"",orgName:"",name:"",suffix:"",parentId:""},visible:!1,loading:!1,rules:{name:[{required:!0,message:"请输入新的名称",trigger:"blur"}]}}}},methods:{clear:function(){this.folderTree.body=[],this.folderTree.selected=null,this.formEditFolder.visible=!1},handleAddFolderSubmit:function(){var e=this;this.$refs.formFolderData.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formFolder.loading=!0;var t=Object.assign({},e.formFolder.data);e.$axios({url:"/user/folder",method:"post",data:t}).then(function(t){0===t.c?(e.$message.success("提交成功"),e.formFolder.visible=!1,e.addFolder(t)):e.$message.error(t.msg),e.formFolder.loading=!1})})})},handleAddFolder:function(e){this.formFolder.visible=!0,this.formFolder.data={id:0,name:"",parentName:e.name,parentId:e.id},this.$refs.formFolderData&&this.$refs.formFolderData.resetFields()},handleEditFolder:function(e,t){this.formEditFolder.title="folder"===t.kind?"文件夹重命名 文件夹路径编辑":"文件重命名 文件路径编辑",this.formEditFolder.data={id:t.id,orgName:t.name,name:t.name,kind:t.kind,suffix:t.suffix,orgParentId:e.id,orgParentName:e.name,parentId:e.id,parentName:e.name},this.formEditFolder.visible=!0},handleEditFolderSubmit:function(){var e=this;this.$refs.formEditFolder.validate(function(t){t&&e.$confirm("确认提交编辑吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formEditFolder.loading=!0;var t=Object.assign({},e.formEditFolder.data);e.$axios({url:"user/"+("folder"===t.kind?"folder":"file"),method:"put",data:t}).then(function(a){0===a.c?(e.$message.success("编辑成功"),e.$refs.formEditFolder.resetFields(),e.folderTree.body=[],e.folderTree.selected=null,e.formEditFolder.visible=!1,e.renameFolder(t)):e.$message.error(a.msg),e.formEditFolder.loading=!1})})})},printFolderTree:function(e,t){var a=this,i=void 0;i=0===e.level?0:e.data.id,this.folderTree.loading=!0,this.$axios({url:"/user/folder/"+i+"/children",method:"get"}).then(function(e){if(0===e.c){for(var s=[],n=0;n<e.ctt.length;n++)e.ctt[n].permissionMap.visible&&s.push(e.ctt[n]);t(s),a.folderTree.loading=!1,a.$nextTick(function(){var e=[];e.push(i),a.defaultKey=e,a.$refs.folderTree.setCurrentKey(i),a.folderTree.selected=a.$refs.folderTree.getCurrentNode()})}else t([]),a.$message.error(e.msg),a.folderTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},folderSelect:function(e){this.folderTree.selected=e,this.formEditFolder.data.parentId=e.id,this.formEditFolder.data.parentName=e.name},handleReName:function(e){this.formReNameFolder.title="folder"===e.kind?"文件夹重命名":"文件重命名",this.formReNameFolder.data={id:e.id,orgName:e.name,name:"",kind:e.kind,suffix:e.suffix,parentId:e.parentId},this.formReNameFolder.visible=!0},handleReNameSubmit:function(){var e=this;this.$refs.formReNameData.validate(function(t){t&&e.$confirm("确认重新命名吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){e.formReNameFolder.loading=!0;var t=Object.assign({},e.formReNameFolder.data);e.$axios({url:"user/"+("folder"===t.kind?"folder":"file"),method:"put",data:t}).then(function(a){0===a.c?(e.$message.success("重命名成功"),e.$refs.formReNameData.resetFields(),e.formReNameFolder.visible=!1,e.renameFolder(t)):e.$message.error(a.msg),e.formReNameFolder.loading=!1})})})},handleDeleteSubmit:function(e){var t=this;this.$confirm("确认删除该记录吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var a=Object.assign({},e);t.$axios({url:"user/"+("folder"===a.kind?"folder":"file"),method:"delete",data:a}).then(function(e){0===e.c?(t.$message.success("删除成功"),t.deleteFolder(a)):t.$message.error(e.msg)})}).catch(function(){})},handleMultiDeleteSubmit:function(e){var t=this;0!==e.length?this.$confirm("确认删除这些记录吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){var a=e;t.$axios({url:"user/docs",method:"delete",data:a}).then(function(e){0===e.c?(t.$message.success("删除成功"),t.deleteFolders(a)):t.$message.error(e.msg)})}).catch(function(){}):this.$message.error("没有选择需要删除的文件或者文件夹，请重新选择！")}}},s=(a("MKPK"),a("KHd+")),n=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.formFolder.title,visible:e.formFolder.visible,"close-on-click-modal":!0,width:"500px"},on:{"update:visible":function(t){e.$set(e.formFolder,"visible",t)}}},[a("el-form",{ref:"formFolderData",attrs:{model:e.formFolder.data,"label-width":"120px",rules:e.formFolder.rules}},[a("el-form-item",{attrs:{label:"上级文件夹名称",prop:"parentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formFolder.data.parentName,callback:function(t){e.$set(e.formFolder.data,"parentName",t)},expression:"formFolder.data.parentName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新建文件夹名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formFolder.data.name,callback:function(t){e.$set(e.formFolder.data,"name",t)},expression:"formFolder.data.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.formFolder.loading},nativeOn:{click:function(t){return e.handleAddFolderSubmit(t)}}},[e._v("确定")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formFolder.visible=!1}}},[e._v("取消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.formReNameFolder.title,visible:e.formReNameFolder.visible,"close-on-click-modal":!0,width:"500px"},on:{"update:visible":function(t){e.$set(e.formReNameFolder,"visible",t)}}},[a("el-form",{ref:"formReNameData",attrs:{model:e.formReNameFolder.data,"label-width":"120px",rules:e.formReNameFolder.rules}},[a("el-form-item",{attrs:{label:"原名称",prop:"orgName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formReNameFolder.data.orgName,callback:function(t){e.$set(e.formReNameFolder.data,"orgName",t)},expression:"formReNameFolder.data.orgName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"输入新的名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formReNameFolder.data.name,callback:function(t){e.$set(e.formReNameFolder.data,"name",t)},expression:"formReNameFolder.data.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.formReNameFolder.loading},nativeOn:{click:function(t){return e.handleReNameSubmit(t)}}},[e._v("重命名")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.formReNameFolder.visible=!1}}},[e._v("取消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.formEditFolder.title,visible:e.formEditFolder.visible,"close-on-click-modal":!0,width:"800px"},on:{"update:visible":function(t){e.$set(e.formEditFolder,"visible",t)}}},[a("el-form",{ref:"formEditFolder",attrs:{model:e.formEditFolder.data,"label-width":"140px",rules:e.formEditFolder.rules}},[a("el-row",{staticStyle:{"min-height":"500px",height:"500px"},attrs:{gutter:30}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"原名称",prop:"orgName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formEditFolder.data.orgName,callback:function(t){e.$set(e.formEditFolder.data,"orgName",t)},expression:"formEditFolder.data.orgName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"输入新的名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formEditFolder.data.name,callback:function(t){e.$set(e.formEditFolder.data,"name",t)},expression:"formEditFolder.data.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"原上级文件夹",prop:"orgParentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formEditFolder.data.orgParentName,callback:function(t){e.$set(e.formEditFolder.data,"orgParentName",t)},expression:"formEditFolder.data.orgParentName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择新的上级文件夹",prop:"parentName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.formEditFolder.data.parentName,callback:function(t){e.$set(e.formEditFolder.data,"parentName",t)},expression:"formEditFolder.data.parentName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticStyle:{"box-shadow":"0 0 1px #ccc"}},[a("el-scrollbar",{staticStyle:{height:"450px"}},[e.formEditFolder.visible?a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.folderTree.loading,expression:"folderTree.loading"}],ref:"folderTree",attrs:{data:e.folderTree.body,"highlight-current":"",props:e.folderTree.props,"default-expand-all":!1,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1],lazy:"",load:e.printFolderTree},on:{"node-click":e.folderSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[0===s.parentId?a("div",[a("app-svg",{attrs:{iconClass:"zhuye11"}}),e._v(" "),a("span",{staticClass:"span-ellipsis",attrs:{title:i.label}},[e._v(e._s(i.label))])],1):a("div",[a("app-svg",{attrs:{iconClass:"wenjianjia"}}),e._v(" "),a("span",{staticClass:"span-ellipsis",attrs:{title:i.label}},[e._v(e._s(i.label))])],1)])}}])}):e._e()],1)],1)])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.formEditFolder.loading},nativeOn:{click:function(t){return e.handleEditFolderSubmit(t)}}},[e._v("确定")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){return e.clear(t)}}},[e._v("取消")])],1)],1)],1)},[],!1,null,"6953cbc6",null);t.a=n.exports},vUqt:function(e,t,a){},va8q:function(e,t,a){},xUDH:function(e,t,a){},"yRg/":function(e,t,a){"use strict";var i=a("Mk72");a.n(i).a},yrUs:function(e,t,a){},zHDI:function(e,t,a){"use strict";a.r(t);var i=a("Gas7"),s=a.n(i),n=a("Bl3E"),o=a("MYOy"),l=a("iaoZ"),r={components:{splitPane:s.a,editFolder:n.a,folderAdmin:o.a,folderWhite:l.a},name:"doc",data:function(){return{folder:{name:"",size:"",user:"",ip:""},folderTree:{body:[],props:{label:"name",children:"children"},loading:!1,selected:null},fileListData:{height:0,loading:!1,body:[],pageSize:20,total:0,curPage:0},splitClass:"",viewImageUrl:this.$upload+"/setting/getLogoImg?seed="}},mounted:function(){this.tableHeight()},methods:{tableHeight:function(){this.$nextTick(function(){this.fileListData.height=window.innerHeight-this.$refs.split.$el.offsetTop;var e=this;window.onresize=function(){e.fileListData.height=window.innerHeight-e.$refs.split.$el.offsetTop}})},printFolderTree:function(e,t){var a=this,i=void 0;i=0===e.level?0:e.data.id,this.folderTree.loading=!0,this.$axios({url:"/admin/folder/"+i+"/children",method:"get"}).then(function(e){t(e.ctt),a.folderTree.loading=!1}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},folderSelect:function(e){var t=this;this.$axios({url:"/admin/folder/"+e.id,method:"get"}).then(function(a){if(0===a.c){if(t.folder.name=a.ctt.name,a.ctt.fileSize&&0!==a.ctt.fileSize?t.folder.size=a.ctt.fileSize:t.folder.size=t.$maxFileSize,a.ctt.folderIpDto?t.folder.ip=a.ctt.folderIpDto.ipInfo:t.folder.ip="无限制",a.ctt.admins&&a.ctt.admins.length>0){for(var i="",s=0;s<a.ctt.admins.length;s++)i+=a.ctt.admins[s].name+"、";i.length>0?t.folder.user=i.substring(0,i.length-1):t.folder.user="未设置专属文件夹管理员"}else t.folder.user="未设置专属文件夹管理员";t.selectFolder=e,t.refresh()}}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},getFileData:function(e){var t=this;if(!this.selectFolder)return e.complete();this.fileListData.loading=this.$refs.infinite.isFirstLoad,this.$axios({url:"/admin/folder/"+this.selectFolder.id+"/files/"+this.fileListData.curPage+"-"+this.fileListData.pageSize,method:"get"}).then(function(a){t.fileListData.body=t.fileListData.body.concat(a.ctt.list),t.fileListData.total=a.ctt.total,t.fileListData.loading=!1,0===a.ctt.list.length?e&&e.complete():e&&e.loaded()}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},dateShortFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("MM月DD日 HH:mm")},dateFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("YYYY年MM月DD日 HH:mm")},onMouseDown:function(){this.$refs.split.active&&(this.splitClass="active")},onMouseUp:function(){this.$refs.split.active||(this.splitClass="")},addFolder:function(e){this.$refs.folderTree.append(e.ctt,e.ctt.parentId)},editFolder:function(e){var t=this.$refs.folderTree.getNode(e);this.$refs.folderTree.remove(e),this.$refs.folderTree.append(e,e.parentId),t.data.name=e.name},deleteFolder:function(e){this.$refs.folderTree.remove(e)},nextPage:function(e){this.fileListData.curPage+=1,this.getFileData(e)},refresh:function(){this.fileListData.total=0,this.fileListData.body=[],this.fileListData.curPage=0,this.$refs.infinite.stateChanger.reset()}}},c=(a("FKUh"),a("KHd+")),d=Object(c.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"106"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr  pd10"},[a("div",{staticClass:"fnt-s20"},[a("h1",[a("app-svg",{attrs:{iconClass:"wenjianjia3"}}),e._v(" "),a("b",[e._v(e._s(e.folder.name))])],1)]),e._v(" "),""!==e.folder.name?a("div",{staticClass:"fxr pl10"},[a("el-tag",[e._v("文件夹管理员："),a("b",[e._v(e._s(e.folder.user))])]),e._v(" "),a("el-tag",[e._v("上传文件大小限制："),a("b",[e._v(e._s(e.folder.size)+"MB")])])],1):e._e()])])]),e._v(" "),a("split-pane",{ref:"split",attrs:{split:"vertical",className:e.splitClass,defaultPercent:50},nativeOn:{mousedown:function(t){return e.onMouseDown(t)},mouseup:function(t){return e.onMouseUp(t)}}},[a("template",{slot:"paneL"},[a("el-scrollbar",[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.folderTree.loading,expression:"folderTree.loading"}],ref:"folderTree",staticClass:"mr20",attrs:{data:e.folderTree.body,"highlight-current":"",props:e.folderTree.props,"default-expand-all":!1,"expand-on-click-node":!1,"node-key":"id","default-expanded-keys":[1],lazy:"",load:e.printFolderTree},on:{"node-click":e.folderSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[1===s.id?a("div",[a("img",{staticStyle:{width:"20px",height:"auto"},attrs:{src:e.viewImageUrl,alt:""}}),e._v(" "),a("b",[e._v(e._s(i.label))])]):a("div",[a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-wenjianjia"}})]),e._v(" "),a("b",[e._v(e._s(i.label))])]),e._v(" "),1===s.id?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增下级文件夹",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-add",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderAdd(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置上传文件大小",placement:"bottom"}},[a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-bingzhuangtu",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderSize(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置允许访问IP",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-_IPbaimingdan",circle:""},nativeOn:{click:function(t){e.$refs.folderWhite.handleWhiteList(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置文件夹管理员",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-guanli_danse",circle:""},nativeOn:{click:function(t){e.$refs.folderAdmin.handleFolderAdmin(i)}}})],1)],1):a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增下级文件夹",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-add",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderAdd(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑文件夹",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-edit-node",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderEdit(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置上传文件大小",placement:"bottom"}},[a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-bingzhuangtu",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderSize(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置允许访问IP",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-_IPbaimingdan",circle:""},nativeOn:{click:function(t){e.$refs.folderWhite.handleWhiteList(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置文件夹管理员",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnEdit",attrs:{type:"text",size:"mini",icon:"iconfont icon-guanli_danse",circle:""},nativeOn:{click:function(t){e.$refs.folderAdmin.handleFolderAdmin(i)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除文件夹",placement:"bottom"}},[s.isRoot?e._e():a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},nativeOn:{click:function(t){e.$refs.editFolder.handleFolderDelete(i)}}})],1)],1)])}}])})],1)],1),e._v(" "),a("template",{slot:"paneR"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.fileListData.loading,expression:"fileListData.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.fileListData.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.fileListData.height}},[a("el-table-column",{attrs:{prop:"name",label:"文件名","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("app-svg",{attrs:{iconText:t.row.suffix}}),e._v(" "),a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:"#"},on:{click:function(a){e.handlePreview(t.$index,t.row)}}},[t.row.suffix?a("b",[e._v(e._s(t.row.name)+"."+e._s(t.row.suffix))]):e._e(),e._v(" "),t.row.suffix?e._e():a("b",[e._v(e._s(t.row.name))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"最后修改者",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.lastUpdateUserName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"最后修改时间",align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.dateFormat(t.row.lastUpdateDate)))]),e._v(" "),a("span",[e._v(e._s(e.dateShortFormat(t.row.lastUpdateDate)))])])]}}])}),e._v(" "),a("infinite-loading",{ref:"infinite",attrs:{slot:"append","force-use-infinite-wrapper":".el-table__body-wrapper"},on:{infinite:e.nextPage},slot:"append"},[a("span",{attrs:{slot:"no-more"},slot:"no-more"})])],1)],1)],1)],2),e._v(" "),a("folder-admin",{ref:"folderAdmin"}),e._v(" "),a("edit-folder",{ref:"editFolder",attrs:{"add-folder":e.addFolder,"edit-folder":e.editFolder,"delete-folder":e.deleteFolder}}),e._v(" "),a("folder-white",{ref:"folderWhite"})],1)},[],!1,null,"0a13051e",null);t.default=d.exports},zUC8:function(e,t,a){},zca1:function(e,t,a){"use strict";a.r(t);var i=a("r/9I"),s=a("L2JU"),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},o={name:"message",components:{preview:i.a},data:function(){return{searchTxt:"",messageTable:{loading:!0,body:[],height:0,pageSize:1e3,total:0,curPage:1,multipleSelection:[]},tagBar:{loading:!0,body:[],inputVisible:!1,inputValue:""}}},mounted:function(){this.getData(),this.getTag(),this.tableHeight()},methods:n({},Object(s.b)({curFolderAction:"folderHistory/curFolder",nextFolderAction:"folderHistory/nextFolder"}),{tableHeight:function(){this.$nextTick(function(){this.messageTable.height=window.innerHeight-this.$refs.table.$el.offsetTop-254;var e=this;window.onresize=function(){e.messageTable.height=window.innerHeight-e.$refs.table.$el.offsetTop-254}})},getData:function(){var e=this;this.messageTable.loading=!0,this.$axios({url:"/user/messages/"+this.messageTable.curPage+"-"+this.messageTable.pageSize,method:"get"}).then(function(t){e.messageTable.body=t.ctt.list,e.messageTable.total=t.ctt.total,e.messageTable.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},refresh:function(){this.getData()},getTag:function(){var e=this;this.tagBar.loading=!0,this.$axios({url:"/user/tags",method:"get"}).then(function(t){e.tagBar.body=t.ctt,e.tagBar.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})},sizeChange:function(e){this.messageTable.pageSize=e,this.getData()},pageChange:function(e){this.messageTable.curPage=e,this.getData()},handleSelectionChange:function(e){this.messageTable.multipleSelection=e},dateFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("YYYY年MM月DD日 HH:mm")},dateShortFormat:function(e){return void 0===e||null===e?"":this.$moment(e).format("MM月DD日 HH:mm")},handleDownloadSubmit:function(e,t){var a=this;this.$axios({url:"user/file/"+t.resourceId,method:"get"}).then(function(e){e?6001!==e.c?!1!==e.ctt.permissionMap.visible&&!1!==e.ctt.permissionMap.download?a.$confirm("开始下载最新版本的文件吗？","提示",{cancelButtonClass:"btn-custom-cancel",type:"success"}).then(function(){a.$axios({url:"user/message/"+t.id+"/seq/0/download",method:"post",responseType:"blob"}).then(function(e){if(!e)return a.$message({message:"下载失败",type:"error"}),void a.getData();var i=new Blob([e]),s=t.resourceName+"."+t.resourceSuffix;if("download"in document.createElement("a")){var n=document.createElement("a");n.download=s,n.style.display="none",n.href=URL.createObjectURL(i),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else window.navigator.msSaveBlob(i,s)})}):a.$message.error("您没有文件的下载权限！请联系文件夹管理员！"):a.$message.error("文件已经被删除，不能下载！"):a.$message.error("文件没有找到！")}).catch(function(e){a.$message.error("获取数据失败，失败码："+e.response.status)})},handleMultiReadSubmit:function(){var e=this;this.$confirm("把全部消息设为已读?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.messageTable.loading=!0,e.$axios({url:"user/messages/read",method:"put"}).then(function(){e.$message({message:"设置成功",type:"success"}),e.getData(),e.messageTable.loading=!1})}).catch(function(){})},handleMultiDeleteSubmit:function(){var e=this;0!==this.messageTable.multipleSelection.length?this.$confirm("确认删除这些外链吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){e.messageTable.loading=!0;var t=e.messageTable.multipleSelection;e.$axios({url:"user/messages",method:"delete",data:t}).then(function(t){e.$message({message:"删除成功",type:"success"}),e.getData(),e.messageTable.loading=!1})}).catch(function(){}):this.$message.error("没有选择需要删除的消息，请重新选择！")},handleDeleteSubmit:function(e,t){var a=this;this.$confirm("确认删除该消息吗?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){a.messageTable.loading=!0;var e=Object.assign({},t);a.$axios({url:"user/message",method:"delete",data:e}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.getData(),a.messageTable.loading=!1})}).catch(function(){})},tagSearch:function(e){var t=this;this.messageTable.loading=!0,this.$axios({url:"/user/messagesbysearchkey/"+this.messageTable.curPage+"-"+this.messageTable.pageSize+"?key="+e,method:"get"}).then(function(e){t.messageTable.body=e.ctt.list,t.messageTable.total=e.ctt.total,t.messageTable.loading=!1}).catch(function(e){t.$message.error("获取数据失败，失败码："+e.response.status)})},search:function(){var e=this;this.searchTxt&&this.searchTxt.trim()?new RegExp("[/:*?'\"<>|\\\\]").test(this.searchTxt.trim())?this.$message.warning("不能包含特殊字符：\\/:*?'\"<>|"):(this.messageTable.loading=!0,this.$axios({url:"/user/messagesbysearchkey/"+this.messageTable.curPage+"-"+this.messageTable.pageSize+"?key="+this.searchTxt,method:"get"}).then(function(t){e.messageTable.body=t.ctt.list,e.messageTable.total=t.ctt.total,e.messageTable.loading=!1}).catch(function(t){e.$message.error("获取数据失败，失败码："+t.response.status)})):this.$message.success("请输入搜索关键词")},showInput:function(){var e=this;this.tagBar.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var e=this,t={id:0,name:this.tagBar.inputValue,type:2};t.name&&(this.tagBar.loading=!0,this.$axios({url:"/user/tag",method:"post",data:t}).then(function(a){0===a.c?(e.$message.success("已添加新标签"),t.id=a.ctt.id,e.tagBar.body.push(t),e.tagBar.loading=!1):e.$message.error(a.msg)}).catch(function(e){})),this.tagBar.inputVisible=!1,this.tagBar.inputValue=""},handleClose:function(e){var t=this;this.$confirm("删除这个标签?","提示",{cancelButtonClass:"btn-custom-cancel",type:"warning"}).then(function(){t.tagBar.loading=!0;var a=e;t.$axios({url:"user/tag",method:"delete",data:a}).then(function(a){t.tagBar.body.splice(t.tagBar.body.indexOf(e),1),t.tagBar.loading=!1})}).catch(function(){})},handlePreview:function(e,t){if(3!==t.type){this.$refs.preview.handlePreview(t),t.status=0;var a=Object.assign({},t);this.$axios({url:"user/message",method:"put",data:a}).then(function(e){console.log(e)})}else this.$message.warning("文件已被删除，不能查看！")}})},l=(a("PlAU"),a("KHd+")),r=Object(l.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"pd0",attrs:{height:"79"}},[a("div",{staticClass:"app-title fxb bb1 pd10"},[a("div",{staticClass:"fxr"},[a("el-button-group",[a("el-button",{attrs:{size:"small",icon:"el-icon-arrow-left"},on:{click:e.curFolderAction}}),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.nextFolderAction}},[a("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),e._v(" "),a("el-breadcrumb",{staticClass:"pl10",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("文档通知")])],1)],1),e._v(" "),a("div",{staticClass:"ib"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.searchTxt,callback:function(t){e.searchTxt=t},expression:"searchTxt"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("el-button",{attrs:{size:"mini",icon:"iconfont icon-shuaxin"},on:{click:e.refresh}},[e._v(" 刷新")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-trash",plain:""},on:{click:e.handleMultiDeleteSubmit}},[e._v("删除消息")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"iconfont icon-system-extension",plain:""},on:{click:e.handleMultiReadSubmit}},[e._v("全部已读")])],1)]),e._v(" "),a("div",{staticClass:"fxb bb1"},[a("div",{staticClass:"fxr pd5"},[a("span",{staticStyle:{"font-weight":"bold","letter-spacing":"3px","padding-left":"10px"}},[e._v("最新标签：")]),e._v(" "),e._l(e.tagBar.body,function(t,i){return a("el-tag",{key:t.id,attrs:{closable:"",type:"warning","disable-transitions":!1},on:{close:function(a){e.handleClose(t)}},nativeOn:{click:function(a){e.tagSearch(t.name)}}},[a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:" javascript:void(0)"}},[e._v(e._s(t.name))])])}),e._v(" "),e.tagBar.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{span:1,size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleInputConfirm(t):null}},model:{value:e.tagBar.inputValue,callback:function(t){e.$set(e.tagBar,"inputValue",t)},expression:"tagBar.inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{span:3,size:"small"},on:{click:e.showInput}},[e._v("+ 点击添加新标签\n                ")])],2)])]),e._v(" "),a("el-main",{staticClass:"sys-content pd0"},[a("el-scrollbar",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.messageTable.loading,expression:"messageTable.loading"}],ref:"table",staticClass:"custom-table-cell",attrs:{data:e.messageTable.body,"highlight-current-row":"","cell-style":{padding:"5px"},"header-cell-style":{padding:"2px"},height:e.messageTable.height},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"resourceName",label:"文件名",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return["folder"===t.row.kind?a("div",[a("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[a("app-svg",{attrs:{iconClass:"wenjianjia3"}})],1),e._v(" "),a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:"#",target:"_self"}},[a("b",[e._v(e._s(t.row.resourceName))])])],1):a("div",[1===t.row.status?a("div",[a("el-badge",{staticClass:"item",attrs:{"is-dot":""}},[a("app-svg",{attrs:{iconText:t.row.resourceSuffix}})],1),e._v(" "),a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:"#"},on:{click:function(a){e.handlePreview(t.$index,t.row)}}},[a("b",[e._v(e._s(t.row.resourceName)+"."+e._s(t.row.resourceSuffix))])])],1):a("div",[a("app-svg",{attrs:{iconText:t.row.resourceSuffix}}),e._v(" "),a("a",{staticStyle:{"margin-left":"10px","text-decoration-line":"none"},attrs:{href:"#"},on:{click:function(a){e.handlePreview(t.$index,t.row)}}},[e._v("\n                                    "+e._s(t.row.resourceName)+"."+e._s(t.row.resourceSuffix)+"\n                                ")])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"消息发送时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.dateFormat(t.row.fromDate)))]),e._v(" "),a("p",[a("b",[e._v(e._s(e.dateShortFormat(t.row.fromDate)))])])])],1):a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.dateFormat(t.row.fromDate)))]),e._v(" "),a("p",[e._v(e._s(e.dateShortFormat(t.row.fromDate)))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"修改者",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?a("div",[a("p",[a("b",[e._v(e._s(t.row.fromUserName))])])]):a("div",[a("p",[e._v(e._s(t.row.fromUserName))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"修改内容",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?a("div",[a("p",[a("b",[e._v(e._s(t.row.info))])])]):a("div",[a("p",[e._v(e._s(t.row.info))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"文件下载",placement:"bottom"}},[a("el-button",{staticClass:"btnAdd",attrs:{type:"text",size:"mini",icon:"iconfont icon-caozuo-shangchuan-download",circle:""},on:{click:function(a){e.handleDownloadSubmit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除消息",placement:"bottom"}},[a("el-button",{staticClass:"btnDel",attrs:{type:"text",size:"mini",icon:"iconfont icon-trash",circle:""},on:{click:function(a){e.handleDeleteSubmit(t.$index,t.row)}}})],1)],1)]}}])})],1)],1)],1),e._v(" "),a("preview",{ref:"preview"})],1)},[],!1,null,null,null);t.default=r.exports},zqcb:function(e,t,a){}}]);